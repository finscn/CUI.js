"use strict";var CUI=CUI||{};!function(t){var n={SN:0,create:function(i,t,e){"object"==typeof i&&arguments.length<3&&(e=t,t=i,(i=function(t){for(var i in this._initializeSuper&&this._initializeSuper(),this.initialize&&this.initialize(),this.onInitialize&&this.onInitialize(),t)this[i]=t[i];!1===this.lazyInit&&this.init()}).classSN=++n.SN);var s=i.prototype;for(var h in t)s[h]=t[h];return s._initializeSuper=function(){var t=i.$super;t&&(t._initializeSuper&&t._initializeSuper.call(this),t.initialize&&t.initialize.call(this),t.onInitialize&&t.onInitialize.call(this))},n.extend(i,e),i},extend:function(t,i){var e,s=t,h=s.prototype;for(var n in e="function"==typeof(i=s.superclass=i||s.superclass||h.superclass)?i.prototype:i)n in h||"constructor"===n||(h[n]=e[n]);return s.$super=e,s.superclass=i,h.superclass=i,h.constructor||(h.constructor=s),t}};CUI.Class=n,"undefined"!=typeof module&&(module.exports=n)}(),function(t){CUI.ImagePool=CUI.ImagePool||{},CUI.ImageMapping=CUI.ImageMapping||{};var o=document.createElement("canvas").getContext("2d"),v={loadImage:function(t,i){var e=new Image;return e.onload=function(t){i&&i(e,t)},e.onerror=function(t){i&&i(null,t)},e.src=t,e},loadImages:function(t,s){var h=t.length,n={},o=-1,r=function(){if(h<=++o)s&&s(n);else{var i=t[o],e=new Image;e.src=i.src,e.id=i.id,e.onload=function(t){n[e.id]=e,i.onLoad&&i.onLoad.call(e,e),r()},e.onerror=function(t){i.onError&&i.onError.call(e,e),r()}}};return r(),n},parseValue:function(t,i,e){if("string"==typeof t){if("auto"===(t=t.trim()))return void 0===e?0:e;var s,h,n,o;if(0<(s=t.lastIndexOf("+"))){var r=t.substring(0,s),l=t.substring(s+1);return(r=v.parseValue(r,i))+(l=v.parseValue(l,i))}if(0<(h=t.lastIndexOf("-"))){r=t.substring(0,h),l=t.substring(h+1);return(r=v.parseValue(r,i))-(l=v.parseValue(l,i))}if(0<(n=t.lastIndexOf("*"))){r=t.substring(0,n),l=t.substring(n+1);return(r=v.parseValue(r,i))*(l=v.parseValue(l,i))}if(0<(o=t.lastIndexOf("/"))){r=t.substring(0,o),l=t.substring(o+1);return(r=v.parseValue(r,i))*(l=v.parseValue(l,i))}return 0<t.lastIndexOf("%")?t=parseFloat(t)/100*(i||0):parseFloat(t)||0}return"number"==typeof t||!0===t||!1===t||null==t?t:parseFloat(t)||0},createCanvas:function(t,i){var e=document.createElement("canvas");return e.width=t,e.height=i,e},getTextWidth:function(t,i,e){var s=o,h=s.font;s.font=i+"px"+(e?" "+e:"");var n=s.measureText(t);return s.font=h,n.width},getImageInfo:function(t,i){var e=t;if("string"!=typeof e){if(!e.tagName)return t;e=(o=e).src}else o=CUI.ImagePool[e];if(o)return h={id:e,img:o,sx:0,sy:0,sw:o.width,sh:o.height,ox:0,oy:0,w:o.width,h:o.height};var s=CUI.ImageMapping[e];if(s){var h,n=s.img,o=CUI.ImagePool[n];return(h={id:e,sx:s.x,sy:s.y,sw:s.w,sh:s.h,ox:s.ox,oy:s.oy,w:s.sw,h:s.sh}).img=o,h}return console.log("Utils.getUIImgInfo err : ",e),i?null:((h={id:e,sx:0,sy:0,sw:2,sh:2,ox:0,oy:0,w:2,h:2,lazy:!0}).img=v.blankCanvas,h)},renderImageInfo:function(t,i,e,s,h,n){e=e||0,s=s||0,t.drawImage(i.img,i.sx,i.sy,i.sw,i.sh,e+i.ox>>0,s+i.oy>>0,h||i.sw,n||i.sh)},renderInfoImg:function(t,i,e,s,h,n){e=e||0,s=s||0,t.drawImage(i.img,i.sx,i.sy,i.sw,i.sh,e,s,h||i.sw,n||i.sh)},strokeAABB:function(t,i,e,s){e=e||"red";var h=t.strokeStyle;s&&(t.lineWidth=s),t.strokeStyle=e,t.strokeRect(i[0],i[1],i[2]-i[0],i[3]-i[1]),t.strokeStyle=h},fillAABB:function(t,i,e){e=e||"red";var s=t.fillStyle;t.fillStyle=e,t.fillRect(i[0],i[1],i[2]-i[0],i[3]-i[1]),t.fillStyle=s},setContextColor:function(t,i,e,s,h){if("string"==typeof e)t[i]=e;else{var n=e.stops||e,o=e.x0||0,r=e.y0||0,l=e.x1||0===e.x1?e.x1:s,a=e.y1||0===e.y1?e.y1:h,c=t.createLinearGradient(o,r,l,a);n.forEach(function(t){c.addColorStop(t[0],t[1])}),t[i]=c}},setFillColor:function(t,i,e,s){v.setContextColor(t,"fillStyle",i,e,s)},setStrokeColor:function(t,i,e,s){v.setContextColor(t,"strokeStyle",i,e,s)},drawPath:function(t,i,e){var s=i.length,h=i[0];t.beginPath(),t.moveTo(h[0],h[1]);for(var n=1;n<s;){var o=i[n],r=o.length;if(2===r)t.moveTo(o[0],o[1]);else{var l=o[r-1];if("line"===l)t.lineTo(o[0],o[1]);else if("circle"===l)t.arc(o[0],o[1],o[2],o[3],o[4],o[5]);else if("rect"===l){var a=o[0],c=o[1],d=o[2],u=o[3];t.moveTo(a,c),t.lineTo(a+d,c),t.lineTo(a+d,c+u),t.lineTo(a,c+u),t.lineTo(a,c)}else"arc"===l?t.arcTo(o[0],o[1],o[2],o[3],o[4]):"bezier"===l?t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]):"quad"!==l&&"quadratic"!==l||t.quadraticCurveTo(o[0],o[1],o[2],o[3])}if(o===h)break;n++,e&&n===s&&(n=0)}e&&t.closePath()},borderRadiusPath:function(t,i,e,s,h,n,o,r,l,a){t.beginPath();var c=Math.abs(n),d=Math.abs(o),u=Math.abs(r),p=Math.abs(l);2===a?(t.moveTo(i+c,e),t.lineTo(i+s-d,e),0!==d&&t.lineTo(i+s,e+d),t.lineTo(i+s,e+h-u),0!==u&&t.lineTo(i+s-u,e+h),t.lineTo(i+p,e+h),0!==p&&t.lineTo(i,e+h-p),t.lineTo(i,e+c),0!==c&&t.lineTo(i+c,e)):3===a?(t.moveTo(i+c,e),t.lineTo(i+s-d,e),t.lineTo(i+s-u,e+h),t.lineTo(i+p,e+h),t.lineTo(i+c,e)):4===a?(t.moveTo(i,e+c),t.lineTo(i+s,e+d),t.lineTo(i+s,e+h-u),t.lineTo(i,e+h-p),t.lineTo(i,e+c)):5===a?(t.moveTo(i,e),t.lineTo(i+s,e),0!==d&&t.lineTo(i+s-d,e+h/2),t.lineTo(i+s,e+h),t.lineTo(i,e+h),0!==c&&t.lineTo(i+c,e+h/2),t.lineTo(i,e)):6===a?(t.moveTo(i,e),0!==c&&t.lineTo(i+s/2,e+c),t.lineTo(i+s,e),t.lineTo(i+s,e+h),0!==d&&t.lineTo(i+s/2,e+h-d),t.lineTo(i,e+h),t.lineTo(i,e)):(t.moveTo(i+c,e),t.lineTo(i+s-d,e),o<0?(o=-o,t.arcTo(i+s-o,e+o,i+s,e+o,o)):0<o&&(h<o?t.lineTo(i+s,e+h):t.arcTo(i+s,e,i+s,e+o,o)),t.lineTo(i+s,e+h-Math.min(h,u)),r<0?(r=-r,t.arcTo(i+s-r,e+h-r,i+s-r,e+h,r)):0<r&&t.arcTo(i+s,e+h,i+s-r,e+h,r),t.lineTo(i+p,e+h),l<0?(l=-l,t.arcTo(i+l,e+h-l,i,e+h-l,l)):0<l&&(h<l?t.lineTo(i,e):t.arcTo(i,e+h,i,e+h-l,l)),t.lineTo(i,e+Math.min(h,c)),n<0?(n=-n,t.arcTo(i+n,e+n,i+n,e,n)):0<n&&t.arcTo(i,e,i+n,e,n)),t.closePath()},fixRadius:function(t){var i=[];return Array.isArray(t)?4===t.length?(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3]):2===t.length?(i[0]=t[0],i[1]=t[1],i[2]=t[0],i[3]=t[1]):1===t.length&&(i[0]=t[0],i[1]=t[0],i[2]=t[0],i[3]=t[0]):(i[0]=t,i[1]=t,i[2]=t,i[3]=t),i},createRoundRect:function(t,i){var e=(t=Object.assign({mode:0,margin:0,x:0,y:0,width:0,height:0,lineCap:"round",color:null,radius:0,borderWidth:0,borderColor:null},t)).mode,s=t.margin,h=t.width,n=t.height,o=t.radius,r=(t.color,t.borderWidth/2),l=r,a=t.x+s+l,c=t.y+s+l,d=h-2*l,u=n-2*l,p=v.fixRadius(o);if(p.forEach(function(t,i){p[i]=Math.max(0,t-r)}),!i){var f=t.x+h+2*s,g=t.y+n+2*s;i=v.createCanvas(f,g)}var m=i.getContext("2d");m.lineCap=t.lineCap,v.borderRadiusPath(m,a,c,d,u,p[0],p[1],p[2],p[3],e),t.color&&(v.setFillColor(m,t.color,0,u),m.fill()),t.borderWidth&&(m.lineWidth=t.borderWidth,t.borderColor&&(v.borderRadiusPath(m,a,c,d,u,p[0],p[1],p[2],p[3],e),v.setStrokeColor(m,t.borderColor,0,u),m.stroke()));var x=t.textInfo;if(x){var C=a+x.x||0,b=c+x.y||0;m.font=x.font,m.textAlign=x.textAlign||"center",x.shadowColor&&(v.setFillColor(m,x.shadowColor),m.fillText(x.text,C+x.shadowOffsetX,b+x.shadowOffsetY)),x.strokeWidth&&(m.lineWidth=2*x.strokeWidth,v.setStrokeColor(m,x.strokeColor),m.strokeText(x.text,C,b)),x.color&&(v.setFillColor(m,x.color),m.fillText(x.text,C,b))}return i},createRoundRects:function(i,e,t,s){return 2===arguments.length&&"number"!=typeof i&&(t=i,s=e),s=s||v.createCanvas(i,e),t.forEach(function(t){t&&(t.width=t.width||i,t.height=t.height||e,v.createRoundRect(t,s))}),s},createButtonRect:function(t){var i=new CUI.ButtonBackground(t);return i.init(),i.image}};v.blankCanvas=v.createCanvas(2,2),t.Utils=v,"undefined"!=typeof module&&(module.exports=v)}(CUI=CUI||{}),function(t){var n=t.Class.create({addChild:function(t){t.id=t.id||0===t.id?t.id:n.generateId(),this.childrenMap[t.id]=t,this.children.push(t),t.parent=this},getChildById:function(t){return this.childrenMap[t]},getChildAt:function(t){return this.children[t]},_removeChild:function(t){delete this.childrenMap[t.id],t.parent=null,t.root&&(delete t.root.all[t.id],t.root=null)},removeChild:function(t){var i=this.indexOf(t);return 0<=i&&(this.children.splice(i,1),this._removeChild(t),t)},removeChildById:function(t){var i=this.childrenMap[t];return!!i&&this.removeChild(i)},removeChildAt:function(t){var i=this.children[t];return!!i&&(this.children.splice(t,1),this._removeChild(i),i)},indexOf:function(t){for(var i=0,e=this.children.length;i<e;i++)if(this.children[i]===t)return i;return-1},hasChild:function(t){return!!this.children[t.id]},sortChildrenBy:function(t){n.insertSort(this.children,t)}});n._ID_SEED=0,n.generateId=function(){return n._ID_SEED++,"comp_"+n._ID_SEED},n.insertSort=function(t,i){for(var e,s,h=t.length,n=1;n<h;n++){for(var o=(e=t[n])[i],r=n;0<r&&(s=t[r-1])[i]>o;r--)t[r]=s;t[r]=e}},n.applyTo=function(t,i){var e=n.prototype;for(var s in e){var h=e[s];"function"==typeof h&&(i||!t[s])&&(t[s]=h)}return(i||!t.children)&&(t.children=[]),(i||!t.childrenMap)&&(t.childrenMap={}),t},t.Composite=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var n=t.Class.create({_listeners:null,removeAllEventListeners:function(){for(var t in this._listeners)this._listeners[t]=null;this._listeners={}},addEventListener:function(t,i){var e=this._listeners;void 0===e[t]&&(e[t]=[]),-1===e[t].indexOf(i)&&e[t].push(i)},hasEventListener:function(t,i){var e=this._listeners;return void 0!==e[t]&&-1!==e[t].indexOf(i)},removeEventListener:function(t,i){var e=this._listeners[t];if(void 0!==e){var s=e.indexOf(i);if(-1!==s)return e.splice(s,1),i}return null},dispatch:function(t,i){var e=this._listeners[t],s=!1;if(e){i=Array.prototype.slice.call(arguments,1);for(var h=0,n=e.length;h<n;h++)e[h].apply(this,i),s=!0}return s},getEventListeners:function(t){return t?this._listeners[t]:this._listeners},removeEventListeners:function(t){if(!t){var i=this._listeners;return this._listeners={},i}return(i=this._listeners[t]||null)&&(this._listeners[t]=[]),i}});n.applyTo=function(t,i){var e=n.prototype;for(var s in e){var h=e[s];"function"==typeof h&&(i||!t[s])&&(t[s]=h)}return(i||!t._listeners)&&(t._listeners={}),t},t.EventDispatcher=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var n=t.Class.create({modalFlag:-1048576,checkTouch:function(t,i){if(!this.visible||this.alpha<=0||this.disabled)return!1;var e,s=Array.prototype.slice.call(arguments,1),h=s[0],n=s[1];if(!this.containPoint(h,n)){if(this.modal||this.mask)return"tap"===t?this.onTapOut.apply(this,s):"touchEnd"===t&&(this.composite?this.checkTouchChildren(t,arguments):this[t].apply(this,s)),this.modalFlag;if("tap"===t||"touchStart"===t)return!1}if(this.composite&&!1!==(e=this.checkTouchChildren(t,arguments)))return e;return!1===(e=this.checkTouchSelf(t,s))&&(this.modal||this.mask)?this.modalFlag:e},checkTouchSelf:function(t,i){if(this.visible&&this[t]&&!1!==this[t].apply(this,i))return this;return!1},getTouchableChildren:function(){return this.children},checkTouchChildren:function(t,i){var e=this.getTouchableChildren();if(e)for(var s=e.length-1;0<=s;s--){var h=e[s];if(h.visible&&!(h.alpha<=0)){var n=h.checkTouch.apply(h,i);if(!1!==n)return n}}return!1},touchStart:function(t,i,e){return this.onTouchStart(t,i,e)},touchEnd:function(t,i,e){return this.onTouchEnd(t,i,e)},touchMove:function(t,i,e){return this.onTouchMove(t,i,e)},tap:function(t,i,e){return this.onTap(t,i,e)},pan:function(t,i,e,s,h,n,o){return this.onPan(t,i,e,s,h,n,o)},swipe:function(t,i,e,s,h,n,o){return this.onSwipe(t,i,e,s,h,n,o)},tapOut:function(t,i,e){return this.onTapOut(t,i,e)},onTouchStart:function(t,i,e){return!1},onTouchMove:function(t,i,e){return!1},onTouchEnd:function(t,i,e){return!1},onTap:function(t,i,e){return!1},onPan:function(t,i,e,s,h,n,o){return!1},onSwipe:function(t,i,e,s,h,n,o){return!1},onTapOut:function(t,i,e){return!1}});n.applyTo=function(t,i){var e=n.prototype;for(var s in e){var h=e[s];"function"!=typeof h&&"modalFlag"!==s||(i||!t[s])&&(t[s]=h)}return t},t.TouchTarget=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var i=function(){},s={doUp:function(t,i,e){this.touchId=null,this.pressed=!1,this.onUp(t,i,e)},doDown:function(t,i,e){this.pressed=!0,this.onDown(t,i,e)},touchStart:function(t,i,e){if(this.disabled)return!1;this.touchId=e,this.onTouchStart(t,i,e),this.doDown(t,i,e)},pan:function(t,i,e,s,h,n,o){return this.disabled||this.touchId===o&&(this.containPoint(t,i)?this.onPan(t,i,e,s,h,n,o):(this.doUp(t,i,o),this.onMoveOut(t,i,e,s,h,n,o))),!1},touchEnd:function(t,i,e){return!this.disabled&&(!(this.touchId!==e||(this.doUp(t,i,e),!this.containPoint(t,i)))&&this.onTouchEnd(t,i,e))},swipe:function(t,i,e){return this.disabled||this.touchId===e&&this.doUp(t,i,e),!1},tap:function(t,i,e){if(!this.disabled){this.beforeTap(t,i,e);var s=this.onTap(t,i,e);return this.afterTap(t,i,e),s}},beforeTap:function(t,i,e){},afterTap:function(t,i,e){},onDown:function(t,i,e){},onUp:function(t,i,e){},onTap:function(t,i,e){},onPan:function(t,i,e,s,h,n,o){},onMoveOut:function(t,i,e,s,h,n,o){}};i.applyTo=function(t,i){for(var e in i=!0===i,s)!i&&e in t||(t[e]=s[e])},t.ButtonComponent=i,"undefined"!=typeof module&&(module.exports=i)}(CUI=CUI||{}),function(t){var i=t.Class.create({initialize:function(){this.velX=0,this.velY=0,this.accX=0,this.accY=0,this.damping=.003,this.dx=0,this.dy=0,this.entity=null},init:function(t){this.entity=t||this.entity},reset:function(){this.started=!1,this.toStart=!1;this.entity;this.dx=this.dy=this.velX=this.velY=this.accX=this.accY=0},start:function(t,i,e){if(this.toStart||e){this.entity;this.velX=t||0,this.velY=i||0,this.toStart=!1,this.started=!0}else this.started=!1},stop:function(){this.reset()},applyDamping:function(t){var i=1-t*this.damping;i<0&&(i=0),1<i&&(i=1),this.velX*=i,this.velY*=i},update:function(t){if(!this.started)return!1;this.entity,this.velX,this.velY;if(this.applyDamping(t),.033<Math.abs(this.velX)||.033<Math.abs(this.velY)){var i=this.velX*t,e=this.velY*t;return this.dx=i,this.dy=e,!0}return this.stop(),!1}});t.Slider=i,"undefined"!=typeof module&&(module.exports=i)}(CUI=CUI||{}),function(t){var s={},h={getName:function(t,i){var e=s[i?t+" "+i:t];return e&&(t=e),t},getStyle:function(t,i,e){return t=t||12,"normal"===e&&(e=null),window.App?t+"px "+(i=h.getName(i,e)):(e=e?e+" ":"")+t+"px "+i}};t.Font=h,t.FontMapping=s,"undefined"!=typeof module&&(module.exports=h,module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Font,i.create({initialize:function(){this.lazyInit=!1,this.canvas=null,this.context=null,this.clearColor=null,this.webgl=!1,this.canvas2d=!0},noop:function(){},init:function(){this.context=this.context||this.canvas.getContext("2d"),this.canvas=this.canvas||this.context.canvas,this.defaultTransform={x:0,y:0,scaleX:1,scaleY:1,rotation:0,alpha:1,originalX:0,originalY:0,blend:"source-over"},this.resetGlobalContainer(),this.render=this.drawDisplayObject},begin:function(t){t&&this.clear()},end:function(){},colorRgb:function(t,i,e){return"rgba("+t+", "+i+", "+e+", 1)"},colorHex:function(t){return t},colroName:function(t){return t},save:function(){this.context.save();var t=this.globalTransform;this.transformStack.push({x:t.x,y:t.y,scaleX:t.scaleX,scaleY:t.scaleY,rotation:t.rotation,alpha:t.alpha,originalX:t.originalX,originalY:t.originalY})},restore:function(){this.context.restore();var t=this.transformStack.pop();if(t){var i=this.globalTransform;i.x=t.x,i.y=t.y,i.scaleX=t.scaleX,i.scaleY=t.scaleY,i.rotation=t.rotation,i.alpha=t.alpha,i.originalX=t.originalX,i.originalY=t.originalY}},translate:function(t,i){this.context.translate(t,i)},scale:function(t,i){this.context.scale(t,i)},rotate:function(t){this.context.rotate(t)},setAlpha:function(t){this._lastAlpha=this.context.globalAlpha,this.context.globalAlpha=t},restoreAlpha:function(t){this.context.globalAlpha=this._lastAlpha},getAlpha:function(){return this.context.globalAlpha},setOrigin:function(t,i){this.context.translate(t,i),this.globalTransform.originalX=t,this.globalTransform.originalY=i},getOrigin:function(){return{x:this.globalTransform.originX,y:this.globalTransform.originY}},clipRect:function(t,i,e,s){this.context.save();var h=this.globalTransform,n=t-h.originalX,o=i-h.originalY,r=this.context;return r.beginPath(),r.moveTo(n,o),r.lineTo(n+e,o),r.lineTo(n+e,o+s),r.lineTo(n,o+s),r.closePath(),r.clip(),r},unclipRect:function(){this.context.restore()},setBlendByName:function(t){this.setBlend(t)},getBlend:function(){return this.blend},setBlend:function(t){this._lastBlend=this.blend;var i=this.blend=t;this.context.globalCompositeOperation=i},restoreBlend:function(){this.context.globalCompositeOperation=this._lastBlend},resetGlobalContainer:function(){for(var t in this.transformStack=[],this.globalTransform={},this.defaultTransform)this.globalTransform[t]=this.defaultTransform[t];this._lastAlpha=this.globalTransform.alpha},clear:function(){if(null!==this.clearColor)return this.fillStyle=this.clearColor,void this.fillRect(0,0,this.canvas.width,this.canvas.height);this.clearRect(0,0,this.canvas.width,this.canvas.height)},strokeRect:function(t,i,e,s,h,n){var o=this.globalTransform,r=t-o.originalX,l=i-o.originalY;h&&(this.context.lineWidth=h),n&&(this.context.strokeStyle=n),this.context.strokeRect(r,l,e,s)},fillRect:function(t,i,e,s,h){var n=this.globalTransform,o=t-n.originalX,r=i-n.originalY;h&&(this.context.fillStyle=h),this.context.fillRect(o,r,e,s)},clearRect:function(t,i,e,s){var h=this.globalTransform,n=t-h.originalX,o=i-h.originalY;null!==this.clearColor?(this.context.fillStyle=this.clearColor,this.context.fillRect(n,o,e,s)):this.context.clearRect(n,o,e,s)},strokeText:function(t,i,e,s,h,n){var o=this.globalTransform,r=i-o.originalX,l=e-o.originalY;s&&(this.context.lineWidth=s),h&&(this.context.strokeStyle=h),n&&(this.context.font=n),this.context.strokeText(t,r,l)},fillText:function(t,i,e,s,h){var n=this.globalTransform,o=i-n.originalX,r=e-n.originalY;s&&(this.context.fillStyle=s),h&&(this.context.font=h),this.context.fillText(t,o,r)},drawText:function(t,i,e,s){var h=s.color,n=s.font;this.fillText(t,i,e,h,n)},drawDisplayObject:function(t,i,e,s,h){var n=arguments.length,o=t.img,r=t.sx,l=t.sy,a=t.sw,c=t.sh,d=this.globalTransform;i-=d.originalX,e-=d.originalY,5===n?this.context.drawImage(o,r,l,a,c,i,e,s,h):3===n&&this.context.drawImage(o,r,l,a,c,i,e,a,c)},render:function(t){},renderAt:function(t,i,e){arguments.length;var s=t.img,h=t.sx,n=t.sy,o=t.sw,r=t.sh,l=this.globalTransform;i-=l.originalX,e-=l.originalY,this.context.drawImage(s,h,n,o,r,i,e,o,r)},drawImage:function(t,i,e,s,h,n,o,r,l){var a=arguments.length,c=this.globalTransform;return 9===a?(n-=c.originalX,o-=c.originalY,this.context.drawImage(t,i,e,s,h,n,o,r,l)):5===a?(n=i-c.originalX,o=e-c.originalY,this.context.drawImage(t,i,e,s,h)):(n=i-c.originalX,o=e-c.originalY,this.context.drawImage(t,i,e)),t},renderNineSliceObject:function(t,i,e,s,h){var n=t,o=i,r=e,l=s,a=h,c=n.T,d=n.R,u=n.B,p=n.L,f=l-p-d,g=a-c-u;n.CL&&this.render(n.CL,o,r+c,p,g),n.CC&&this.render(n.CC,o+p,r+c,f,g),n.CR&&this.render(n.CR,o+l-d,r+c,d,g),n.TL&&this.render(n.TL,o,r,p,c),n.TC&&this.render(n.TC,o+p,r,f,c),n.TR&&this.render(n.TR,o+l-d,r,d,c),n.BL&&this.render(n.BL,o,r+a-u,p,u),n.BC&&this.render(n.BC,o+p,r+a-u,f,u),n.BR&&this.render(n.BR,o+l-d,r+a-u,d,u)},createDisplayObject:function(t,i,e,s,h,n){return 2===arguments.length&&(n=i,i=0),{img:t,sx:i||0,sy:e||0,sw:s||t.width,sh:h||t.height,anchorX:0,anchorY:0,tx:0,ty:0,alpha:1,scaleX:1,scaleY:1,rotation:0}},createTextObject:function(t,i){var e=t.canvas,s=this.createDisplayObject(e);return s.resolution=1,s.context=t,s.canvas=e,s.padding=0,s.updateContent=this.noop,s.updateSize=this._updateTextObjectSize,s},_updateTextObjectSize:function(){this.sw=this.canvas.width,this.sh=this.canvas.height},createNineSliceObject:function(t,i,e,s,h,n,o,r,l,a){var c=s-l-o,d=h-n-r,u={},p=u;return p.T=n,p.R=o,p.B=r,p.L=l,p.CL=this.createDisplayObject(t,i,e+n,l,d,a),p.CC=this.createDisplayObject(t,i+l,e+n,c,d,a),p.CR=this.createDisplayObject(t,i+s-o,e+n,o,d,a),0<n&&(0<l&&(p.TL=this.createDisplayObject(t,i,e,l,n,a)),p.TC=this.createDisplayObject(t,i+l,e,c,n,a),0<o&&(p.TR=this.createDisplayObject(t,i+s-o,e,o,n,a))),0<r&&(0<l&&(p.BL=this.createDisplayObject(t,i,e+h-r,l,r,a)),p.BC=this.createDisplayObject(t,i+l,e+h-r,c,r,a),0<o&&(p.BR=this.createDisplayObject(t,i+s-o,e+h-r,o,r,a))),u}}));t.CanvasRenderer=e,"undefined"!=typeof module&&(module.exports=e)}(CUI=CUI||{}),function(t){var i=t.Class.create({antialias:!1,transparent:!0,backgroundColor:0,webgl:null,initialize:function(){this.lazyInit=!1,this.core=null,this.renderer=null,this.canvas=null,this.context=null,this.clearColor=null,this.webgl=!1,this.origX=0,this.origY=0,this.root=null,this.globalContainer=null},noop:function(){},init:function(){if(this.core)this.canvas=this.core.renderer.view;else{var t=this.renderer;if(!t){var i=this.canvas,e={width:i.width,height:i.height,view:i,antialias:this.antialias,transparent:this.transparent,backgroundColor:this.backgroundColor,clearBeforeRender:!1};(t=!1===this.webgl?new PIXI.CanvasRenderer(e):!0===this.webgl?new PIXI.WebGLRenderer(e):new PIXI.autoDetectRenderer(e)).resize(i.width,i.height)}this.core=new PIXI.RenderContext(t,this.root)}this.context=this.core.renderer.gl||this.core.renderer.rootContext,this.webgl=this.core.webgl,this.canvas2d=!this.webgl,this.root=this.core.root,this.globalContainer=this.core.globalContainer,this.origX=0,this.origY=0,this.renderNineSliceObject=this.drawDisplayObject},begin:function(t){this.core.begin(t)},end:function(){this.core.end()},colorRgb:function(t,i,e){return this.core.colorRgb(t,i,e)},colorHex:function(t){return this.core.colorHex(t)},colroName:function(t){return this.core.colroName(t)},save:function(){this.core.save()},restore:function(){this.core.restore()},translate:function(t,i){this.core.translate(t,i)},scale:function(t,i){this.core.scale(t,i)},rotate:function(t){this.core.rotate(t)},setAlpha:function(t){this.core.setAlpha(t)},restoreAlpha:function(){this.core.restoreAlpha()},getAlpha:function(){return this.core.getAlpha()},setOrigin:function(t,i){this.core.setOrigin(t,i)},getOrigin:function(){return this.core.getOrigin()},clipRect:function(t,i,e,s){this.core.clipRect(t,i,e,s)},unclipRect:function(){this.core.unclipRect()},setBlendByName:function(t){this.core.setBlendByName(t)},getBlend:function(){return this.core.getBlend()},setBlend:function(t){this.core.setBlend(t)},restoreBlend:function(){this.core.restoreBlend()},resetGlobalContainer:function(){this.core.resetGlobalContainer()},clear:function(){this.core.clear(this.clearColor)},strokeRect:function(t,i,e,s,h,n){this.core.strokeRect(t,i,e,s,h,n)},fillRect:function(t,i,e,s,h){this.core.fillRect(t,i,e,s,h)},clearRect:function(t,i,e,s){this.core.clearRect(t,i,e,s,this.clearColor,1)},strokeText:function(t,i,e,s,h,n){this.core.strokeText(t,i,e,s,h,n)},fillText:function(t,i,e,s,h){this.core.fillText(t,i,e,s,h)},drawText:function(t,i,e,s){this.core.drawText(t,i,e,s)},drawDisplayObject:function(t,i,e,s,h){5===arguments.length&&(t.width=s,t.height=h),this.core.renderAt(t,i,e)},render:function(t){this.core.render(t)},renderAt:function(t,i,e){this.core.renderAt(t,i,e)},drawImage:function(t,i,e,s,h,n,o,r,l){var a=arguments.length;3===a?this.core.drawImageAt(t,i,e):9===a?this.core.drawImage(t,i,e,s,h,n,o,r,l):this.core.drawImage(t,i,e,s,h)},renderNineSliceObject:null,createDisplayObject:function(t,i,e,s,h,n){return this.core.createSprite.apply(this.core,arguments)},createTextObject:function(t,i){return this.core.createTextObject(t,i)},createNineSliceObject:function(t,i,e,s,h,n,o,r,l,a){return 9<arguments.length?this.core.createNineSliceObject(t,i,e,s,h,l,n,o,r,a):(n=i,o=e,r=s,l=h,this.core.createNineSliceObject(t,l,n,o,r,a))}});Object.defineProperty(i.prototype,"globalAlpha",{get:function(){return this.core.globalAlpha},set:function(t){this.core.globalAlpha=t}}),Object.defineProperty(i.prototype,"lineWidth",{get:function(){return this.core.lineWidth},set:function(t){this.core.lineWidth=t}}),Object.defineProperty(i.prototype,"strokeStyle",{get:function(){return this.core.strokeStyle},set:function(t){this.core.strokeStyle=t}}),Object.defineProperty(i.prototype,"fillStyle",{get:function(){return this.core.fillStyle},set:function(t){this.core.fillStyle=t}}),t.PIXIRenderer=i,"undefined"!=typeof module&&(module.exports=i)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,i.create({init:function(){},compute:function(t){for(var i=t.children,e=0,s=i.length;e<s;e++){var h=i[e];"parent"===h.relative?this.computeChild(h,h.parent):"root"===h.relative?this.computeChild(h,h.root):this.computeChild(h,t),h.computeLayout(!0)}},computeChild:function(t,i){t.computeSelf(i)},tryToResizeParent:function(t,i,e,s){var h=!1;"auto"!==t.width||t.w||(t.pixel.width=i,t.w=i,h=!0),"auto"!==t.height||t.h||(t.pixel.height=e,t.h=e,h=!0),h&&(t.updateAnchor(),t.hasLayoutX||t.computePositionX(t.parent),t.hasLayoutY||t.computePositionY(t.parent),t.computePadding(),t.updateAABB(),t.needToCompute=!0,s&&t.computeLayout())}}));t.BaseLayout=e,"undefined"!=typeof module&&(module.exports=e)}(CUI=CUI||{}),function(t){var i=t.Class,p=t.Utils,e=t.BaseLayout,s=i.create({superclass:e,initialize:function(){this.align="top",this.size=null,this.equalSize=!1},compute:function(t){for(var i,e=t.children,s=e.length,h=0,n=t.pixel.paddingTop,o=-1/0,r=0,l=this.equalSize?t.pixel.innerHeight/s:this.size,a=0;a<s;a++){(u=e[a]).hasLayoutY=!1,"parent"===u.relative?this.computeChild(u,u.parent):"root"===u.relative?this.computeChild(u,u.root):(u.computeMargin(t),u.computeRealMargin(t),u.computeWidth(),u.computeHeight(),u.follow||(i=n,l?(i+=u.pixel.marginTop,n+=l):n=(i+=Math.max(o,u.pixel.marginTop))+u.pixel.height),u.pixel.top=p.parseValue(u.top,u.pixel.realOuterHeight),u.pixel.relativeY=i+u.pixel.top,u.y=u.pixel.relativeY+t.y,u.hasLayoutY=!0,u.computePositionX(t),u.computePadding(),u.updateAABB(),o=u.pixel.marginBottom,r=Math.max(r,u.pixel.marginLeft+u.pixel.width+u.pixel.marginRight),h++),u.computeLayout(!0)}if(0<s){var c=l?t.pixel.height:n+o;if(this.tryToResizeParent(t,r,c,!0),!l&&"bottom"===this.align){var d=t.pixel.height-c;if(0<d)for(a=0;a<s;a++){var u;"parent"!==(u=e[a]).relative&&"root"!==u.relative&&(u.pixel.top+=d,u.pixel.relativeY+=d,u.y+=d,u.updateAABB(),u.computeLayout(!0))}}}return h}});t.VBoxLayout=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,p=t.Utils,e=t.BaseLayout,s=i.create({superclass:e,initialize:function(){this.align="left",this.size=null,this.equalSize=!1},compute:function(t){for(var i,e=t.children,s=e.length,h=0,n=t.pixel.paddingLeft,o=-1/0,r=0,l=this.size||(this.equalSize?t.pixel.innerWidth/s:this.size),a=0;a<s;a++){(u=e[a]).hasLayoutX=!1,"parent"===u.relative?this.computeChild(u,u.parent):"root"===u.relative?this.computeChild(u,u.root):(u.computeMargin(t),u.computeRealMargin(t),u.computeWidth(),u.computeHeight(),u.follow||(i=n,l?(i+=u.pixel.marginLeft,n+=l):n=(i+=Math.max(o,u.pixel.marginLeft))+u.pixel.width),u.pixel.left=p.parseValue(u.left,u.pixel.realOuterWidth),u.pixel.relativeX=i+u.pixel.left,u.x=u.pixel.relativeX+t.x,u.hasLayoutX=!0,u.computePositionY(t),u.computePadding(),u.updateAABB(),o=u.pixel.marginRight,r=Math.max(r,u.pixel.marginTop+u.pixel.height+u.pixel.marginBottom),h++),u.computeLayout(!0)}if(0<s){var c=l?t.pixel.width:n+o;if(this.tryToResizeParent(t,c,r,!0),!l&&"right"===this.align){var d=t.pixel.width-c;if(0<d)for(a=0;a<s;a++){var u;"parent"!==(u=e[a]).relative&&"root"!==u.relative&&(u.pixel.left+=d,u.pixel.relativeX+=d,u.x+=d,u.updateAABB(),u.computeLayout(!0))}}}return h}});t.HBoxLayout=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,r=t.Utils,e=t.BaseLayout,s=i.create({superclass:e,initialize:function(){this.cellWidth=null,this.cellHeight=null,this.cellSpaceH=null,this.cellSpaceV=null,this.cols=1,this.rows=1},compute:function(t){var i=t.children,e=i.length,s=0;this.initTable(t);for(var h=0;h<e;h++){var n=i[h];"parent"===n.relative?this.computeChild(n,n.parent):"root"===n.relative?this.computeChild(n,n.root):(this.parseChild(n,t,s),s++),n.computeLayout(!0)}return 0<e&&this.tryToResizeParent(t,t.pixel.width,t.pixel.height),s},initTable:function(t){var i=this.pixel={},e=t.pixel;"auto"===t.width&&(e.width=(this.cellWidth+this.cellSpace)*this.cols+this.cellSpace,e.width+=(e.paddingLeft||0)+(e.paddingRight||0)),"auto"===t.height&&(e.height=(this.cellHeight+this.cellSpace)*this.rows+this.cellSpace,e.height+=(e.paddingTop||0)+(e.paddingBottom||0)),i.cellSpace=r.parseValue(this.cellSpace,e.width)||0,i.cellSpaceH=r.parseValue(this.cellSpaceH,e.width),i.cellSpaceV=r.parseValue(this.cellSpaceV,e.height),null===i.cellSpaceH&&(i.cellSpaceH=i.cellSpace),null===i.cellSpaceV&&(i.cellSpaceV=i.cellSpace);var s=e.width-e.paddingLeft-e.paddingRight,h=e.height-e.paddingTop-e.paddingBottom,n=(s+i.cellSpaceH)/(this.cols||1)-i.cellSpaceH>>0,o=(h+i.cellSpaceV)/(this.rows||1)-i.cellSpaceV>>0;this.cellWidth?i.cellWidth=r.parseValue(this.cellWidth,n)||n:i.cellWidth=n,this.cols||(this.cols=(s+i.cellSpaceH)/i.cellWidth>>0),this.cellHeight?i.cellHeight=r.parseValue(this.cellHeight,o)||o:i.cellHeight=o,this.rows||(this.rows=(h+i.cellSpaceV)/i.cellHeight>>0),this.parentCell={x:0,y:0,pixel:{width:0,height:0,paddingLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0}}},parseChild:function(t,i,e){var s=t.col=t.col||0,h=t.row=t.row||0;t.colspan=t.colspan||1,t.rowspan=t.rowspan||1,t.width=null===t.width?"100%":t.width,t.height=null===t.height?"100%":t.height;t.pixel;var n=this.pixel.cellWidth,o=this.pixel.cellHeight,r=this.pixel.cellSpaceH,l=this.pixel.cellSpaceV;this.parentCell.x=i.x,this.parentCell.y=i.y,this.parentCell.pixel.width=t.colspan*(n+r)-r,this.parentCell.pixel.height=t.rowspan*(o+l)-l,t.computeMargin(this.parentCell),t.computeRealMargin(this.parentCell),t.pixel.realMarginLeft=Math.max(t.marginLeft,i.paddingLeft)+s*(n+r),t.pixel.realMarginTop=Math.max(t.marginTop,i.paddingTop)+h*(o+l),t.computeWidth(),t.computeHeight(),t.computePositionX(this.parentCell),t.computePositionY(this.parentCell),t.computePadding(),t.updateAABB()}});t.TableLayout=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.BaseLayout),s=(t.VBoxLayout,t.HBoxLayout,t.TableLayout,i.create({init:function(){}}));s.commonLayout=new e,t.Layout=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,h=t.Utils,e=t.Composite,s=t.EventDispatcher,n=t.TouchTarget,o=t.Layout,r=function(){},l=i.create({initialize:function(){this.id=null,this.lazyInit=!1,this.left=null,this.top=null,this.right=null,this.bottom=null,this.width=null,this.height=null,this.visible=!0,this.zIndex=0,this.index=0,this.alpha=1,this.scale=1,this.offsetX=0,this.offsetY=0,this.anchorX="50%",this.anchorY="50%",this.rotation=0,this.extLeft=0,this.extRight=0,this.extTop=0,this.extBottom=0,this.layout=null,this.root=null,this.parent=null,this.modal=!1,this.maskColor="#000000",this.maskAlpha=.5,this.displayObject=null,this.transform=null,this.centerH=!1,this.centerV=!1,this.padding=null,this.paddingTop=null,this.paddingRight=null,this.paddingBottom=null,this.paddingLeft=null,this.margin=null,this.marginTop=null,this.marginRight=null,this.marginBottom=null,this.marginLeft=null,this.relative=!1,this.backgroundColor=null,this.backgroundAlpha=1,this.backgroundImage=null,this.backgroundInfo=null,this.scaleBg=!0,this.borderColor=null,this.borderAlpha=1,this.borderWidth=0,this.borderImageInfo=null,this.cacheBorderImage=!1,this.x=0,this.y=0,this.w=0,this.h=0,this.aabb=null,this.pixel=null,this.composite=!0,this.children=null,this.childrenMap=null,this.touchTarget=!0,this.useCache=!1,this.readyForCache=!1,this.cached=!1,this.needToCompute=!0},init:function(){this.inited=!0,this.id=this.id||"cmp_"+l._SN++,this.root=this.root||this.parent&&this.parent.root,this.root&&(this.root.all[this.id]&&console.log("Duplicate id : "+this.id),this.root.all[this.id]=this),this.aabb=[],this.pixel={relativeX:0,relativeY:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0},s.applyTo(this),this.touchTarget&&n.applyTo(this),this.composite&&(e.applyTo(this),this.setLayout(this.layout),this.childSN=0),this.setMargin(this.margin||0),this.setPadding(this.padding||0),this.setParent(this.parent,!0),this.initBackground()},initChildren:r,initBackground:function(t){this.backgroundHolder&&!t||(this.backgroundInfo=this.backgroundInfo||this.bgInfo,this.backgroundImage=this.backgroundImage||this.backgroundImg||this.bgImg,this.borderImageInfo?this.setBorderImageInfo(this.borderImageInfo):this.backgroundInfo?this.setBackgroundInfo(this.backgroundInfo):this.backgroundImage&&this.setBackgroundImage(this.backgroundImage))},setBackgroundInfo:function(t){var i=null;t&&("color"in t&&(this.backgroundColor=t.color),i=new CUI.BackgroundImageHolder(t)),this.setBackgroundHolder(i)},setBorderImageInfo:function(t){var i=t?new CUI.BorderImageHolder(t):null;this.scaleBg=!0,this.setBackgroundHolder(i)},setBackgroundImage:function(t){this.setBackgroundInfo(t?{img:t}:null)},setBackgroundHolder:function(t){(this.backgroundHolder=t)&&(this.backgroundHolder.setParent(this),this.backgroundHolder.fillParent=this.scaleBg,this.backgroundHolder.init(),this.backgroundHolder.updateSize(),this.backgroundHolder.updatePosition()),this.needToCompute=!0},beforeInit:null,afterInit:null,_beforeInit:r,_afterInit:r,setLayout:function(t){var i;if("string"==typeof t)e=t;else if(t&&t.constructor===Object){var e=t.name;i=t}if(e)switch(e){case"vbox":t=new CUI.VBoxLayout(i);break;case"hbox":t=new CUI.HBoxLayout(i);break;case"table":t=new CUI.TableLayout(i);break;default:t=new CUI.BaseLayout(i)}t||(t=o.commonLayout),this.layout=t},setParent:function(t,i){t&&(t!==this.parent||i)&&(this.parent=t).addChild(this)},addChild:function(t){this.composite&&(e.prototype.addChild.call(this,t),t.root=this.root,t.index=this.childSN++,"auto"===this.width&&(this.pixel.w=0),"auto"===this.height&&(this.pixel.h=0),this.needToCompute=!0,this.sortChildren())},removeChild:function(t){this.composite&&(e.prototype.removeChild.call(this,t)&&("auto"===this.width&&(this.pixel.w=0),"auto"===this.height&&(this.pixel.h=0),this.needToCompute=!0))},sortChildren:function(){this.children.sort(function(t,i){return t.zIndex-i.zIndex||t.index-i.index})},setZIndex:function(t){this.zIndex=t,(this.parent||this.root).sortChildren()},setMargin:function(t){this.margin=t,this.marginLeft=null===this.marginLeft?this.margin:this.marginLeft,this.marginTop=null===this.marginTop?this.margin:this.marginTop,this.marginRight=null===this.marginRight?this.margin:this.marginRight,this.marginBottom=null===this.marginBottom?this.margin:this.marginBottom},setPadding:function(t){this.padding=t,this.paddingLeft=null===this.paddingLeft?this.padding:this.paddingLeft,this.paddingTop=null===this.paddingTop?this.padding:this.paddingTop,this.paddingRight=null===this.paddingRight?this.padding:this.paddingRight,this.paddingBottom=null===this.paddingBottom?this.padding:this.paddingBottom},setReflow:function(t,i){if(!t)return this.needToCompute=!1;if("root"===t){var e=this.root||this.parent;e&&(e.needToCompute=!0,i&&e.computeLayout())}else if("parent"===t){var s=this.parent||this.root;s&&(s.needToCompute=!0,i&&s.computeLayout())}else if(!0===t){for(var h,n=!1,o=this;o&&((h=o).needToCompute=!0,!n&&"root"!==o.relative);)"parent"===o.relative&&(n=!0),o=o.parent;i&&h.computeLayout()}else this.needToCompute=!0,i&&this.computeLayout();return!0},setPosition:function(t,i){this.left!==t&&null!==t&&(this.left=t),this.top!==i&&null!=i&&(this.top=i),this.setReflow("parent")},setSize:function(t,i,e){(e||this.width!==t)&&(this.width=t,this.computeWidth()),(e||this.height!==i)&&(this.height=i,this.computeHeight())},setAnchor:function(t,i){this.anchorX=t,this.anchorY=i},updateAnchor:function(){this.pixel.anchorX=h.parseValue(this.anchorX,this.w)||0,this.pixel.anchorY=h.parseValue(this.anchorY,this.h)||0},updateAABB:function(){this.aabb[0]=this.x-this.extLeft,this.aabb[1]=this.y-this.extTop,this.aabb[2]=this.x+this.w+this.extRight,this.aabb[3]=this.y+this.h+this.extBottom},syncPosition:function(){var t=this.parent||this.root;this.x=this.pixel.relativeX+t.x,this.y=this.pixel.relativeY+t.y,this.updateAABB(),this.syncHolders(),this.composite&&this.children.forEach(function(t){t.syncPosition()})},syncHolders:function(){this.backgroundHolder&&(this.backgroundHolder.updateSize(),this.backgroundHolder.updatePosition())},moveToX:function(t){var i=this.pixel;i.left=t,i.relativeX=t+i.realMarginLeft,this.syncPosition()},moveToY:function(t){var i=this.pixel;i.top=t,i.relativeY=t+i.realMarginTop,this.syncPosition()},moveTo:function(t,i){var e=this.pixel;e.left=t,e.relativeX=t+e.realMarginLeft,e.top=i,e.relativeY=i+e.realMarginTop,this.syncPosition()},moveBy:function(t,i){var e=this.pixel,s=e.relativeX-e.realMarginLeft+t;e.left=s,e.relativeX=s+e.realMarginLeft;var h=e.relativeY-e.realMarginTop+i;e.top=h,e.relativeY=h+e.realMarginTop,this.syncPosition()},show:function(){return!this.visible&&(this.visible=!0,this.update(0),this.onShow(),!0)},onShow:r,hide:function(){return!!this.visible&&(this.visible=!1,this.onHide(),!0)},onHide:r,toggle:function(){return this.visible?this.hide():this.show()},setLeft:function(t){this.left!==t&&(this.left=t,this.setReflow("parent"))},setRight:function(t){this.right!==t&&(this.right=t,this.setReflow("parent"))},setTop:function(t){this.top!==t&&(this.top=t,this.setReflow("parent"))},setBottom:function(t){this.bottom!==t&&(this.bottom=t,this.setReflow("parent"))},resize:function(){this.computeWidth(),this.computeHeight(),this.computePositionX(),this.computePositionY(),this.computePadding(),this.updateAABB(),this.needToCompute=!0,this.onResize()},onResize:r,computeSelf:function(t){this.computeMargin(t),this.computeRealMargin(t),this.computeWidth(),this.computeHeight(),this.computePositionX(t),this.computePositionY(t),this.computePadding(),this.updateAABB()},computeLayout:function(t){(this.needToCompute||t)&&(this.needToCompute=!1,this.composite&&this.layout.compute(this),this.backgroundHolder&&(this.backgroundHolder.updateSize(),this.backgroundHolder.updatePosition()))},getChildrenCount:function(){return this.composite?this.children.length:0},isInView:function(){return this.checkCollideAABB(this.root.aabb)},isInRegion:function(t,i,e,s){var h=this.aabb;return h[2]>t&&h[3]>i&&h[1]<i+s&&h[0]<t+e},containPoint:function(t,i){var e=this.aabb;return e[0]<t&&t<e[2]&&e[1]<i&&i<e[3]},checkCollideAABB:function(t){var i=this.aabb;return t[0]<i[2]&&t[2]>i[0]&&t[1]<i[3]&&t[3]>i[1]},updateSelf:function(t,i){},updateChildren:function(i,e){this.children.forEach(function(t){t.update(i,e)})},update:function(t,i){this.beforeUpdate&&this.beforeUpdate(t,i),this.computeLayout(),this.updateSelf(t,i),this.composite&&this.visible&&this.updateChildren(t,i),this.afterUpdate&&this.afterUpdate(t,i)},beforeUpdate:null,afterUpdate:null,createCacheCanvas:function(){if(!this.cacheCanvas){var t=l.getCanvasFromPool(this.id);t.width=this.w+4,t.height=this.h+4,this.cacheCanvas=t}var i=this.cacheCanvas.getContext("2d"),e=new CUI.CanvasRenderer({context:i}),s=this.useCache,h=this.visible;this.useCache=!1,this.visible=!0,e.translate(2-this.x,2-this.y);var n=Date.now();this.renderSelf(e,0,n),this.composite&&this.renderChildren(e,0,n),e.translate(this.x-2,this.y-2),this.useCache=s,this.visible=h,this.cached=!0},renderSelf:function(t,i,e){null!==this.backgroundColor&&(t.setAlpha(this.backgroundAlpha),t.fillRect(this.x,this.y,this.w,this.h,this.backgroundColor),t.restoreAlpha()),this.backgroundHolder&&this.backgroundHolder.render(t,i,e),this.borderWidth&&null!==this.borderColor&&(t.setAlpha(this.borderAlpha),t.strokeRect(this.x,this.y,this.w,this.h,this.borderWidth,this.borderColor),t.restoreAlpha())},renderChildren:function(i,e,s){this.children.forEach(function(t){t.render(i,e,s)})},renderModalMask:function(t,i,e){if((this.maskColor||0===this.maskColor)&&"none"!==this.maskColor){var s=this.root,h=s.x,n=s.y,o=s.w,r=s.h,l=s.maskOffset;l&&(h+=l.x||0,n+=l.y||0,o+=l.w||0,r+=l.h||0),t.setAlpha(this.maskAlpha),t.fillRect(h,n,o,r,this.maskColor),t.restoreAlpha()}},render:function(t,i,e){if(this.visible&&!(this.alpha<=0)){this.modal&&this.renderModalMask(t,i,e),this.beforeRender&&this.beforeRender(t,i,e);var s=t.getAlpha();1!==this.alpha&&t.setAlpha(this.alpha),this.beforeTransform(t,i,e),this.useCache&&this.readyForCache?(this.cached||(this.createCacheCanvas(),this.cacheDisplayObject=t.createDisplayObject(this.cacheCanvas)),t.renderAt(this.cacheDisplayObject,this.x-2,this.y-2)):(this.readyForCache=!0,this.renderSelf(t,i,e),this.composite&&this.renderChildren(t,i,e)),this.afterTransform(t,i,e),t.setAlpha(s),this.afterRender&&this.afterRender(t,i,e)}},beforeRender:null,afterRender:null,beforeTransform:function(t,i,e){if(1!==this.scale||0!==this.rotation){var s=this.x+this.pixel.anchorX,h=this.y+this.pixel.anchorY;t.save(),t.setOrigin(s,h),t.translate(this.offsetX,this.offsetY),t.scale(this.scale,this.scale),t.rotate(this.rotation)}else(this.offsetX||this.offsetY)&&(t.save(),t.translate(this.offsetX,this.offsetY))},afterTransform:function(t,i,e){(1!==this.scale||0!==!this.rotation||this.offsetX||this.offsetY)&&t.restore()},computeMargin:function(t){var i=(t=t||this.parent).pixel,e=this.pixel;this.marginLeft=null===this.marginLeft?this.margin:this.marginLeft,this.marginTop=null===this.marginTop?this.margin:this.marginTop,this.marginRight=null===this.marginRight?this.margin:this.marginRight,this.marginBottom=null===this.marginBottom?this.margin:this.marginBottom,e.marginLeft=h.parseValue(this.marginLeft,i.width)||0,e.marginRight=h.parseValue(this.marginRight,i.width)||0,e.marginTop=h.parseValue(this.marginTop,i.height)||0,e.marginBottom=h.parseValue(this.marginBottom,i.height)||0},computeRealMargin:function(t){var i=(t=t||this.parent).pixel,e=this.pixel;e.realMarginLeft=Math.max(i.paddingLeft,e.marginLeft)||0,e.realMarginTop=Math.max(i.paddingTop,e.marginTop)||0,e.realMarginRight=Math.max(i.paddingRight,e.marginRight)||0,e.realMarginBottom=Math.max(i.paddingBottom,e.marginBottom)||0,e.realOuterWidth=i.width-e.realMarginLeft-e.realMarginRight,e.realOuterHeight=i.height-e.realMarginTop-e.realMarginBottom},computeWidth:function(){var t=this.pixel,i=t.realOuterWidth;t.width=h.parseValue(this.width,i),t.anchorX=h.parseValue(this.anchorX,t.width)||0,t.innerWidth=t.width-t.paddingLeft-t.paddingRight,this.w=t.width},computeHeight:function(){var t=this.pixel,i=t.realOuterHeight;t.height=h.parseValue(this.height,i),t.anchorY=h.parseValue(this.anchorY,t.height)||0,t.innerHeight=t.height-t.paddingTop-t.paddingBottom,this.h=t.height},computePadding:function(){var t=this.pixel;this.paddingLeft=null===this.paddingLeft?this.padding:this.paddingLeft,this.paddingTop=null===this.paddingTop?this.padding:this.paddingTop,this.paddingRight=null===this.paddingRight?this.padding:this.paddingRight,this.paddingBottom=null===this.paddingBottom?this.padding:this.paddingBottom,t.paddingLeft=h.parseValue(this.paddingLeft,t.width)||0,t.paddingRight=h.parseValue(this.paddingRight,t.width)||0,t.paddingTop=h.parseValue(this.paddingTop,t.height)||0,t.paddingBottom=h.parseValue(this.paddingBottom,t.height)||0,t.innerWidth=t.width-t.paddingLeft-t.paddingRight,t.innerHeight=t.height-t.paddingTop-t.paddingBottom},computePositionX:function(t){t=t||this.parent;var i=this.pixel,e=i.realOuterWidth;i.left=h.parseValue(this.left,e),i.right=h.parseValue(this.right,e);var s=0;s=!0===this.centerH?(e-i.width)/2+(i.left||0):null===i.left&&null!==i.right?e-i.width-i.right:i.left||0,i.relativeX=s+i.realMarginLeft,this.x=i.relativeX+(t?t.x:0)},computePositionY:function(t){t=t||this.parent;var i=this.pixel,e=i.realOuterHeight;i.top=h.parseValue(this.top,e),i.bottom=h.parseValue(this.bottom,e);var s=0;s=!0===this.centerV?(e-i.height)/2+(i.top||0):null===i.top&&null!==i.bottom?e-i.height-i.bottom:i.top||0,i.relativeY=s+i.realMarginTop,this.y=i.relativeY+(t?t.y:0)},getRenderer:function(){return CUI.renderer},destructor:function(){this.root&&(delete this.root.all[this.id],this.root=null),this.parent=null,this.layout=null,this.composite&&(this.children.forEach(function(t){t.setParent(t.root)}),this.children=null,this.childrenMap=null)}});l._SN=0,l.canvasPool={},l.getCanvasFromPool=function(t){var i=l.canvasPool[t];return i||((i=document.createElement("canvas")).id=t,i.width=3,i.height=3,l.canvasPool[t]=i),i},l.create=function(t,i){var e=t.ui,s=t.children;delete t.ui,delete t.children,t.parent=i;var h=new e(t);return s&&s.forEach(function(t){l.create(t,h)}),h},t.Component=l,t.noop=r}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Composite,t.Component),s=t.noop,h=i.create({superclass:e,initialize:function(){this.id="cmp_root",this.width=null,this.height=null,this.left=null,this.top=null,this.originalX=0,this.originalY=0,this.resetSN=1},updateSelf:s,renderSelf:s,checkTouchSelf:s,init:function(){this.all={},(this.resetSN||0===this.resetSN)&&(e._SN=Number(this.resetSN)||1),null===this.left&&(this.left=this.originalX),null===this.top&&(this.top=this.originalY),this.beforeInit&&this.beforeInit(),this.left=this.left||0,this.top=this.top||0,this.relative="root",h.$super.init.call(this),this.pixel={paddingLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,marginLeft:0,marginTop:0,marginRight:0,marginBottom:0,realMarginLeft:0,realMarginTop:0,realMarginRight:0,realMarginBottom:0,realOuterWidth:this.width,realOuterHeight:this.height},this.aabb=[0,0],this.setSize(this.width,this.height,!0),this.computePositionX(),this.computePositionY(),(this.root=this).initChildren(),this.afterInit&&this.afterInit()},setSize:function(t,i,e){(e||this.width!==t)&&(this.viewportWidth=t,this.width=t,this.w=t,this.pixel.width=t,this.aabb[2]=t,this.needToCompute=!0),(e||this.height!==i)&&(this.viewportHeight=i,this.height=i,this.h=i,this.pixel.height=i,this.aabb[3]=i,this.needToCompute=!0)},checkTouch:function(t,i){if(this.disabled||!this.visible||this.alpha<=0)return!1;var e=this.checkTouchChildren(t,arguments);return!1!==e?e:void 0}});t.Root=h}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Font,i.create({initialize:function(){this.DEG_TO_RAD=Math.PI/180,this.RAD_TO_DEG=180/Math.PI,this.HALF_PI=Math.PI/2,this.DOUBLE_PI=2*Math.PI,this.x=0,this.y=0,this.width=null,this.height=null,this.anchorX=0,this.anchorY=0,this.alpha=1,this.offsetX=0,this.offsetY=0,this.offsetAlpha=0,this.alignH="center",this.alignV="middle",this.visible=!0,this.parent=null,this.needToCompute=!0},init:function(){this.setParent(this.parent)},setParent:function(t){this.parent=t,this.needToCompute=!0},setAnchor:function(t,i){this.anchorX=t,this.anchorY=i},setOffset:function(t,i){this.offsetX=t,this.offsetY=i},updateSize:function(){},updatePosition:function(){var t=this.parent;"center"===this.alignH?this.x=t.x+(t.w-this.pixel.width>>1):"right"===this.alignH?this.x=t.x+t.w-t.pixel.paddingRight-this.pixel.width:this.x=t.x+t.pixel.paddingLeft,"middle"===this.alignV||"center"===this.alignV?this.y=t.y+(t.h-this.pixel.height>>1):"bottom"===this.alignV?this.y=t.y+t.h-t.pixel.paddingBottom-this.pixel.height:this.y=t.y+t.pixel.paddingTop},render:function(t,i,e){if(!this.visible)return!1}}));t.BaseHolder=e,"undefined"!=typeof module&&(module.exports=e)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Component),s=t.BaseHolder,h=t.Font,n=i.create({superclass:s,initialize:function(){this.text=null,this.color="#000000",this.textAlign="start",this.verticalAlign="middle",this.alignH=null,this.alignV=null,this.textBaseline="top",this.lineCap="butt",this.lineJoin="round",this.strokeColor=null,this.strokeWidth=1,this.fontStyle=null,this.fontWeight=null,this.fontSize=14,this.fontName="Arial",this.lineHeight=null,this.lines=null,this.lineCount=1,this.shadowColor=null,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.measure=null,this.useCache=!1,this.cacheOffsetX=0,this.cacheOffsetY=0,this.cachePadding=4,this.shareCache=!1,this.useCachePool=!0,this.resizeWithText=!0,this.lineHeight=0,this.width=8,this.height=8},init:function(){this.pixel={width:this.width,height:this.height},this.setTextInfo(this),this.setParent(this.parent),this.id=this.id||"text-holder-"+this.parent.id,this.initTextObject(),this.computeSize()},createCache:function(){this.cacheCanvas||(this.shareCache?this.cacheCanvas=n.cacheCanvas:this.useCachePool?this.cacheCanvas=e.getCanvasFromPool(this.id):this.cacheCanvas=document.createElement("canvas")),this.cacheContext=this.cacheCanvas.getContext("2d"),this.cacheContext.textBaseline="top"},initTextObject:function(){var t=this.parent.getRenderer();t&&(t.webgl?(this.useCache=!0,this.shareCache=!1):t.canvas2d&&(this.useCache=!0,this.shareCache=!1),this.useCache&&(this.createCache(),this.textObject=t.createTextObject(this.cacheContext,!0)))},setTextInfo:function(t){t.alignH?this.alignH=t.alignH:this.alignH=t.textAlign||this.textAlign,t.alignV?this.alignV=t.alignV:this.alignV=t.verticalAlign||this.verticalAlign,this.setText(t.text,!0),this.color=t.color||this.color,this.fontName=t.fontName||this.fontName,this.fontSize=t.fontSize||this.fontSize,this.fontWeight=t.fontWeight,this.fontStyle=h.getStyle(this.fontSize,this.fontName,this.fontWeight)},setFontName:function(t){this.fontName=t,this.fontStyle=h.getStyle(this.fontSize,this.fontName,this.fontWeight)},setFontSize:function(t){this.fontSize=t,this.fontStyle=h.getStyle(this.fontSize,this.fontName,this.fontWeight)},setFontWeight:function(t){this.fontWeight=t,this.fontStyle=h.getStyle(this.fontSize,this.fontName,this.fontWeight)},setColor:function(t){this.color!==t&&(this.color=t,this.needToCompute=!0)},setShadowOffset:function(t,i){this.shadowOffsetX===t&&this.shadowOffsetY===i||(this.shadowOffsetX=t,this.shadowOffsetY=i,this.needToCompute=!0)},setText:function(t){this._text!==t&&(this.textChanged=!0,this._text=t,t=this.text=null==t?"":t,Array.isArray(t)?this.lines=t:this.lines=String(t).split(/(?:\r\n|\r|\n)/),this.lineCount=this.lines.length,this.needToCompute=!0)},computeSize:function(t){if(this.lines){if(t||this.resizeWithText){var i=o;i.font=this.fontStyle;var e=i.measureText(this.lines[0]);e.height=Math.ceil(1.5*this.fontSize),this.lineHeight=this.lineHeight||e.height,this.measure=e,this.width=e.width}else this.lineHeight=this.lineHeight||this.height,this.measure={width:this.width,height:this.lineHeight};this.height=this.lineHeight*this.lineCount,this.pixel.width=this.width,this.pixel.height=this.height,this.updatePosition(),this.needToCompute=!1,this.useCache&&("center"===this.alignH?this.cacheOffsetX=Math.ceil(this.width/2+this.strokeWidth+this.cachePadding):"right"===this.alignH||"end"===this.alignH?this.cacheOffsetX=this.width+this.strokeWidth+this.cachePadding:this.cacheOffsetX=this.strokeWidth+this.cachePadding,this.cacheOffsetY=this.strokeWidth+this.cachePadding,this.updateCache(),this.textObject.updateSize())}else this.needToCompute=!1},updateCache:function(){this.cacheCanvas.width=this.width+2*(this.strokeWidth+this.cachePadding),this.cacheCanvas.height=this.height+2*(this.strokeWidth+this.cachePadding),this.renderContent(this.cacheContext,this.cacheOffsetX,this.cacheOffsetY)},updatePosition:function(){var t=this.parent;"center"===this.alignH?this.x=t.x+(t.w>>1):"right"===this.alignH?this.x=t.x+t.w-t.pixel.paddingRight:this.x=t.x+t.pixel.paddingLeft,"middle"===this.alignV||"center"===this.alignV?this.y=t.y+(t.h-this.height>>1):"bottom"===this.alignV?this.y=t.y+t.h-t.pixel.paddingBottom-this.height:this.y=t.y+t.pixel.paddingTop},render:function(t,i,e){if(!this.visible||""===this.text||!this.lines)return!1;(this.needToCompute||this.shareCache)&&this.useCache&&(this.updateCache(),this.textObject.updateContent());var s=this.x-this.anchorX+this.offsetX,h=this.y-this.anchorY+this.offsetY;this.useCache?(s-=this.cacheOffsetX,h-=this.cacheOffsetY,t.renderAt(this.textObject,s,h)):this.renderContent(t.context,s,h)},renderContent:function(t,i,e){var s;t.font=this.fontStyle,t.textAlign=this.alignH,t.textBaseline=this.textBaseline,null!==this.shadowColor&&(s={blur:t.shadowBlur,color:t.shadowColor,offsetX:t.shadowOffsetX,offsetY:t.shadowOffsetY},t.shadowBlur=this.shadowBlur,t.shadowColor=this.shadowColor,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),null!==this.color&&(t.fillStyle=this.color),null!==this.strokeColor&&(t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.lineWidth=2*this.strokeWidth,t.strokeStyle=this.strokeColor),this.renderLines(t,i,e),this.textChanged=!1,this.needToCompute=!1,s&&(t.shadowBlur=s.blur,t.shadowColor=s.color,t.shadowOffsetX=s.offsetX,t.shadowOffsetY=s.offsetY)},renderLines:function(i,e,s,h){if(1<this.lineCount){var n=this,o=this.lineHeight;this.lines.forEach(function(t){n.renderText(i,t,e,s,h),s+=o})}else this.renderText(i,this.lines[0],e,s,h)},renderText:function(t,i,e,s,h){i&&(this.strokeColor&&!h&&t.strokeText(i,e,s),t.fillText(i,e,s))}}),o=document.createElement("canvas").getContext("2d");n.cacheCanvas=document.createElement("canvas"),n.cacheCanvas.width=3,n.cacheCanvas.height=3,t.TextHolder=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var i=t.Class,e=t.Utils,s=t.BaseHolder,h=(t.Component,i.create({superclass:s,initialize:function(){this.parent=null,this.src=null,this.img=null,this.sx=null,this.sy=null,this.sw=null,this.sh=null,this.ox=null,this.oy=null,this.w=null,this.h=null,this.alpha=null,this.scale=1,this.scaleX=null,this.scaleY=null,this.flipX=!1,this.flipY=!1,this.rotation=0,this.x=0,this.y=0,this.offsetX=0,this.offsetY=0,this.offsetW=0,this.offsetH=0,this.width="auto",this.height="auto",this.fillParent=!0,this.crossOrigin="anonymous",this.tint=null},init:function(){null===this.scaleX&&(this.scaleX=this.scale),null===this.scaleY&&(this.scaleY=this.scale),this.pixel={},this.src?this.load(this.src):this.img&&this.setImg(this.img),this.setParent(this.parent),this.id=this.id||"image-holder-"+this.parent.id},load:function(t){this.setSrc(this.src,t)},setSrc:function(t,i){this.src=t;var e=this;this.img=null;var s=new Image;return s.crossOrigin=this.crossOrigin,s.onload=function(t){e.setImg(s,i)},s.onerror=function(t){e.setImg(null,i)},s.src=t,s},setImgInfo:function(t){if(t){for(var i in t)"src"!==i&&"img"!==i&&(this[i]=t[i]);t.src?this.setSrc(t.src):t.img&&this.setImg(t.img)}},setImg:function(t,i){this.img=t,this.updateImgInfo(),i&&i(t)},updateImgInfo:function(t){var i=(t=t||this).sx,e=t.sy,s=t.sw,h=t.sh,n=t.w,o=t.h,r=t.ox,l=t.oy,a=this.img;null==i&&(i=0),null==e&&(e=0),null==s?s=a?a.width:0:a&&(s=Math.min(i+s,a.width)-i)<=0&&(i=a.width,s=0),null==h?h=a?a.height:0:a&&(h=Math.min(e+h,a.height)-e)<=0&&(e=a.height,h=0),null==r&&(r=0),null==l&&(l=0),null==n&&(n=s),null==o&&(o=h),this.pixel.sx=i,this.pixel.sy=e,this.pixel.sw=s,this.pixel.sh=h,this.ox=r,this.oy=l,this.w=n,this.h=o,this.initDisplayObject()},initDisplayObject:function(){if(this.img){var t=this.parent.getRenderer(),i=this.pixel;this.displayObject=t.createDisplayObject(this.img,i.sx,i.sy,i.sw,i.sh,!0),this.displayObject.tint=null===this.tint?16777215:this.tint}else this.displayObject=null},setTint:function(t){this.tint=t,this.displayObject&&(this.displayObject.tint=null===this.tint?16777215:this.tint)},removeImg:function(){this.img=null,this.displayObject=null},updateSize:function(){this.parent&&this.fillParent?this.pixel.width=e.parseValue(this.width,this.parent.pixel.width,this.w)||0:this.pixel.width=e.parseValue(this.width,this.w,this.w)||0,this.pixel.width=this.pixel.width*this.scaleX,this.pixel.ox=this.ox,this.parent&&this.fillParent?this.pixel.height=e.parseValue(this.height,this.parent.pixel.height,this.h)||0:this.pixel.height=e.parseValue(this.height,this.h,this.h)||0,this.pixel.height=this.pixel.height*this.scaleY,this.pixel.oy=this.oy},setScale:function(t){this.scale=t,this.scaleX=t,this.scaleY=t},simpleRender:function(t,i,e){if(!this.visible||!this.img)return!1;var s=this.x-this.anchorX+this.offsetX+this.ox,h=this.y-this.anchorY+this.offsetY+this.oy,n=this.pixel.width+this.offsetW,o=this.pixel.height+this.offsetH;t.drawDisplayObject(this.displayObject,s,h,n,o)},render:function(t,i,e){if(!this.visible||!this.img)return!1;var s=-this.anchorX,h=-this.anchorY,n=this.pixel.width,o=this.pixel.height,r=this.flipX?-1:1,l=this.flipY?-1:1,a=this.rotation%this.DOUBLE_PI;1!==r||1!==l||0!==a?(t.save(),t.translate(this.x+this.offsetX+this.pixel.ox,this.y+this.offsetY+this.pixel.oy),a&&t.rotate(a),t.scale(r,l)):(s+=this.x+this.offsetX+this.pixel.ox,h+=this.y+this.offsetY+this.pixel.oy),null!==this.alpha&&t.setAlpha(this.alpha),t.drawDisplayObject(this.displayObject,s,h,n+this.offsetW,o+this.offsetH),1!==r||1!==l||0!==a?t.restore():null!==this.alpha&&t.restoreAlpha()}}));t.ImageHolder=h,"undefined"!=typeof module&&(module.exports=h)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.ImageHolder),s=i.create({superclass:e,initialize:function(){this.width="100%",this.height="100%"},render:function(t,i,e){t.drawDisplayObject(this.displayObject,this.x+this.ox+this.offsetX,this.y+this.oy+this.offsetY,this.pixel.width,this.pixel.height)}});t.BackgroundImageHolder=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,n=(t.Utils,t.Component),e=t.ImageHolder,s=i.create({superclass:e,initialize:function(){this.borderImage=!0,this.width="100%",this.height="100%",this.T=null,this.R=null,this.B=null,this.L=null,this.fill=!0,this.useCache=!1},render:function(t,i,e){var s=this.pixel.width,h=this.pixel.height;this.useCache?(this.cacheCanvas||(this.cacheCanvas=this.cacheBorderImage(s,h),this.cacheDisplayObject=t.createDisplayObject(this.cacheCanvas)),t.drawDisplayObject(this.cacheDisplayObject,0,0,s,h)):this.renderBorderImage(t,this.x,this.y,s,h)},initDisplayObject:function(){},initBorderDisplayObject:function(t,i,e,s){var h=this.img,n=this.pixel,o=n.sx||0,r=n.sy||0,l=n.sw||h.width,a=n.sh||h.height,c=this.T,d=this.R,u=this.B,p=this.L;this.borderObject=t.createNineSliceObject(h,o,r,l,a,c,d,u,p,!0),this.borderObject.width=i,this.borderObject.height=e,this.borderDisplayInited=!0},renderBorderImage:function(t,i,e,s,h,n){this.borderDisplayInited?(this.borderObject.width=s,this.borderObject.height=h):this.initBorderDisplayObject(t,s,h,n),t.renderNineSliceObject(this.borderObject,i,e,s,h)},cacheBorderImage:function(t,i){var e=n.getCanvasFromPool(this.id);e.width=t,e.height=i;var s=e.getContext("2d"),h=new CUI.CanvasRenderer({context:s});return this.renderBorderImage(h,0,0,t,i,!0),e}});t.BorderImageHolder=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Component),s=i.create({superclass:e,initialize:function(){this.composite=!1,this.disabled=!1,this.backgroundColor=null},computeLayout:function(t){this.needToCompute=!1},render:function(t,i,e){null!==this.backgroundColor&&(t.setAlpha(this.backgroundAlpha),t.fillRect(this.x,this.y,this.w,this.h,this.backgroundColor),t.restoreAlpha())}});s.create=function(t,i,e){return new CUI.Blank({parent:e,width:t,height:i})},t.Blank=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Component),s=i.create({superclass:e,init:function(){this.beforeInit&&this.beforeInit(),s.$super.init.call(this),this.initChildren(),this.afterInit&&this.afterInit()}});t.Page=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,s=t.Utils,e=t.Component,h=t.Label,n=t.Button,o=i.create({superclass:e,init:function(){this.beforeInit&&this.beforeInit(),o.$super.init.call(this),this.initHead(),this.initChildren(),this.afterInit&&this.afterInit()},initHead:function(){this.titleInfo&&("left"in this.titleInfo||(this.titleInfo.left=8),"top"in this.titleInfo||(this.titleInfo.top=8),this.titleInfo.fontSize=this.titleInfo.fontSize||20,(this.titleInfo.parent=this).titleLabel=new h(this.titleInfo)),this.closeBtnInfo&&((this.closeBtnInfo.parent=this).closeButton=new n(this.closeBtnInfo))},computeWidth:function(){var t=this.pixel,i=null===this.width||"auto"===this.width,e=this.backgroundHolder;t.width=i&&!e?t.width||0:i&&e?e.w:s.parseValue(this.width,t.realOuterWidth),t.anchorX=s.parseValue(this.anchorX,t.width)||0,t.innerWidth=t.width-t.paddingLeft-t.paddingRight,this.w=t.width,e&&this.scaleBg&&(e.width=this.w)},computeHeight:function(){var t=this.pixel,i=null===this.height||"auto"===this.height,e=this.backgroundHolder;t.height=i&&!e?t.height||0:i&&e?e.h:s.parseValue(this.height,t.realOuterHeight),t.anchorY=s.parseValue(this.anchorY,t.height)||0,t.innerHeight=t.height-t.paddingTop-t.paddingBottom,this.h=t.height,e&&this.scaleBg&&(e.height=this.h)}});t.Panel=o,"undefined"!=typeof module&&(module.exports=o)}(CUI=CUI||{}),function(t){var i=t.Class,s=t.Utils,e=t.Component,h=t.ImageHolder,n=t.TextHolder,o=i.create({superclass:e,initialize:function(){this.composite=!1,this.disabled=!1,this.width=null,this.height=null,this.scaleBg=!1,this.backgroundColor=null,this.borderWidth=0,this.resizeWithText=!0,this.sizeHolder=1e-4,this.sizePadding=2},init:function(){this.beforeInit&&this.beforeInit(),o.$super.init.call(this),this._sizeChanged=!0,this.iconInfo&&this.setIconInfo(this.iconInfo),this.flagInfo&&this.setFlagInfo(this.flagInfo),this.initTextInfo(),this.setTextInfo(this.textInfo),this.computeSelf(this.parent),this.computeSizeWithText(!1),this.afterInit&&this.afterInit()},setImageHolder:function(t,i){i?this[t]?this[t].setImgInfo(i):(this[t]=new h(i),this[t].setParent(this),this[t].init()):this[t]=null,this.needToCompute=!0},setIconInfo:function(t){t?this.iconHolder?this.iconHolder.setImgInfo(t):(this.iconHolder=new h(t),this.iconHolder.setParent(this),this.iconHolder.init()):this.iconHolder=null,this.needToCompute=!0},setFlagInfo:function(t){t?this.flagHolder?this.flagHolder.setImgInfo(t):(this.flagHolder=new h(t),this.flagHolder.setParent(this),this.flagHolder.init()):this.flagHolder=null,this.needToCompute=!0},setTextInfo:function(t){this.textHolder?this.textHolder.setTextInfo(t):(this.textHolder=new n(t),this.textHolder.setParent(this),this.textHolder.init()),this.needToCompute=!0,this.needToComputeSize=!0},setTextColor:function(t){this.textHolder.setColor(t)},initTextInfo:function(){var i=this;i.textInfo=i.textInfo||{};["text","color","textAlign","verticalAlign","strokeColor","strokeWidth","fontSize","fontWeight","fontStyle","fontName","lineHeight"].forEach(function(t){!(t in i.textInfo)&&t in i&&(i.textInfo[t]=i[t])})},setText:function(t,i){this.textInfo&&(this.textInfo.text=t),this.textHolder.setText(t),this.needToComputeSize=this.textHolder.textChanged,this.needToCompute=!1!==i},computeWidth:function(){var t=this.pixel,i=null===this.width||"auto"===this.width,e=this.backgroundHolder;i?e&&!e.borderImage?t.width=e.w:(t.width=t.width||0,this._sizeChanged=!0):t.width=s.parseValue(this.width,t.realOuterWidth),t.anchorX=s.parseValue(this.anchorX,t.width)||0,t.width=t.width||this.sizeHolder,t.innerWidth=t.width-t.paddingLeft-t.paddingRight,this.w=t.width,e&&this.scaleBg&&(e.width=this.w)},computeHeight:function(){var t=this.pixel,i=null===this.height||"auto"===this.height,e=this.backgroundHolder;i?e&&!e.borderImage?t.height=e.h:(t.height=t.height||0,this._sizeChanged=!0):t.height=s.parseValue(this.height,t.realOuterHeight),t.anchorY=s.parseValue(this.anchorY,t.height)||0,t.height=t.height||this.sizeHolder,t.innerHeight=t.height-t.paddingTop-t.paddingBottom,this.h=t.height,e&&this.scaleBg&&(e.height=this.h)},computeSizeWithText:function(t){var i=this.textHolder.measure;if(i){this.needToComputeSize=!1;var e=this._sizeChanged=!1,s=this.borderWidth+this.paddingLeft+this.paddingRight+this.textHolder.offsetX,h=this.borderWidth+this.paddingTop+this.paddingBottom+this.textHolder.offsetY;if(null===this.width||"auto"===this.width){var n=i.width+s;this.pixel.width=n,this.w=n,e=!0}if(null===this.height||"auto"===this.height){var o=i.height*this.textHolder.lineCount+h;this.pixel.height=o,this.h=o,e=!0}if(e){var r=this.backgroundHolder;r&&r.borderImage&&(r.width=this.w,r.height=this.h,r.w=this.w,r.h=this.h,r.cacheCanvas=null),this.setReflow("parent",t)}}},computeLayout:function(t){(this.needToCompute||t)&&(this.textHolder&&this.textHolder.updatePosition(),this.backgroundHolder&&(this.backgroundHolder.updateSize(),this.backgroundHolder.updatePosition()),this.iconHolder&&(this.iconHolder.updateSize(),this.iconHolder.updatePosition()),this.flagHolder&&(this.flagHolder.updateSize(),this.flagHolder.updatePosition()),this.updateAnchor(),this.needToCompute=!1)},syncHolders:function(){this.backgroundHolder&&this.backgroundHolder.updatePosition(),this.iconHolder&&this.iconHolder.updatePosition(),this.textHolder&&this.textHolder.updatePosition(),this.flagHolder&&this.flagHolder.updatePosition()},renderSelf:function(t,i,e){if(this.textHolder&&(this.resizeWithText||this._sizeChanged)&&this.needToComputeSize&&(this.textHolder.computeSize(),this.computeSizeWithText(!0)),null!==this.backgroundColor&&(t.setAlpha(this.backgroundAlpha),t.fillRect(this.x,this.y,this.w,this.h,this.backgroundColor),t.restoreAlpha()),this.backgroundHolder&&this.backgroundHolder.render(t,i,e),this.iconHolder&&this.iconHolder.render(t,i,e),this.textHolder&&this.textHolder.render(t,i,e),this.flagHolder&&this.flagHolder.render(t,i,e),this.borderWidth&&null!==this.borderColor){t.setAlpha(this.borderAlpha);var s=this.aabb;t.strokeRect(s[0],s[1],s[2]-s[0],s[3]-s[1],this.borderWidth,this.borderColor),t.restoreAlpha()}}});t.Label=o,"undefined"!=typeof module&&(module.exports=o)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Label),s=t.ButtonComponent,h=i.create({superclass:e,initialize:function(){this.borderWidth=0,this.textAlign="center",this.scaleBg=!0},onDown:function(t,i,e){this.offsetY=2,this.scale=.92},onUp:function(t,i,e){this.offsetY=0,this.scale=1},beforeRender:function(t,i,e){this.disabled&&(this._prevAlpha=this.alpha,this.alpha=.6)},afterRender:function(t,i,e){this.disabled&&(this.alpha=this._prevAlpha)}});s.applyTo(h.prototype),t.Button=h,"undefined"!=typeof module&&(module.exports=h)}(CUI=CUI||{}),function(t){var i=t.Class,e=t.Utils,s=t.Component,h=t.ImageHolder,n=(t.TextHolder,i.create({superclass:s,initialize:function(){this.composite=!1,this.disabled=!1,this.width=null,this.height=null,this.scaleX=1,this.scaleY=1,this.scaleImg=!0,this.crossOrigin="Anonymous",this.tint=null},init:function(){this.beforeInit&&this.beforeInit(),n.$super.init.call(this),this.imageHolder=new h({parent:this,width:this.scaleImg?"100%":"auto",height:this.scaleImg?"100%":"auto",alignH:"center",alignV:"center",crossOrigin:this.crossOrigin,tint:this.tint}),this.imageHolder.init(),this.borderInfo&&this.setBorderInfo(this.borderInfo),this.src?this.setSrc(this.src):this.img?this.setImg(this.img):this.imgInfo&&this.setImgInfo(this.imgInfo),this.afterInit&&this.afterInit()},setTint:function(t){this.tint=t,this.imageHolder.setTint(t)},getTint:function(t){return this.tint},setSrc:function(t){this.src=t;var i=this;this.imageHolder.setSrc(t,function(t){t&&i.setReflow(!0),i.hasImg=!!i.imageHolder.img,i.needToCompute=!0})},setImg:function(t){this.img=t;var i=this;this.imageHolder.setImg(t,function(t){t&&i.setReflow(!0),i.hasImg=!!i.imageHolder.img,i.needToCompute=!0})},setImgInfo:function(t){this.imageHolder.setImgInfo(t),this.imageHolder.setTint(this.tint),this.hasImg=!!this.imageHolder.img,this.needToCompute=!0},setBorderInfo:function(t){t?(t.borderImage?this.borderHolder=new CUI.BorderImageHolder(t):this.borderHolder=new CUI.BackgroundImageHolder(t),this.borderHolder.setParent(this),this.borderHolder.fillParent=!0,this.borderHolder.init(),this.borderHolder.updateSize(),this.borderHolder.updatePosition()):this.borderHolder=null,this.needToCompute=!0},computeWidth:function(){var t=this.pixel,i=!1;null===this.width||"auto"===this.width?t.width=this.imageHolder.w:(i=!0,t.width=e.parseValue(this.width,t.realOuterWidth)),t.width*=this.scaleX,this.w=t.width,t.anchorX=e.parseValue(this.anchorX,this.w)||0,this.imageHolder.pixel.width=this.w,this.hasImg||i||(this.w=.01,t.width=.01)},computeHeight:function(){var t=this.pixel,i=!1;null===this.height||"auto"===this.height?t.height=this.imageHolder.h:(i=!0,t.height=e.parseValue(this.height,t.realOuterHeight)),t.height*=this.scaleY,this.h=t.height,t.anchorY=e.parseValue(this.anchorY,this.h)||0,this.imageHolder.pixel.height=this.h,this.hasImg||i||(this.h=.01,t.height=.01)},computeLayout:function(t){(this.needToCompute||t)&&(this.imageHolder.updateSize(),this.scaleImg?(this.imageHolder.x=this.x,this.imageHolder.y=this.y):this.imageHolder.updatePosition(),this.borderHolder&&(this.borderHolder.updateSize(),this.borderHolder.updatePosition()),this.needToCompute=!1)},syncHolders:function(){this.scaleImg?(this.imageHolder.x=this.x,this.imageHolder.y=this.y):this.imageHolder.updatePosition(),this.borderHolder&&(this.borderHolder.updateSize(),this.borderHolder.updatePosition())},renderSelf:function(t,i,e){null!==this.backgroundColor&&(t.setAlpha(this.backgroundAlpha),t.fillRect(this.x,this.y,this.w,this.h,this.backgroundColor),t.restoreAlpha()),this.backgroundHolder&&this.backgroundHolder.render(t,i,e),this.imageHolder&&this.imageHolder.render(t,i,e),this.borderHolder&&this.borderHolder.render(t,i,e),this.borderWidth&&null!==this.borderColor&&(t.setAlpha(this.borderAlpha),t.strokeRect(this.x,this.y,this.w,this.h,this.borderWidth,this.borderColor),t.restoreAlpha())}}));t.Picture=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Component),s=t.Slider,h=t.noop,n=i.create({superclass:e,initialize:function(){this.scrollH=!1,this.scrollV=!0,this.scrollX=0,this.scrollY=0,this.scrollDX=0,this.scrollDY=0,this.clip=!0,this.outEdge=90,this.damping=.0025,this.swipeScale=1.2,this.minScrollVel=.12,this.bounceDuration=180,this.scrollingDuration=700,this.scrollThumb=!0,this.thumbWidth=10,this.thumbColor="rgba(255,255,255,0.6)",this.thumbBgColor="rgba(0,0,0,0.4)",this.snapWidth=null,this.snapHeight=null},init:function(){this.beforeInit&&this.beforeInit(),n.$super.init.call(this),this.visibleChildren=[],this.slider=new s({}),this.damping&&(this.slider.damping=this.damping),this.scrollWidthOrigin=this.scrollWidth,this.scrollHeightOrigin=this.scrollHeight,this.initChildren(),this.resetScrollInfo(),this.afterInit&&this.afterInit()},resetScrollInfo:function(){this.slider.reset(),this.scrolling=0,this.scrollX=this.scrollDX=0,this.scrollY=this.scrollDY=0,this.lastScrollX=this.lastScrollY=0,this.visibleChildren.length=0;var t=this.children[0];if(t){var i=this.children[this.children.length-1],e=i.x+i.w+i.marginRight-t.x+t.marginLeft;e+=this.paddingLeft+this.paddingRight;var s=i.y+i.h+i.marginBottom-t.y+t.marginTop;s+=this.paddingTop+this.paddingBottom,this.scrollWidth=this.scrollWidthOrigin||e,this.scrollHeight=this.scrollHeightOrigin||s}else this.scrollWidth=this.scrollWidthOrigin||0,this.scrollHeight=this.scrollHeightOrigin||0;this.minScrollX=this.minScrollY=0,this.maxScrollX=Math.max(0,this.scrollWidth-this.w),this.maxScrollY=Math.max(0,this.scrollHeight-this.h),this.rateWidth=this.w/this.scrollWidth,this.rateHeight=this.h/this.scrollHeight,this.thumbHSize=(this.w-this.paddingLeft-this.paddingRight)*this.rateWidth>>0,this.thumbVSize=(this.h-this.paddingTop-this.paddingBottom)*this.rateHeight>>0,this.thumbX=this.scrollX*this.rateWidth>>0,this.thumbY=this.scrollY*this.rateHeight>>0,this.stopTween()},reset:function(){var i=this;this.children.forEach(function(t){t.moveBy(i.scrollX,i.scrollY)}),this.resetScrollInfo(),this.onReset()},onReset:h,startScroll:function(t,i){this.scrollH||(t=0),this.scrollV||(i=0),Math.abs(t)<this.minScrollVel&&Math.abs(i)<this.minScrollVel||(this.scorllOver=!1,this.slider.toStart=!0,this.slider.start(t,i))},stopScroll:function(){this.slider.stop(),this.stopTween()},focusOnChild:function(t,i,e){i=i||this.paddingLeft,e=e||this.paddingTop;var s=t.aabb,h=this.aabb,n=s[0]-i-h[0],o=s[2]+i-h[2],r=s[1]-e-h[1],l=s[3]+e-h[3],a=0,c=0;return n<0?a=n:0<o&&(a=o),r<0?c=r:0<l&&(c=l),!(!a&&!c)&&(this.scrollBy(a,c),[a,c])},scrollTo:function(t,i){this.stopTween(),this.scrollH&&this.setScrollX(t),this.scrollV&&this.setScrollY(i)},scrollBy:function(t,i){this.scrolling=this.scrollingDuration,this.scrollH&&((this.scrollX<this.minScrollX&&t<0||this.scrollX>this.maxScrollX&&0<t)&&(t*=.3),this.setScrollX(this.scrollX+t)),this.scrollV&&((this.scrollY<this.minScrollY&&i<0||this.scrollY>this.maxScrollY&&0<i)&&(i*=.3),this.setScrollY(this.scrollY+i))},setScrollX:function(t){this.scrollX=Math.max(this.minScrollX-this.outEdge,Math.min(this.maxScrollX+this.outEdge,t)),this.thumbX=this.scrollX*this.rateWidth>>0},setScrollY:function(t){this.scrollY=Math.max(this.minScrollY-this.outEdge,Math.min(this.maxScrollY+this.outEdge,t)),this.thumbY=this.scrollY*this.rateHeight>>0},canScroll:function(){var t=this.scrollH;if((this.scrollX<=this.minScrollX-this.outEdge/2||this.scrollX>=this.maxScrollX+this.outEdge/2)&&(t=!1),t)return!0;var i=this.scrollV;return(this.scrollY<=this.minScrollY-this.outEdge/2||this.scrollY>=this.maxScrollY+this.outEdge/2)&&(i=!1),i},startTween:function(t,i){t=t||{x:this.scrollX,y:this.scrollY},this.scrollH&&this.snapWidth&&(t.x=Math.round(t.x/this.snapWidth)*this.snapWidth),this.scrollV&&this.snapHeight&&(t.y=Math.round(t.y/this.snapHeight)*this.snapHeight),t.x=Math.min(this.maxScrollX,Math.max(this.minScrollX,t.x)),t.y=Math.min(this.maxScrollY,Math.max(this.minScrollY,t.y)),this.stopTween();var s=this,h=this.scrollX,n=this.scrollY,o=t.x-h,r=t.y-n;(o||r)&&(this.tween={duration:0===i||i?i:this.bounceDuration,played:0,target:t,onUpdate:function(t){var i=h+o*t-s.scrollX,e=n+r*t-s.scrollY;(i||e)&&s.scrollBy(i,e)},onComplete:function(){s.scrollX=this.target.x,s.scrollY=this.target.y,s.thumbX=s.scrollX*s.rateWidth>>0,s.thumbY=s.scrollY*s.rateHeight>>0,s.scorllOver=!0,s.stopScroll(),s.afterTween(s.scrollX,s.scrollY)}})},stopTween:function(){this.tween=null},afterTween:function(t,i){},updateTween:function(t){var i=this.tween;if(!i)return!1;if(i.played+=t,i.played<0)return!1;var e=i.played/i.duration;return 1<=e?(e=1,i.onComplete(),this.stopTween()):i.onUpdate(e),!0},onTouchStart:function(t,i,e){return this.containPoint(t,i)&&this.stopScroll(),!1},onTouchEnd:function(t,i,e){return this.startTween(),!1},onPan:function(t,i,e,s,h,n,o){if(this.scrollV&&this.scrollH&&this.containPoint(t,i))this.scrollBy(-e,-s);else{if(!(this.scrollV&&this.containPoint(t,n)||this.scrollH&&this.containPoint(h,i)))return!1;this.scrollBy(-e,-s)}},onSwipe:function(t,i,e,s,h,n,o){return!!this.containPoint(h,n)&&(e*=this.swipeScale,s*=this.swipeScale,void this.startScroll(-e,-s))},computeLayout:function(t){this.composite&&(this.needToCompute||t)&&(this.needToCompute=!1,this.layout.compute(this),this.reset())},updateSelf:function(t,i){if(this.updateTween(t),!this.scorllOver){var e=this.slider.update(t);e&&this.scrollBy(this.slider.dx,this.slider.dy),e&&this.canScroll()||(this.scorllOver=!0,this.startTween())}},updateChildren:function(e,s){var h=this;this.scrollDX=this.scrollX-this.lastScrollX,this.scrollDY=this.scrollY-this.lastScrollY;var n=this.visibleChildren,o=this.scrollDX||this.scrollDY||0===n.length;o&&(n.length=0),this.children.forEach(function(t,i){o&&(t.moveBy(-h.scrollDX,-h.scrollDY),h.checkCollideAABB(t.aabb)&&n.push(t)),t.update(e,s)}),this.scrollDX=0,this.scrollDY=0,this.lastScrollX=this.scrollX,this.lastScrollY=this.scrollY},renderScrollbar:function(t,i,e){if(this.thumbWidth&&!(this.scrollThumb&&this.scrolling<=0)){if(this.scrolling-=i,this.scrollH&&this.rateWidth<1){var s=this.y+this.h-this.thumbWidth;t.fillRect(this.x+this.paddingLeft+0,s,this.w,this.thumbWidth,this.thumbBgColor),t.fillRect(this.x+this.paddingLeft+this.thumbX+1,s+1,this.thumbHSize-2,this.thumbWidth-2,this.thumbColor)}if(this.scrollV&&this.rateHeight<1){var h=this.x+this.w-this.thumbWidth;t.fillRect(h,this.y+this.paddingTop+0,this.thumbWidth,this.h,this.thumbBgColor),t.fillRect(h+1,this.y+this.paddingTop+this.thumbY+1,this.thumbWidth-2,this.thumbVSize-2,this.thumbColor)}}},startClip:function(t){var i=this.root,e=i.originalX||0,s=i.originalY||0;t.clipRect(this.x+e,this.y+s,this.w,this.h)},endClip:function(t){t.unclipRect()},renderChildren:function(i,e,s){this.clip&&this.startClip(i),this.visibleChildren.forEach(function(t){t.render(i,e,s)}),this.renderScrollbar(i,e,s),this.clip&&this.endClip(i)},getTouchableChildren:function(){return this.visibleChildren}});t.ScrollView=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{});