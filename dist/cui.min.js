"use strict";var CUI=CUI||{};!function(t){var n={SN:0,create:function(e,t,i){"object"==typeof e&&arguments.length<3&&(i=t,t=e,(e=function(t){for(var i in this._superInitialize&&this._superInitialize(t),this.initialize&&this.initialize(t),t)this[i]=t[i];!(this._initialized=!0)===this.lazyInit&&this.init&&this.init()}).classSN=++n.SN);var s=e.prototype;for(var h in t)s[h]=t[h];return s._superInitialize=function(t){var i=e.$super;i&&(i._superInitialize&&i._superInitialize.call(this,t),i.initialize&&i.initialize.call(this,t))},n.extend(e,i),e},extend:function(t,i){var e,s=t,h=s.prototype;for(var n in e="function"==typeof(i=s.superclass=i||s.superclass||h.superclass)?i.prototype:i)if(!(n in h)&&"constructor"!==n){var o=Object.getOwnPropertyDescriptor(e,n);o?Object.defineProperty(h,n,o):h[n]=e[n]}return s.$super=e,s.superclass=i,h.superclass=i,h.constructor||(h.constructor=s),t},defineProperties:function(t,i){for(var e=0;e<i.length;e++){var s=i[e],h=s.enumerable;s.enumerable=!1!==h,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}};CUI.Class=n,"undefined"!=typeof module&&(module.exports=n)}(),function(t){CUI.ImagePool=CUI.ImagePool||{},CUI.ImageMapping=CUI.ImageMapping||{};var a=document.createElement("canvas").getContext("2d"),_={loadImage:function(t,i){var e=new Image;return e.crossOrigin="anonymous",e.onload=function(t){i&&i(e,t)},e.onerror=function(t){i&&i(null,t)},e.src=t,e},loadImages:function(t,s){var h=t.length,n={},o=-1,a=function(){if(h<=++o)s&&s(n);else{var i=t[o],e=new Image;e.crossOrigin="anonymous",e.src=i.src,e.id=i.id,e.onload=function(t){n[e.id]=e,i.onLoad&&i.onLoad.call(e,e),a()},e.onerror=function(t){i.onError&&i.onError.call(e,e),a()}}};return a(),n},parseValue:function(t,i,e){if("string"!=typeof t)return"number"==typeof t||!0===t||!1===t||null==t?t:parseFloat(t)||0;if("auto"===(t=t.trim()))return void 0===e?0:e;var s,h,n,o;if(0<(s=t.lastIndexOf("+"))){var a=t.substring(0,s),l=t.substring(s+1);return(a=_.parseValue(a,i))+(l=_.parseValue(l,i))}if(0<(h=t.lastIndexOf("-"))){a=t.substring(0,h),l=t.substring(h+1);return(a=_.parseValue(a,i))-(l=_.parseValue(l,i))}if(0<(n=t.lastIndexOf("*"))){a=t.substring(0,n),l=t.substring(n+1);return(a=_.parseValue(a,i))*(l=_.parseValue(l,i))}if(0<(o=t.lastIndexOf("/"))){a=t.substring(0,o),l=t.substring(o+1);return(a=_.parseValue(a,i))*(l=_.parseValue(l,i))}return 0<t.lastIndexOf("%")?t=parseFloat(t)/100*(i||0):parseFloat(t)||0},getExistValue:function(t,i){return null!=t?t:i},createCanvas:function(t,i){var e=document.createElement("canvas");return e.width=t,e.height=i,e},getImageInfo:function(t,i){var e=t;if(t){if("string"!=typeof e){if(!e.tagName)return t;e=(o=e).src}else o=CUI.ImagePool[e];if(o)return h={id:e,img:o,sx:0,sy:0,sw:o.width,sh:o.height,ox:0,oy:0,w:o.width,h:o.height};var s=CUI.ImageMapping[e];if(s){var h,n=s.img,o=CUI.ImagePool[n];return(h={id:e,sx:s.x,sy:s.y,sw:s.w,sh:s.h,ox:s.ox,oy:s.oy,w:s.sw,h:s.sh}).img=o,h}}return console.log("Utils.getUIImgInfo err : ",e),i?null:((h={id:e,sx:0,sy:0,sw:2,sh:2,ox:0,oy:0,w:2,h:2,lazy:!0}).img=_.blankCanvas,h)},renderImageInfo:function(t,i,e,s,h,n){e=e||0,s=s||0,t.drawImage(i.img,i.sx,i.sy,i.sw,i.sh,e+i.ox>>0,s+i.oy>>0,h||i.sw,n||i.sh)},renderInfoImg:function(t,i,e,s,h,n){e=e||0,s=s||0,t.drawImage(i.img,i.sx,i.sy,i.sw,i.sh,e,s,h||i.sw,n||i.sh)},strokeAABB:function(t,i,e,s){e=e||"red";var h=t.strokeStyle;s&&(t.lineWidth=s),t.strokeStyle=e,t.strokeRect(i[0],i[1],i[2]-i[0],i[3]-i[1]),t.strokeStyle=h},fillAABB:function(t,i,e){e=e||"red";var s=t.fillStyle;t.fillStyle=e,t.fillRect(i[0],i[1],i[2]-i[0],i[3]-i[1]),t.fillStyle=s},setContextColor:function(t,i,e,s,h){if("string"==typeof e)t[i]=e;else{var n=e.stops||e,o=e.x0||0,a=e.y0||0,l=e.x1||0===e.x1?e.x1:s,r=e.y1||0===e.y1?e.y1:h,d=t.createLinearGradient(o,a,l,r);n.forEach(function(t){d.addColorStop(t[0],t[1])}),t[i]=d}},setFillColor:function(t,i,e,s){_.setContextColor(t,"fillStyle",i,e,s)},setStrokeColor:function(t,i,e,s){_.setContextColor(t,"strokeStyle",i,e,s)},drawPath:function(t,i,e){var s=i.length,h=i[0];t.beginPath(),t.moveTo(h[0],h[1]);for(var n=1;n<s;){var o=i[n],a=o.length;if(2===a)t.moveTo(o[0],o[1]);else{var l=o[a-1];if("line"===l)t.lineTo(o[0],o[1]);else if("circle"===l)t.arc(o[0],o[1],o[2],o[3],o[4],o[5]);else if("rect"===l){var r=o[0],d=o[1],u=o[2],c=o[3];t.moveTo(r,d),t.lineTo(r+u,d),t.lineTo(r+u,d+c),t.lineTo(r,d+c),t.lineTo(r,d)}else"arc"===l?t.arcTo(o[0],o[1],o[2],o[3],o[4]):"bezier"===l?t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]):"quad"!==l&&"quadratic"!==l||t.quadraticCurveTo(o[0],o[1],o[2],o[3])}if(o===h)break;n++,e&&n===s&&(n=0)}e&&t.closePath()},borderRadiusPath:function(t,i,e,s,h,n,o,a,l,r){t.beginPath();var d=Math.abs(n),u=Math.abs(o),c=Math.abs(a),p=Math.abs(l);2===r?(t.moveTo(i+d,e),t.lineTo(i+s-u,e),0!==u&&t.lineTo(i+s,e+u),t.lineTo(i+s,e+h-c),0!==c&&t.lineTo(i+s-c,e+h),t.lineTo(i+p,e+h),0!==p&&t.lineTo(i,e+h-p),t.lineTo(i,e+d),0!==d&&t.lineTo(i+d,e)):3===r?(t.moveTo(i+d,e),t.lineTo(i+s-u,e),t.lineTo(i+s-c,e+h),t.lineTo(i+p,e+h),t.lineTo(i+d,e)):4===r?(t.moveTo(i,e+d),t.lineTo(i+s,e+u),t.lineTo(i+s,e+h-c),t.lineTo(i,e+h-p),t.lineTo(i,e+d)):5===r?(t.moveTo(i,e),t.lineTo(i+s,e),0!==u&&t.lineTo(i+s-u,e+h/2),t.lineTo(i+s,e+h),t.lineTo(i,e+h),0!==d&&t.lineTo(i+d,e+h/2),t.lineTo(i,e)):6===r?(t.moveTo(i,e),0!==d&&t.lineTo(i+s/2,e+d),t.lineTo(i+s,e),t.lineTo(i+s,e+h),0!==u&&t.lineTo(i+s/2,e+h-u),t.lineTo(i,e+h),t.lineTo(i,e)):(t.moveTo(i+d,e),t.lineTo(i+s-u,e),o<0?(o=-o,t.arcTo(i+s-o,e+o,i+s,e+o,o)):0<o&&(h<o?t.lineTo(i+s,e+h):t.arcTo(i+s,e,i+s,e+o,o)),t.lineTo(i+s,e+h-Math.min(h,c)),a<0?(a=-a,t.arcTo(i+s-a,e+h-a,i+s-a,e+h,a)):0<a&&t.arcTo(i+s,e+h,i+s-a,e+h,a),t.lineTo(i+p,e+h),l<0?(l=-l,t.arcTo(i+l,e+h-l,i,e+h-l,l)):0<l&&(h<l?t.lineTo(i,e):t.arcTo(i,e+h,i,e+h-l,l)),t.lineTo(i,e+Math.min(h,d)),n<0?(n=-n,t.arcTo(i+n,e+n,i+n,e,n)):0<n&&t.arcTo(i,e,i+n,e,n)),t.closePath()},fixRadius:function(t){var i=[];return Array.isArray(t)?4===t.length?(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3]):2===t.length?(i[0]=t[0],i[1]=t[1],i[2]=t[0],i[3]=t[1]):1===t.length&&(i[0]=t[0],i[1]=t[0],i[2]=t[0],i[3]=t[0]):(i[0]=t,i[1]=t,i[2]=t,i[3]=t),i},createRoundRect:function(t,i){var e=(t=Object.assign({mode:0,margin:0,x:0,y:0,width:0,height:0,lineCap:"round",color:null,radius:0,borderWidth:0,borderColor:null},t)).mode,s=t.margin,h=t.width,n=t.height,o=t.radius,a=(t.color,t.borderWidth/2),l=a,r=t.x+s+l,d=t.y+s+l,u=h-2*l,c=n-2*l,p=_.fixRadius(o);if(p.forEach(function(t,i){p[i]=Math.max(0,t-a)}),!i){var f=t.x+h+2*s,g=t.y+n+2*s;i=_.createCanvas(f,g)}var m=i.getContext("2d");m.lineCap=t.lineCap,_.borderRadiusPath(m,r,d,u,c,p[0],p[1],p[2],p[3],e),t.color&&(_.setFillColor(m,t.color,0,c),m.fill()),t.borderWidth&&(m.lineWidth=t.borderWidth,t.borderColor&&(_.borderRadiusPath(m,r,d,u,c,p[0],p[1],p[2],p[3],e),_.setStrokeColor(m,t.borderColor,0,c),m.stroke()));var b=t.textInfo;if(b){var v=r+b.x||0,x=d+b.y||0;m.font=b.font,m.textAlign=b.textAlign||"center",b.shadowColor&&(_.setFillColor(m,b.shadowColor),m.fillText(b.text,v+b.shadowOffsetX,x+b.shadowOffsetY)),b.strokeWidth&&(m.lineWidth=2*b.strokeWidth,_.setStrokeColor(m,b.strokeColor),m.strokeText(b.text,v,x)),b.color&&(_.setFillColor(m,b.color),m.fillText(b.text,v,x))}return i},createRoundRects:function(i,e,t,s){return 2===arguments.length&&"number"!=typeof i&&(t=i,s=e),s=s||_.createCanvas(i,e),t.forEach(function(t){t&&(t.width=t.width||i,t.height=t.height||e,_.createRoundRect(t,s))}),s},createButtonRect:function(t){var i=new CUI.ButtonBackground(t);return i.init(),i.image},getStringLength:function(t){for(var i=t.length,e=0,s=0;s<i;s++)0!=(65280&t.charCodeAt(s))?e+=2:e+=1;return e},getMaxLine:function(t){var i=t.length,e=0;if(1<i)for(var s=0,h=0;h<i;h++){var n=t[h];n=null==n?"":String(n);var o=_.getStringLength(n);s<o&&(s=o,e=h)}return t[e]},getTextWidth:function(t,i,e){var s=i+"px"+(e?" "+e:"");return _.measureText(t,s).width},measureText:function(t,i){var e=a,s=e.font;e.font=i;var h=e.measureText(t);return h=h||{width:0},e.font=s,h},measureLines:function(t,i){var e;e=Array.isArray(t)?t:String(t).split(/(?:\r\n|\r|\n)/);var s=a,h=s.font;s.font=i;var n=CUI.Utils.getMaxLine(e),o=s.measureText(n);return o=o||{width:0},s.font=h,o},createTextCanvas:function(t,i){var e={};for(var s in i)e[s]=i[s];e.lines=t},renderTextContent:function(t,i,e,s){t.font=i.fontStyle,t.textAlign=i.textAlign||"left";var h=i.strokeWidth||0;h&&("left"===t.textAlign?e+=h/2:"center"===t.textAlign||(e-=h/2)),"top"===i.textBaseline?(t.textBaseline="alphabetic",s+=i.fontSize+h/2):"bottom"===i.textBaseline?(t.textBaseline="alphabetic",s-=i.fontSize/4+h/2):"middle"===i.textBaseline?(t.textBaseline="alphabetic",s+=i.fontSize/2-i.fontSize/4):t.textBaseline=i.textBaseline;var n,o=null!==i.strokeColor;null!==i.shadowColor&&(n={blur:t.shadowBlur,color:t.shadowColor,offsetX:t.shadowOffsetX,offsetY:t.shadowOffsetY},t.shadowBlur=i.shadowBlur,t.shadowColor=i.shadowColor,t.shadowOffsetX=i.shadowOffsetX,t.shadowOffsetY=i.shadowOffsetY),o&&(t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.lineWidth=2*h,t.strokeStyle=i.strokeColor),null!==i.color&&(t.fillStyle=i.color),this.renderTextLines(t,i.lines,i.lineHeight,e,s,o),n&&(t.shadowBlur=n.blur,t.shadowColor=n.color,t.shadowOffsetX=n.offsetX,t.shadowOffsetY=n.offsetY)},renderTextLines:function(i,t,e,s,h,n){var o=this;1<t.length?t.forEach(function(t){null!=t&&o.renderText(i,t,s,h,n),h+=e}):o.renderText(i,t[0],s,h,n)},renderText:function(t,i,e,s,h){i&&(h&&t.strokeText(i,e,s),t.fillText(i,e,s))}};_.blankCanvas=_.createCanvas(2,2),t.Utils=_,"undefined"!=typeof module&&(module.exports=_)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,function(){}),h=i.create({initialize:function(){this.id=null,this.lazyInit=!1,this.pixel={x:0,y:0,width:0,height:0,baseX:0,baseY:0,relativeX:0,relativeY:0,paddingLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,marginLeft:0,marginTop:0,marginRight:0,marginBottom:0,realMarginLeft:0,realMarginTop:0,realMarginRight:0,realMarginBottom:0,innerWidth:0,innerHeight:0,realOuterWidth:0,realOuterHeight:0},this.root=null,this.parent=null,this.displayObject=null,this.aabb=null,this.width=null,this.height=null,this.relativeX=0,this.relativeY=0,this.zIndex=0,this.offsetX=0,this.offsetY=0,this.alignH="left",this.alignV="top",this._visible=!0,this._alpha=1,this._tint=null,this._rotation=0,this._scale=1,this._scaleX=1,this._scaleY=1,this._flipX=!1,this._flipY=!1,this._absoluteX=0,this._absoluteY=0,this._absoluteWidth=0,this._absoluteHeight=0,this._displayWidth=0,this._displayHeight=0,this._anchor=0,this._anchorX=0,this._anchorY=0,this._pivotX=0,this._pivotY=0,this._offsetX=0,this._offsetY=0,this._displayOffsetX=0,this._displayOffsetY=0,this._sizeChanged=!0,this._positionChanged=!0,this._needToCompute=!0},addChildDisplayObject:function(t){t&&(this.displayObject||this.initDisplayObject(),t.displayObject&&(t.insertIndex||0===t.insertIndex?this.displayObject.addChildAt(t.displayObject,t.insertIndex):this.displayObject.addChild(t.displayObject)))},removeChildDisplayObject:function(t){t&&this.displayObject&&t.displayObject&&this.displayObject.removeChild(t.displayObject)},cacheAsCanvas:function(t,i){this._absoluteX,this._absoluteY;t=t||this._absoluteWidth,i=i||this._absoluteHeight;var e=h.getCanvasFromPool(this.id);e.width=t,e.height=i;var s=e.getContext("2d");return new CUI.CanvasRenderer({context:s}).render(this.displayObject),e},initDisplayObject:e,syncDisplayObject:function(){this.visible=this._visible,this.alpha=this._alpha,this.tint=this._tint,this.rotation=this._rotation,this.scaleX=this._scaleX,this.scaleY=this._scaleY,this.anchorX=this._anchorX,this.anchorY=this._anchorY,this.zIndex=this._zIndex,this.offsetX=this._offsetX,this.offsetY=this._offsetY},savePreviousState:function(){this._prevX=this._absoluteX,this._prevY=this._absoluteY,this._prevWidth=this._absoluteWidth,this._prevHeight=this._absoluteHeight},syncPositionX:e,syncPositionY:e,syncDisplayWidth:e,syncDisplayHeight:e,updateDisplayObject:function(t,i,e,s,h){},destroy:e}),s=[{key:"x",get:function(){return this._left},set:function(t){this.left=t}},{key:"y",get:function(){return this._top},set:function(t){this.top=t}},{key:"left",get:function(){return this._left},set:function(t){this._left!==t&&(this._movedX=!1,this._positionChanged=!0,this._left=t)}},{key:"right",get:function(){return this._right},set:function(t){this._right!==t&&(this._movedX=!1,this._positionChanged=!0,this._right=t)}},{key:"top",get:function(){return this._top},set:function(t){this._top!==t&&(this._movedY=!1,this._positionChanged=!0,this._top=t)}},{key:"bottom",get:function(){return this._bottom},set:function(t){this._bottom!==t&&(this._movedY=!1,this._positionChanged=!0,this._bottom=t)}},{key:"width",get:function(){return this._width},set:function(t){this._width!==t&&(this._sizeChanged=!0,this._width=t)}},{key:"height",get:function(){return this._height},set:function(t){this._height!==t&&(this._sizeChanged=!0,this._height=t)}},{key:"align",get:function(){return this.alignH},set:function(t){this.alignH=t}},{key:"valign",get:function(){return this.alignV},set:function(t){this.alignV=t}},{key:"visible",get:function(){return this._visible},set:function(t){this._visible=t,this.displayObject&&(this.displayObject.visible=t)}},{key:"alpha",get:function(){return this._alpha},set:function(t){this._alpha=t,this.displayObject&&(this.displayObject.alpha=t,this.displayObject._absoluteAlpha=t)}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,this.displayObject&&(this.displayObject.tint=null===t?16777215:t)}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.displayObject&&(this.displayObject.rotation=t)}},{key:"zIndex",get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent._toSortChildren=!0),this.displayObject&&(this.displayObject.zIndex=t)}},{key:"offsetX",get:function(){return this._offsetX},set:function(t){this._offsetX=t,this.syncPositionX()}},{key:"offsetY",get:function(){return this._offsetY},set:function(t){this._offsetY=t,this.syncPositionY()}},{key:"anchor",get:function(){return this._anchor},set:function(t){this._anchor=t,this.anchorX=t,this.anchorY=t}},{key:"anchorX",get:function(){return this._anchorX},set:function(t){this._anchorX=t,this._anchor=t,this.syncDisplayWidth()}},{key:"anchorY",get:function(){return this._anchorY},set:function(t){this._anchorY=t,this._anchor=t,this.syncDisplayHeight()}},{key:"scale",get:function(){return this._scale},set:function(t){this._scale=t,this.scaleX=t,this.scaleY=t}},{key:"scaleX",get:function(){return this._scaleX},set:function(t){t=Math.abs(t),this._scaleX=t,this._scale=t,this.syncDisplayWidth()}},{key:"scaleY",get:function(){return this._scaleY},set:function(t){t=Math.abs(t),this._scaleY=t,this._scale=t,this.syncDisplayHeight()}},{key:"flipX",get:function(){return this._flipX},set:function(t){this._flipX=t,this.syncDisplayWidth()}},{key:"flipY",get:function(){return this._flipY},set:function(t){this._flipY=t,this.syncDisplayHeight()}},{key:"absoluteX",get:function(){return this._absoluteX},set:function(t){this._positionChanged=!0,this._absoluteX=t,this.displayObject&&(this.displayObject.position.x=this.relativeX+this._pivotX+this._displayOffsetX)}},{key:"absoluteY",get:function(){return this._absoluteY},set:function(t){this._positionChanged=!0,this._absoluteY=t,this.displayObject&&(this.displayObject.position.y=this.relativeY+this._pivotY+this._displayOffsetY)}},{key:"absoluteWidth",get:function(){return this._absoluteWidth},set:function(t){if(this._absoluteWidth!==t){this._sizeChanged=!0,this._absoluteWidth=t;var i=this.pixel;i.innerWidth=t-i.paddingLeft-i.paddingRight,this.syncDisplayWidth()}}},{key:"absoluteHeight",get:function(){return this._absoluteHeight},set:function(t){if(this._absoluteHeight!==t){this._sizeChanged=!0,this._absoluteHeight=t;var i=this.pixel;i.innerHeight=t-i.paddingTop-i.paddingBottom,this.syncDisplayHeight()}}}];i.defineProperties(h.prototype,s),h._SN=0,h.canvasPool={},h.getCanvasFromPool=function(t){var i=h.canvasPool[t];return i||((i=document.createElement("canvas")).id=t,i.width=3,i.height=3,h.canvasPool[t]=i),i},t.Core=h,t.DEG_TO_RAD=Math.PI/180,t.RAD_TO_DEG=180/Math.PI,t.HALF_PI=Math.PI/2,t.DOUBLE_PI=2*Math.PI,t.noop=e}(CUI=CUI||{}),function(t){var n=t.Class.create({addChild:function(t){t.id=t.id||0===t.id?t.id:n.generateId(),this.childrenMap[t.id]=t,this.children.push(t),t.parent=this},getChildById:function(t){return this.childrenMap[t]},getChildAt:function(t){return this.children[t]},_removeChild:function(t){},removeChild:function(t){var i=this.indexOf(t);return 0<=i&&(this.children.splice(i,1),delete this.childrenMap[t.id],t.parent=null,t)},removeChildById:function(t){var i=this.childrenMap[t];return!!i&&this.removeChild(i)},removeChildAt:function(t){var i=this.children[t];return!!i&&(this.children.splice(t,1),delete this.childrenMap[i.id],i.parent=null,i)},removeAllChildren:function(){for(var t=0,i=this.children.length;t<i;t++){var e=this.children[t];this.removeChild(e)&&(t--,i--)}this.children.length=0},indexOf:function(t){for(var i=0,e=this.children.length;i<e;i++)if(this.children[i]===t)return i;return-1},hasChild:function(t){return!!this.children[t.id]},sortChildrenBy:function(t){n.insertSort(this.children,t)}});n._ID_SEED=0,n.generateId=function(){return n._ID_SEED++,"comp_"+n._ID_SEED},n.insertSort=function(t,i){for(var e,s,h=t.length,n=1;n<h;n++){for(var o=(e=t[n])[i],a=n;0<a&&(s=t[a-1])[i]>o;a--)t[a]=s;t[a]=e}},n.applyTo=function(t,i){var e=n.prototype;for(var s in e){var h=e[s];"function"==typeof h&&(i||!t[s])&&(t[s]=h)}return(i||!t.children)&&(t.children=[]),(i||!t.childrenMap)&&(t.childrenMap={}),t},t.Composite=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var n=t.Class.create({_listeners:null,removeAllEventListeners:function(){for(var t in this._listeners)this._listeners[t]=null;this._listeners={}},addEventListener:function(t,i){var e=this._listeners;void 0===e[t]&&(e[t]=[]),-1===e[t].indexOf(i)&&e[t].push(i)},hasEventListener:function(t,i){var e=this._listeners;return void 0!==e[t]&&-1!==e[t].indexOf(i)},removeEventListener:function(t,i){var e=this._listeners[t];if(void 0!==e){var s=e.indexOf(i);if(-1!==s)return e.splice(s,1),i}return null},dispatch:function(t,i){var e=this._listeners[t],s=!1;if(e){i=Array.prototype.slice.call(arguments,1);for(var h=0,n=e.length;h<n;h++)e[h].apply(this,i),s=!0}return s},getEventListeners:function(t){return t?this._listeners[t]:this._listeners},removeEventListeners:function(t){if(t)return(i=this._listeners[t]||null)&&(this._listeners[t]=[]),i;var i=this._listeners;return this._listeners={},i}});n.applyTo=function(t,i){var e=n.prototype;for(var s in e){var h=e[s];"function"==typeof h&&(i||!t[s])&&(t[s]=h)}return(i||!t._listeners)&&(t._listeners={}),t},t.EventDispatcher=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var n=t.Class.create({modalFlag:-65536,catchFlag:-65537,checkTouch:function(t){if(!this.visible||this.alpha<=0)return!1;var i=Array.prototype.slice.call(arguments,1),e=i[0],s=i[1];if(!this.containPoint(e,s)){if(this.modal)return"tap"===t?this.onTapOut.apply(this,i):"touchEnd"===t&&(this.composite&&this.checkTouchChildren(arguments),this[t].apply(this,i)),this.modalFlag;if("tap"===t||"touchStart"===t)return!1}if(this.composite&&!1!==(h=this.checkTouchChildren(arguments)))return h;var h=!1;if(this[t]&&!1!==(h=this[t].apply(this,i))&&(h=this),!1===h){if(this.modal)return this.modalFlag;if("tap"===t||"touchStart"===t)return this.catchFlag}return h},checkTouchChildren:function(t){if(this.disabled)return!1;var i=this.getTouchableChildren();if(i)for(var e=i.length-1;0<=e;e--){var s=i[e];if(s.visible&&!(s.alpha<=0)){var h=s.checkTouch.apply(s,t);if(!s.hollow&&!1!==h)return h}}return!1},getTouchableChildren:function(){return this.children},touchStart:function(t,i,e){return this.onTouchStart(t,i,e)},touchEnd:function(t,i,e){return this.onTouchEnd(t,i,e)},touchMove:function(t,i,e){return this.onTouchMove(t,i,e)},tap:function(t,i,e){return this.onTap(t,i,e)},pan:function(t,i,e,s,h,n,o){return this.onPan(t,i,e,s,h,n,o)},swipe:function(t,i,e,s,h,n,o){return this.onSwipe(t,i,e,s,h,n,o)},tapOut:function(t,i,e){return this.onTapOut(t,i,e)},onTouchStart:function(t,i,e){return!1},onTouchMove:function(t,i,e){return!1},onTouchEnd:function(t,i,e){return!1},onTap:function(t,i,e){return!1},onPan:function(t,i,e,s,h,n,o){return!1},onSwipe:function(t,i,e,s,h,n,o){return!1},onTapOut:function(t,i,e){return!1}});n.applyTo=function(t,i){var e=n.prototype;for(var s in e){var h=e[s];"function"!=typeof h&&"modalFlag"!==s||(i||!t[s])&&(t[s]=h)}return t},t.TouchTarget=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var s={},i={getName:function(t,i){var e=s[i?t+" "+i:t];return e&&(t=e),t},getStyle:function(t,i,e){return"normal"===e&&(e=null),(e?e+" ":"")+(t=t||12)+"px "+i}};t.Font=i,t.FontMapping=s,"undefined"!=typeof module&&(module.exports=i,module.exports=s)}(CUI=CUI||{}),function(t){var i=function(){},s={doUp:function(t,i,e){this.touchId=null,this.pressed=!1,this.onUp(t,i,e)},doDown:function(t,i,e){this.pressed=!0,this.onDown(t,i,e)},touchStart:function(t,i,e){if(this.disabled)return!1;this.touchId=e,this.onTouchStart(t,i,e),this.doDown(t,i,e)},pan:function(t,i,e,s,h,n,o){return this.disabled||this.touchId===o&&(this.containPoint(t,i)?this.onPan(t,i,e,s,h,n,o):(this.doUp(t,i,o),this.onMoveOut(t,i,e,s,h,n,o))),!1},touchEnd:function(t,i,e){return!this.disabled&&(!(this.touchId!==e||(this.doUp(t,i,e),!this.containPoint(t,i)))&&this.onTouchEnd(t,i,e))},swipe:function(t,i,e){return this.disabled||this.touchId===e&&this.doUp(t,i,e),!1},tap:function(t,i,e){if(!this.disabled){this.beforeTap(t,i,e);var s=this.onTap(t,i,e);return this.afterTap(t,i,e),s}},beforeTap:function(t,i,e){},afterTap:function(t,i,e){},onDown:function(t,i,e){},onUp:function(t,i,e){},onTap:function(t,i,e){},onPan:function(t,i,e,s,h,n,o){},onMoveOut:function(t,i,e,s,h,n,o){}};i.applyTo=function(t,i){for(var e in i=!0===i,s)!i&&e in t||(t[e]=s[e])},t.ButtonComponent=i,"undefined"!=typeof module&&(module.exports=i)}(CUI=CUI||{}),function(t){var i=t.Class.create({initialize:function(){this.velX=0,this.velY=0,this.accX=0,this.accY=0,this.damping=.003,this.dx=0,this.dy=0,this.entity=null},init:function(t){this.entity=t||this.entity},reset:function(){this.started=!1,this.toStart=!1;this.entity;this.dx=this.dy=this.velX=this.velY=this.accX=this.accY=0},start:function(t,i,e){if(this.toStart||e){this.entity;this.velX=t||0,this.velY=i||0,this.toStart=!1,this.started=!0}else this.started=!1},stop:function(){this.reset()},applyDamping:function(t){var i=1-t*this.damping;i<0&&(i=0),1<i&&(i=1),this.velX*=i,this.velY*=i},update:function(t){if(!this.started)return!1;this.entity,this.velX,this.velY;if(this.applyDamping(t),.033<Math.abs(this.velX)||.033<Math.abs(this.velY)){var i=this.velX*t,e=this.velY*t;return this.dx=i,this.dy=e,!0}return this.stop(),!1}});t.Slider=i,"undefined"!=typeof module&&(module.exports=i)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,i.create({initialize:function(){this.lazyInit=!1,this.flexible=!1,this.relativeX=0,this.relativeY=0,this.pixel={x:0,y:0,width:0,height:0,baseX:0,baseY:0,relativeX:0,relativeY:0}},init:function(){},compute:function(t){if("auto"===t._width||"auto"===t._height){var i=t.children;if(0!==i.length){for(var e=t.pixel,s=0,h=0,n=0,o=i.length;n<o;n++){var a=i[n];if(!0!==a.ignoreLayout){var l=Math.max(t.pixel.paddingRight,a.pixel.marginRight);s=Math.max(s,a.relativeX+a._absoluteWidth+l);var r=Math.max(e.paddingBottom,a.pixel.marginBottom);h=Math.max(h,a.relativeY+a._absoluteHeight+r)}}this.tryToResizeParent(t,s,h)}}},tryToResizeParent:function(t,i,e){var s=!1;"auto"===t._width&&t._absoluteWidth!==i&&(t.pixel.width=i,t.absoluteWidth=i,s=!0),"auto"===t._height&&t._absoluteHeight!==e&&(t.pixel.height=e,t.absoluteHeight=e,s=!0),s&&(t.computePadding(),t.computePositionX(),t.computePositionY(),t.updateAABB(),t.composite&&t.children.forEach(function(t){t.syncPosition()}))}}));t.BaseLayout=e,"undefined"!=typeof module&&(module.exports=e)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.BaseLayout),s=i.create({superclass:e,initialize:function(){this.flexible=!0,this.align="top",this.size=null,this.equalSize=!1},compute:function(t){var i=t.children,e=i.length;if(0!==e){for(var s=0,h=t.pixel,n=h.paddingTop,o=0,a=this.equalSize?h.realOuterHeight/e:this.size,l=!a&&"bottom"===this.align,r=0,d=0,u=0;u<e;u++){if(!0!==(g=i[u]).ignoreLayout){g.follow||(r=d,a?(r+=g.pixel.marginTop,d+=a):d=(r+=Math.max(n,g.pixel.marginTop))+g._absoluteHeight),g._movedY=!0,g.pixel.baseY=r,l||this.computeChild(g),n=g.pixel.marginBottom,s++;var c=Math.max(h.paddingRight,g.pixel.marginRight);o=Math.max(o,g.relativeX+g._absoluteWidth+c),u+1===e&&(n=Math.max(n,h.paddingBottom))}}var p=a?t._absoluteHeight:d+n;if(this.tryToResizeParent(t,o,p),l){var f=h.height-p;for(u=0;u<e;u++){var g;!0!==(g=i[u]).ignoreLayout&&(g.pixel.baseY+=f,this.computeChild(g))}}return s}},computeChild:function(t){t.syncPositionY(),t.updateAABB(),t.composite&&t.children.forEach(function(t){t.syncPosition()})}});i.defineProperties(s.prototype,[{key:"valign",get:function(){return this.align},set:function(t){this.align=t}}]),t.VBoxLayout=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.BaseLayout),s=i.create({superclass:e,initialize:function(){this.flexible=!0,this.align="left",this.size=null,this.equalSize=!1},compute:function(t){var i=t.children,e=i.length;if(0!==e){for(var s=0,h=t.pixel,n=h.paddingLeft,o=0,a=this.equalSize?h.realOuterHeight/e:this.size,l=!a&&"right"===this.align,r=0,d=0,u=0;u<e;u++){if(!0!==(g=i[u]).ignoreLayout){g.follow||(r=d,a?(r+=g.pixel.marginLeft,d+=a):d=(r+=Math.max(n,g.pixel.marginLeft))+g._absoluteWidth),g._movedX=!0,g.pixel.baseX=r,l||this.computeChild(g),n=g.pixel.marginRight,s++;var c=Math.max(h.paddingBottom,g.pixel.marginBottom);o=Math.max(o,g.relativeY+g._absoluteHeight+c),u+1===e&&(n=Math.max(n,h.paddingRight))}}var p=a?t._absoluteWidth:d+n;if(this.tryToResizeParent(t,p,o),l){var f=h.width-p;for(u=0;u<e;u++){var g;!0!==(g=i[u]).ignoreLayout&&(g.pixel.baseX+=f,this.computeChild(g))}}return s}},computeChild:function(t){t.syncPositionX(),t.updateAABB(),t.composite&&t.children.forEach(function(t){t.syncPosition()})}});t.HBoxLayout=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,n=t.Utils,e=t.BaseLayout,s=i.create({superclass:e,initialize:function(){this.flexible=!1,this.cellWidth=null,this.cellHeight=null,this.cellSpaceH=null,this.cellSpaceV=null,this.cols=1,this.rows=1},initTable:function(t){var i=this.pixel={},e=t.pixel,s=e.innerWidth,h=e.innerHeight;i.cellSpace=n.parseValue(this.cellSpace,s)||0,i.cellSpaceH=n.parseValue(this.cellSpaceH,s),i.cellSpaceV=n.parseValue(this.cellSpaceV,h),null===i.cellSpaceH&&(i.cellSpaceH=i.cellSpace),null===i.cellSpaceV&&(i.cellSpaceV=i.cellSpace),this.cellWidth?(i.cellWidth=n.parseValue(this.cellWidth,s),s=(i.cellWidth+i.cellSpaceH)*this.cols+i.cellSpaceH):i.cellWidth=(s+i.cellSpaceH)/(this.cols||1)-i.cellSpaceH>>0,this.cellHeight?(i.cellHeight=n.parseValue(this.cellHeight,h),h=(this.cellHeight+this.cellSpace)*this.rows+this.cellSpace):i.cellHeight=(h+i.cellSpaceV)/(this.rows||1)-i.cellSpaceV>>0,i.tableWidth=s,i.tableHeight=h,this.parentCell={scrollX:t.scrollX,scrollY:t.scrollY,relativeX:0,relativeY:0,_absoluteX:0,_absoluteY:0,_absoluteWidth:0,_absoluteHeight:0,_offsetX:0,_offsetY:0,pixel:{x:0,y:0,width:0,height:0,baseX:0,baseY:0,relativeX:0,relativeY:0,paddingLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0}}},compute:function(t){var i=t.children,e=i.length;if(0!==e){var s=0;this.initTable(t);for(var h=0;h<e;h++){var n=i[h];!0!==n.ignoreLayout&&(this.parseChild(n,t,s),s++)}return 0<e&&this.tryToResizeParent(t,t._absoluteWidth,t._absoluteHeight),s}},parseChild:function(t,i,e){var s=t.col=t.col||0,h=t.row=t.row||0;t.colspan=t.colspan||1,t.rowspan=t.rowspan||1;t.pixel;var n=this.pixel.cellWidth,o=this.pixel.cellHeight,a=this.pixel.cellSpaceH,l=this.pixel.cellSpaceV,r=this.parentCell;r.pixel.x=i.absoluteX,r.pixel.y=i.absoluteY,r._absoluteX=r.pixel.x,r.absoluteX=r._absoluteX,r._absoluteY=r.pixel.y,r.absoluteY=r._absoluteY,r.pixel.width=t.colspan*(n+a)-a,r.pixel.height=t.rowspan*(o+l)-l,r._absoluteWidth=r.pixel.width,r.absoluteWidth=r._absoluteWidth,r._absoluteHeight=r.pixel.height,r.absoluteHeight=r._absoluteHeight,t.computeMargin(r),t.computeWidth(),t.computeHeight(),t._movedX=!0,t.pixel.baseX=Math.max(t.marginLeft,i.paddingLeft)+s*(n+a),t._movedY=!0,t.pixel.baseY=Math.max(t.marginTop,i.paddingTop)+h*(o+l),t.syncPosition(r)}});t.TableLayout=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.BaseLayout),s=(t.VBoxLayout,t.HBoxLayout,t.TableLayout,i.create({init:function(){}}));s.commonLayout=new e,t.Layout=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,h=t.Utils,e=t.Core,s=t.noop,n=t.Composite,o=t.EventDispatcher,a=t.TouchTarget,l=t.Layout,r=i.create({superclass:e,initialize:function(){this.anchor=.5,this.left=null,this.top=null,this.right=null,this.bottom=null,this.inView=!0,this.index=0,this.scrollX=0,this.scrollY=0,this.extBound=null,this.extLeft=null,this.extRight=null,this.extTop=null,this.extBottom=null,this.layout=null,this.hollow=!1,this.modal=!1,this.modalMaskColor=null,this.modalMaskAlpha=0,this.modalMaskX=null,this.modalMaskY=null,this.modalMaskWidth=null,this.modalMaskHeight=null,this.clipArea=!1,this.maskX=0,this.maskY=0,this.maskWidth=0,this.maskHeight=0,this.padding=null,this.paddingTop=null,this.paddingRight=null,this.paddingBottom=null,this.paddingLeft=null,this.margin=null,this.marginTop=null,this.marginRight=null,this.marginBottom=null,this.marginLeft=null,this.ignoreLayout=!1,this.backgroundColor=null,this.backgroundAlpha=1,this.backgroundImage=null,this.backgroundImageAlpha=1,this.backgroundInfo=null,this.scaleBg=!0,this.borderColor=null,this.borderAlpha=1,this.borderWidth=0,this.borderImageInfo=null,this.touchTarget=!0,this.composite=!0,this.children=null,this.childrenMap=null,this._movedX=!1,this._movedY=!1,this._toSortChildren=!0,this._needToComputeChildren=!0,this.reflowComputeTimes=0},initBase:function(){this.aabb=[0,0,0,0],null!==this.extBound&&(null===this.extLeft&&(this.extLeft=this.extBound),null===this.extRight&&(this.extRight=this.extBound),null===this.extTop&&(this.extTop=this.extBound),null===this.extBotom&&(this.extBotom=this.extBound)),this.extLeft=this.extLeft||0,this.extRight=this.extRight||0,this.extTop=this.extTop||0,this.extBotom=this.extBotom||0,this.holders=[],this._defaultAlpha=this.alpha,this.parent&&this.parent.addChild(this),o.applyTo(this),this.touchTarget&&a.applyTo(this),this.composite&&(this.all={},n.applyTo(this),this.setLayout(this.layout),this.childSN=0),this.setMargin(this.margin||0),this.setPadding(this.padding||0),this.computeSelf(),this.updateAABB(),this.initDisplayObject(),this.initModalMask(),this.initBackgroundColor(),this.initBorder(),this.initBackgroundImage(),this.initBorderImage(),this.initHolders(),this.savePreviousState(),this.reflow()},init:function(){this.id=this.id||"comp_"+e._SN++,this.beforeInit&&this.beforeInit(),this.initBase(),this.afterInit&&this.afterInit(),this.inited=!0},initDisplayObject:function(){var t=this.root.renderer.createContainer();if(t._ignoreResize=!0,this.displayObject=t,this.clipArea&&0<this.maskWidth&&0<this.maskHeight){var i=this.maskHeight;this.maskHeight=0,this.setMask(this.maskX,this.maskY,this.maskWidth,i)}this.syncDisplayObject(),this.parent&&this.parent.addChildDisplayObject(this)},initHolders:s,initChildren:s,reflow:function(){this.reflowComputeTimes=1},resizeParents:function(t){for(t=t||this.parent;t&&(t.layout.flexible&&(t._needToCompute=!0),"auto"===t.width||"auto"===t.height);)t._needToCompute=!0,t=t.parent},setDisabled:function(t){this.disabled=t},initModalMask:function(){var t=this.modalMaskColor||this.root.modalMaskColor,i=this.modalMaskAlpha||this.root.modalMaskAlpha;if(this.modal&&null!==t&&!(i<=0)){var e=new CUI.BackgroundHolder({parent:this,color:t,alpha:i,fillParent:!1,left:0,top:0,width:this.modalMaskWidth||this.root._absoluteWidth+100,height:this.modalMaskHeight||this.root._absoluteHeight+100,alignH:"left",alignV:"top"});e.init(),this.modalMaskHolder=e,this._needToCompute=!0}},initBackgroundColor:function(){var t=this.backgroundColor;t=null==t?this.bgColor:t,null!=(this.backgroundColor=t)&&!1!==t?this.setBackgroundColor(this.backgroundColor,this.backgroundAlpha):this.backgroundHolder=null},setBackgroundColor:function(t,i){var e=this.backgroundHolder;e||((e=new CUI.BackgroundHolder({parent:this,color:t,alpha:i,fillParent:!0})).init(),this.backgroundHolder=e),this._needToCompute=!0},initBorder:function(){if(null===this.borderColor||this.borderWidth<=0)this.borderHolder=null;else{var t=new CUI.BorderHolder({parent:this,alpha:this.borderAlpha,lineWidth:this.borderWidth,color:this.borderColor});t.init(),this.borderHolder=t,this._needToCompute=!0}},initBorderImage:function(t){this.setBorderImage(this.borderImageInfo)},setBorderImage:function(t){var i=null;if(this.borderImageHolder){var e=this.borderImageHolder.displayObject;i=e.parent.getChildIndex(e),e.parent.removeChild(e),this.borderImageHolder=null,this._needToCompute=!0,this._sizeChanged=!0}if(t){var s=new CUI.BorderImageHolder(t);s.insertIndex=i,s.parent=this,s.init(),this.borderImageHolder=s,this._needToCompute=!0,this._sizeChanged=!0}},initBackgroundImage:function(){if(this.backgroundImage=this.backgroundImage||this.backgroundImg||this.bgImg,this.backgroundInfo=this.backgroundInfo||this.bgInfo||this.backgroundImageInfo||this.bgImgInfo,this.backgroundInfo){var t=this.backgroundInfo;t.img=t.img||this.backgroundImage,t.alpha||0===t.alpha||(t.alpha=this.backgroundImageAlpha),this.setBackgroundInfo(t)}else this.backgroundImage&&this.setBackgroundImage(this.backgroundImage)},setBackgroundImage:function(t){this.setBackgroundInfo({img:t})},setBackgroundInfo:function(t){if(t){var i=this.backgroundImageHolder;i?i.setImageInfo(t):((i=new CUI.ImageHolder({parent:this,imageInfo:t,fillParent:this.scaleBg,lockScaleRatio:!1})).init(),this.backgroundImageHolder=i),this._needToCompute=!0}},addImageHolder:function(t){var i=new CUI.ImageHolder(t);return i.parent=this,i.init(),this.holders.push(i),i},addTextHolder:function(t){var i=new CUI.TextHolder(t);return i.parent=this,i.init(),this.holders.push(i),i},beforeInit:null,afterInit:null,_beforeInit:s,_afterInit:s,setLayout:function(t){var i;if("string"==typeof t)e=t;else if(t&&t.constructor===Object){var e=t.name;i=t}if(e)switch(e){case"vbox":t=new CUI.VBoxLayout(i);break;case"hbox":t=new CUI.HBoxLayout(i);break;case"table":t=new CUI.TableLayout(i);break;default:t=new CUI.BaseLayout(i)}t||(t=l.commonLayout),this.layout=t},setRoot:function(t){if(t){var i=(this.root=t).all[this.id];i!==this&&(t.all[this.id]=this,i&&console.log("**** Duplicate id : "+this.id+" ****"))}else this.root&&(delete this.root.all[this.id],this.root=null)},addChild:function(t){this.composite&&(n.prototype.addChild.call(this,t),t.index=this.childSN++,t.setRoot(this.root),"auto"===this._width&&(this.pixel.width=0),"auto"===this._height&&(this.pixel.height=0),this.layout.flexible,this._needToCompute=!0,this._toSortChildren=!0)},removeChild:function(t){var i=!1;return this.composite&&(t.composite&&t.removeAllChildren(),(i=n.prototype.removeChild.call(this,t))&&(this.root&&delete this.root.all[t.id],t.setRoot(null),this.displayObject.removeChild(t.displayObject),"auto"===this._width&&(this.pixel.width=0),"auto"===this._height&&(this.pixel.height=0),this._needToCompute=!0)),i},sortChildren:function(){this.children.sort(function(t,i){return t.zIndex-i.zIndex||t.index-i.index}),this.displayObject.sortChildren(),this._toSortChildren=!1},setMargin:function(t){this.margin=t,this.marginLeft=null===this.marginLeft?this.margin:this.marginLeft,this.marginTop=null===this.marginTop?this.margin:this.marginTop,this.marginRight=null===this.marginRight?this.margin:this.marginRight,this.marginBottom=null===this.marginBottom?this.margin:this.marginBottom},setPadding:function(t){this.padding=t,this.paddingLeft=null===this.paddingLeft?this.padding:this.paddingLeft,this.paddingTop=null===this.paddingTop?this.padding:this.paddingTop,this.paddingRight=null===this.paddingRight?this.padding:this.paddingRight,this.paddingBottom=null===this.paddingBottom?this.padding:this.paddingBottom},syncMask:function(){this.setMask(0,0,this._absoluteWidth,this._absoluteHeight)},setMask:function(t,i,e,s){var h=this.maskShape;h&&t===this.maskX&&i===this.maskY&&e===this.maskWidth&&s===this.maskHeight||(this.maskX=t,this.maskY=i,this.maskWidth=e,this.maskHeight=s,this.maskShape=this.root.renderer.updateRect(h,t,i,e,s,0,1)),this.displayObject.mask=this.maskShape,h||this.displayObject.addChild(this.maskShape)},removeMask:function(){this.maskX=0,this.maskY=0,this.maskWidth=0,this.maskHeight=0,this.displayObject.mask=null,this.maskShape&&this.displayObject.removeChild(this.maskShape)},setPosition:function(t,i){this.left!==t&&null!==t&&(this.left=t,this.computePositionX()),this.top!==i&&null!=i&&(this.top=i,this.computePositionY()),this.updateAABB()},setSize:function(t,i,e){(e||this.width!==t)&&(this.width=t,this.computeWidth()),(e||this.height!==i)&&(this.height=i,this.computeHeight())},updateAABB:function(){this.aabb[0]=this._absoluteX-this.extLeft,this.aabb[1]=this._absoluteY-this.extTop,this.aabb[2]=this._absoluteX+this._absoluteWidth+this.extRight,this.aabb[3]=this._absoluteY+this._absoluteHeight+this.extBottom},updateHolders:function(){if(this.modalMaskHolder){var t=this.modalMaskHolder,i=this.root._absoluteWidth,e=this.root._absoluteHeight,s=this.modalMaskWidth||i,h=this.modalMaskHeight||e,n=0,o=0,a=this.modalMaskX;this.modalMaskX||0===this.modalMaskX||(n=10,a=-this._absoluteX+this.root._absoluteX-n,a+=(i-s)/2);var l=this.modalMaskY;this.modalMaskY||0===this.modalMaskY||(o=10,l=-this._absoluteY+this.root._absoluteY-o,l+=(e-h)/2),s+=2*n,h+=2*o,t._left===a&&t._top===l||(t.left=a,t.top=l),t._width===s&&t._height===h||(t.width=s,t.height=h),t.update()}this.backgroundHolder&&this.backgroundHolder.update(this._sizeChanged),this.borderHolder&&this.borderHolder.update(this._sizeChanged),this.backgroundImageHolder&&this.backgroundImageHolder.update(this._sizeChanged),this.borderImageHolder&&this.borderImageHolder.update(this._sizeChanged),this.holders.forEach(function(t){t&&t.update()})},show:function(t){return!(this.visible&&!t)&&(!1!==this.beforeShow()?(this.visible=!0,this.onShow(t),this.reflow(),!0):void 0)},beforeShow:s,onShow:s,hide:function(t){return!(!this.visible&&!t)&&(!1!==this.beforeHide()?(this.visible=!1,this.onHide(t),this.reflow(),!0):void 0)},beforeHide:s,onHide:s,toggle:function(t){return this.visible?this.hide(t):this.show(t)},computeSelf:function(){this.computeMargin(),this.computeWidth(),this.computeHeight(),this.computePadding(),this.computePositionX(),this.computePositionY()},compute:function(){this.computeSelf(),this.layout&&this.layout.compute(this),this.updateHolders(),this.updateAABB()},getChildrenCount:function(){return this.composite?this.children.length:0},isInView:function(){return this.checkCollideAABB(this.root.aabb)},isInRegion:function(t,i,e,s){var h=this.aabb;return h[2]>t&&h[3]>i&&h[1]<i+s&&h[0]<t+e},containPoint:function(t,i){var e=this.aabb;return e[0]<t&&t<e[2]&&e[1]<i&&i<e[3]},checkCollideAABB:function(t){var i=this.aabb;return t[0]<i[2]&&t[2]>i[0]&&t[1]<i[3]&&t[3]>i[1]},updateSelf:function(t,i,e){},updateChildren:function(i,e,s){this.children.forEach(function(t){t.update(i,e,s)})},update:function(t,i,e){if(this.beforeUpdate&&this.beforeUpdate(t,i,e),e=0<this.reflowComputeTimes--||e,this._needToCompute=this._needToCompute||e,(this.visible||this._needToCompute)&&this.updateSelf(t,i),this.composite){!this._needToCompute||"auto"===this._width&&"auto"===this._height||this.computeSelf(),this._needToComputeChildren=this._needToComputeChildren||e;var s=this._needToComputeChildren;(this.visible||s)&&(this.updateChildren(t,i,s),this._toSortChildren&&this.sortChildren())}this._needToCompute&&this.compute(),this.afterUpdate&&this.afterUpdate(t,i),this._sizeChanged=!1,this._positionChanged=!1,this._needToCompute=!1,this._needToComputeChildren=!1,this.visible&&this.beforeRender(t,i)},beforeUpdate:null,afterUpdate:null,beforeRender:CUI.noop,computeMargin:function(t){if(t=t||this.parent){var i=t.pixel,e=this.pixel;this.marginLeft=null===this.marginLeft?this.margin:this.marginLeft,this.marginTop=null===this.marginTop?this.margin:this.marginTop,this.marginRight=null===this.marginRight?this.margin:this.marginRight,this.marginBottom=null===this.marginBottom?this.margin:this.marginBottom,e.marginLeft=h.parseValue(this.marginLeft,i.width)||0,e.marginRight=h.parseValue(this.marginRight,i.width)||0,e.marginTop=h.parseValue(this.marginTop,i.height)||0,e.marginBottom=h.parseValue(this.marginBottom,i.height)||0,e.realMarginLeft=Math.max(i.paddingLeft,e.marginLeft)||0,e.realMarginTop=Math.max(i.paddingTop,e.marginTop)||0,e.realMarginRight=Math.max(i.paddingRight,e.marginRight)||0,e.realMarginBottom=Math.max(i.paddingBottom,e.marginBottom)||0,e.realOuterWidth=i.width-e.realMarginLeft-e.realMarginRight,e.realOuterHeight=i.height-e.realMarginTop-e.realMarginBottom}},computePadding:function(){var t=this.pixel;this.paddingLeft=null===this.paddingLeft?this.padding:this.paddingLeft,this.paddingTop=null===this.paddingTop?this.padding:this.paddingTop,this.paddingRight=null===this.paddingRight?this.padding:this.paddingRight,this.paddingBottom=null===this.paddingBottom?this.padding:this.paddingBottom,t.paddingLeft=h.parseValue(this.paddingLeft,t.width)||0,t.paddingRight=h.parseValue(this.paddingRight,t.width)||0,t.paddingTop=h.parseValue(this.paddingTop,t.height)||0,t.paddingBottom=h.parseValue(this.paddingBottom,t.height)||0,t.innerWidth=t.width-t.paddingLeft-t.paddingRight,t.innerHeight=t.height-t.paddingTop-t.paddingBottom},getFillWidth:function(t){return null===this.left||null===this.right?null:(this.width=null,e=this._movedX?(i=this.pixel.left,this.pixel.right):(i=h.parseValue(this.left,t),h.parseValue(this.right,t)),t-i-e);var i,e},getFillHeight:function(t){return null===this.top||null===this.bottom?null:(this.height=null,e=this._movedY?(i=this.pixel.top,this.pixel.bottom):(i=h.parseValue(this.top,t),h.parseValue(this.bottom,t)),t-i-e);var i,e},computeAutoWidth:function(){this.pixel.width=0},computeWidth:function(){if(!this._resizedX){var t=this.pixel;if("auto"===this._width)this.computeAutoWidth();else{var i=t.realOuterWidth,e=this.getFillWidth(i);t.width=null!==e?e:h.parseValue(this.width,i)}this.absoluteWidth=t.width}},computeAutoHeight:function(){this.pixel.height=0},computeHeight:function(){if(!this._resizedY){var t=this.pixel;if("auto"===this._height)this.computeAutoHeight();else{var i=t.realOuterHeight,e=this.getFillHeight(i);t.height=null!==e?e:h.parseValue(this.height,i)}this.absoluteHeight=t.height}},computePositionX:function(t){if(!this._movedX){var i=this.pixel,e=i.realOuterWidth,s=0;i.left=h.parseValue(this.left,e),i.right=h.parseValue(this.right,e),s="center"===this.alignH?(e-i.width)/2+(i.left||0):"right"===this.alignH?e-i.width+(i.left||0):null===i.left&&null!==i.right?e-i.width-(i.right||0):i.left||0,i.baseX=s+i.realMarginLeft,this.syncPositionX(t)}},computePositionY:function(t){if(!this._movedY){var i=this.pixel,e=i.realOuterHeight,s=0;i.top=h.parseValue(this.top,e),i.bottom=h.parseValue(this.bottom,e),s="center"===this.alignV||"middle"===this.alignV?(e-i.height)/2+(i.top||0):"bottom"===this.alignV?e-i.height+(i.top||0):null===i.top&&null!==i.bottom?e-i.height-(i.bottom||0):i.top||0,i.baseY=s+i.realMarginTop,this.syncPositionY(t)}},syncPositionX:function(t){t=t||this.parent;var i=this.pixel;i.relativeX=i.baseX+this._offsetX-(t?t.scrollX:0),i.x=i.relativeX+(t?t._absoluteX:0),this.relativeX=i.relativeX,this.absoluteX=i.x},syncPositionY:function(t){t=t||this.parent;var i=this.pixel;i.relativeY=i.baseY+this._offsetY-(t?t.scrollY:0),i.y=i.relativeY+(t?t._absoluteY:0),this.relativeY=i.relativeY,this.absoluteY=i.y},syncPosition:function(t){t=t||this.parent,this.syncPositionX(t),this.syncPositionY(t),this.updateAABB(),this.composite&&this.children.forEach(function(t){t.syncPosition()})},syncDisplayWidth:function(){this._displayWidth=this._absoluteWidth*this._scaleX,this._pivotX=this._absoluteWidth*this._anchorX,this.displayObject&&(this.displayObject.pivot.x=this._pivotX,this.displayObject.position.x=this.relativeX+this._pivotX,this.displayObject.scale.x=this._scaleX*(this._flipX?-1:1))},syncDisplayHeight:function(){this._displayHeight=this._absoluteHeight*this._scaleY,this._pivotY=this._absoluteHeight*this._anchorY,this.displayObject&&(this.displayObject.pivot.y=this._pivotY,this.displayObject.position.y=this.relativeY+this._pivotY,this.displayObject.scale.y=this._scaleY*(this._flipY?-1:1))},resetPosition:function(){this._movedX=!1,this._movedY=!1,this.computePositionX(),this.computePositionY()},moveTo:function(t,i,e){var s=this.parent,h=this.pixel,n=!1;null!==t&&(!0===e&&h.x!==t?(h.x=t,h.relativeX=t-(s?s._absoluteX:0),h.baseX=h.relativeX-(this._offsetX-(s?s.scrollX:0)),n=!0):!0!==e&&h.relativeX!==t&&(h.relativeX=t,h.baseX=t-(this._offsetX-(s?s.scrollX:0)),t=h.x=t+(s?s._absoluteX:0),n=!0),n&&(h.left=h.relativeX,h.right=h.relativeX+h.width,this._movedX=!0,this.relativeX=h.relativeX,this.absoluteX=t));var o=!1;null!==i&&(!0===e&&h.y!==i?(h.y=i,h.relativeY=i-(s?s._absoluteY:0),h.baseY=h.relativeY-(this._offsetY-(s?s.scrollY:0)),o=!0):!0!==e&&h.relativeY!==i&&(h.relativeY=i,h.baseY=i-(this._offsetY-(s?s.scrollY:0)),i=h.y=i+(s?s._absoluteY:0),o=!0),o&&(h.top=h.relativeY,h.bottom=h.top+h.height,this._movedY=!0,this.relativeY=h.relativeY,this.absoluteY=i)),(n||o)&&(this._needToCompute=!0,this._needToComputeChildren=!0)},moveToX:function(t,i){this.moveTo(t,null,i)},moveToY:function(t,i){this.moveTo(null,t,i)},moveBy:function(t,i){t&&i?this.moveTo(this.pixel.x+t,this.pixel.y+i,!0):t?this.moveTo(this.pixel.x+t,null,!0):i&&this.moveTo(null,this.pixel.y+i,!0)},resizeTo:function(t,i){var e=this.pixel,s=!1;null!==t&&this._absoluteWidth!==t&&(e.width=t,this.absoluteWidth=e.width,s=this._resizedX=!0);var h=!1;null!==i&&this._absoluteHeight!==i&&(e.height=i,this.absoluteHeight=e.height,h=this._resizedY=!0),(s||h)&&(this._needToCompute=!0,this._needToComputeChildren=!0)},resizeBy:function(t,i){this.resizeTo(this._absoluteWidth+t,this._absoluteHeight+i)},destroy:function(){this.composite&&(this.children.forEach(function(t){t.parent=null,t.root=null}),this.children=null,this.childrenMap=null),this.holders.forEach(function(t){t.destroy(),t.parent=null}),this.root&&(delete this.root.all[this.id],this.root=null),this.parent=null,this.layout=null,this.displayObject.destroy(),this.displayObject=null}});i.defineProperties(r.prototype,[]),r.create=function(t,i){var e=t.ui,s=t.children;delete t.ui,delete t.children,t.parent=i;var h=new e(t);return s&&s.forEach(function(t){r.create(t,h)}),h},t.Component=r}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Core),s=(t.Composite,t.Component),h=t.noop,n=i.create({superclass:s,initialize:function(){this.renderer=null,this.left=null,this.top=null,this.originalX=0,this.originalY=0},updateSelf:h,checkTouchSelf:h,init:function(){this.id=this.id||"root_"+e._SN++,null===(this.root=this).left&&(this.left=this.originalX),null===this.top&&(this.top=this.originalY),this.beforeInit&&this.beforeInit(),this.left=this.left||0,this.top=this.top||0,this.initBase(),this.initChildren(),this._toSortChildren=!0,this.afterInit&&this.afterInit()},compute:function(){this.computeSelf(),this.layout.compute(this),this.updateHolders(),this.updateAABB()},checkTouch:function(t,i){if(this.disabled||!this.visible||this.alpha<=0)return!1;var e=this.checkTouchChildren(arguments);return!1!==e?e:void 0}});t.Root=n}(CUI=CUI||{}),function(t){var i=t.Class,h=t.Utils,e=t.Core,s=i.create({superclass:e,initialize:function(){this.lazyInit=!0,this.alignH="center",this.alignV="center",this.offsetAlpha=0,this.offsetWidth=0,this.offsetHeight=0,this.fillParent=!1,this.ratio=null,this.lockScaleRatio=!0},init:function(){this.initDisplayObject()},computeAutoWidth:function(){this.pixel.width=0},computeWidth:function(){var t=this.parent;"auto"===this._width?this.computeAutoWidth():this.pixel.width=h.parseValue(this.width,t._absoluteWidth,this.pixel.width)||0,this.absoluteWidth=this.pixel.width},computeAutoHeight:function(){this.pixel.height=0},computeHeight:function(){var t=this.parent;"auto"===this._height?this.computeAutoHeight():this.pixel.height=h.parseValue(this.height,t._absoluteHeight,this.pixel.height)||0,this.absoluteHeight=this.pixel.height},updateSize:function(){this.computeWidth(),this.computeHeight(),this._sizeChanged=!0},computePositionX:function(t){t=t||this.parent;var i=this.pixel,e=t._absoluteWidth,s=0;i.left=h.parseValue(this.left,e),i.right=h.parseValue(this.right,e),s="center"===this.alignH?(e-this._displayWidth)/2+(i.left||0):"right"===this.alignH?e-t.pixel.paddingRight-this._displayWidth+(i.left||0):null===i.left&&null!==i.right?e-t.pixel.paddingRight-this._displayWidth-(i.right||0):t.pixel.paddingLeft+(i.left||0),i.baseX=s,this.syncPositionX(t)},computePositionY:function(t){t=t||this.parent;var i=this.pixel,e=t._absoluteHeight,s=0;i.top=h.parseValue(this.top,e),i.bottom=h.parseValue(this.bottom,e),s="center"===this.alignV||"middle"===this.alignV?(e-this._displayHeight)/2+(i.top||0):"bottom"===this.alignV?e-t.pixel.paddingBottom-this._displayHeight+(i.top||0):null===i.top&&null!==i.bottom?e-t.pixel.paddingBottom-this._displayHeight-(i.bottom||0):t.pixel.paddingTop+(i.top||0),i.baseY=s,this.syncPositionY(t)},syncPositionX:function(t){t=t||this.parent;var i=this.pixel;i.relativeX=i.baseX+this._offsetX,i.x=i.relativeX+(t?t._absoluteX:0),this.relativeX=i.relativeX,this.absoluteX=i.x},syncPositionY:function(t){t=t||this.parent;var i=this.pixel;i.relativeY=i.baseY+this._offsetY,i.y=i.relativeY+(t?t._absoluteY:0),this.relativeY=i.relativeY,this.absoluteY=i.y},updatePosition:function(){var t=this.parent;t&&(this.computePositionX(t),this.computePositionY(t))},update:function(t){(this._sizeChanged||this._positionChanged||this._needToCompute||t)&&(this.updateSize(),this.updatePosition(),this._sizeChanged=!1,this._positionChanged=!1,this._needToCompute=!1)},syncDisplayWidth:function(){this._displayWidth=this._absoluteWidth*this._scaleX,this._pivotX=this._displayWidth*this._anchorX,this.displayObject&&(this.displayObject._ignoreResize||(this.displayObject.width=this._displayWidth*(this._flipX?-1:1)),this.displayObject._flipX=this._flipX,this.displayObject.pivot.x=this._pivotX/Math.abs(this.displayObject.scale.x),this.displayObject.position.x=this.relativeX+this._pivotX)},syncDisplayHeight:function(){this._displayHeight=this._absoluteHeight*this._scaleY,this._pivotY=this._displayHeight*this._anchorY,this.displayObject&&(this.displayObject._ignoreResize||(this.displayObject.height=this._displayHeight*(this._flipY?-1:1)),this.displayObject._flipY=this._flipY,this.displayObject.pivot.y=this._pivotY/Math.abs(this.displayObject.scale.y),this.displayObject.position.y=this.relativeY+this._pivotY)},destroy:function(){this.parent=null,this.displayObject.destroy(),this.displayObject=null}});t.BaseHolder=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Core),s=t.BaseHolder,h=t.Font,n=i.create({superclass:s,initialize:function(){this.text=null,this.color="#000000",this.textAlign="start",this.verticalAlign="middle",this.width="auto",this.height="auto",this.alignH=null,this.alignV=null,this.textBaseline="top",this.lineCap="butt",this.lineJoin="round",this.strokeColor=null,this.strokeWidth=1,this.fontStyle=null,this.fontWeight=null,this.fontSize=14,this.fontName="Arial",this.lineHeight=null,this.lines=null,this.lineCount=1,this.maxLine=null,this.shadowColor=null,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.measure=null,this.textWidth=0,this.textHeight=0,this.areaWidth=0,this.areaHeight=0,this.areaOffsetX=0,this.areaOffsetY=0,this.cachePadding=2,this.useCache=!0,this.useCachePool=!0,this.linkCache=null,this.lineHeight=0},init:function(){this.id=this.id||"text-holder-"+this.parent.id,this.linkCache&&(this.useCache=!0),this.setTextInfo(this),this.initDisplayObject(),this.updateText()},createCache:function(){this.cacheCanvas||(this.useCachePool?this.cacheCanvas=e.getCanvasFromPool(this.id):this.cacheCanvas=document.createElement("canvas")),this.cacheContext=this.cacheCanvas.getContext("2d")},initDisplayObject:function(){!0!==this.useCache&&this.parent.root.renderer.canvas2d?(this.displayObject=this.parent.root.renderer.createTextObject(),this.displayObject.textInfo=this):(this._displayOffsetX=-this.cachePadding,this._displayOffsetY=-this.cachePadding,this.linkCache?this.displayObject=this.parent.root.renderer.createSprite(this.linkCache):(this.createCache(),this.displayObject=this.parent.root.renderer.createTextObject(this.cacheContext))),this.syncDisplayObject(),this.parent&&this.parent.addChildDisplayObject(this)},parseColor:function(t){return"number"==typeof t&&(t="#"+Number(t).toString(16).toUpperCase()),t},setTextInfo:function(t){this.alignH=t.align||t.textAlign||this.textAlign,this.textAlign=this.alignH,this.alignV=t.valign||t.verticalAlign||this.verticalAlign,this.verticalAlign=this.alignV,this.setText(t.text),this.color=this.parseColor(t.color||this.color),this.strokeColor=this.parseColor(t.strokeColor||this.strokeColor),this.shadowColor=this.parseColor(t.shadowColor||this.shadowColor),this.fontSize=t.fontSize||this.fontSize,this.fontName=t.fontName||this.fontName,this.fontWeight=t.fontWeight,this.fontStyle=h.getStyle(this.fontSize,this.fontName,this.fontWeight),this._needToCompute=!0},setFontSize:function(t){this.fontSize=t,this.fontStyle=h.getStyle(this.fontSize,this.fontName,this.fontWeight)},setFontName:function(t){this.fontName=t,this.fontStyle=h.getStyle(this.fontSize,this.fontName,this.fontWeight)},setFontWeight:function(t){this.fontWeight=t,this.fontStyle=h.getStyle(this.fontSize,this.fontName,this.fontWeight)},setColor:function(t){t=this.parseColor(t),this.color!==t&&(this.color=t,this._needToCompute=!0)},setShadowOffset:function(t,i){this.shadowOffsetX===t&&this.shadowOffsetY===i||(this.shadowOffsetX=t,this.shadowOffsetY=i,this._needToCompute=!0)},setText:function(t){this.textChanged=this._text!==t,this.textChanged&&(this._text=t,t=this.text=null==t?"":t,Array.isArray(t)?this.lines=t:this.lines=String(t).split(/(?:\r\n|\r|\n)/),this.lineCount=this.lines.length,this._needToCompute=!0)},updateText:function(){if(this.lines){var t;if(this.lineHeight||(this.lineHeight=Math.ceil(1.25*this.fontSize)+(this.strokeWidth||1)+2),"auto"===this._width)t=(this.maxLine||0===this.maxLine)&&this.lines[this.maxLine]?this.lines[this.maxLine]:CUI.Utils.getMaxLine(this.lines),this.measure=CUI.Utils.measureText(t,this.fontStyle);else this.measure={width:this._width};"auto"===this._height?this.measure.height=this.lineHeight*this.lineCount:this.measure.height=this._height,this.textWidth=this.measure.width,this.textHeight=this.measure.height,this.updateArea(),this._needToCompute=!0}},updateArea:function(){if(this.linkCache)return this.areaWidth=this.linkCache.width,void(this.areaHeight=this.linkCache.height);this.areaWidth=this.textWidth+this.strokeWidth,this.areaHeight=this.textHeight+this.strokeWidth,!0!==this.useCache&&this.parent.root.renderer.canvas2d||(this.areaWidth+=2*this.cachePadding,this.areaHeight+=2*this.cachePadding,"center"===this.alignH?this.areaOffsetX=Math.round(this.areaWidth/2):"right"===this.alignH||"end"===this.alignH?this.areaOffsetX=this.areaWidth-this.cachePadding:this.areaOffsetX=this.cachePadding,this.cacheCanvas.width=this.areaWidth,this.cacheCanvas.height=this.areaHeight,CUI.Utils.renderTextContent(this.cacheContext,this,this.areaOffsetX,this.areaOffsetY,!0)),this.displayObject.updateSize()},computeWidth:function(){this.pixel.width=this.areaWidth,this.absoluteWidth=this.areaWidth},computeHeight:function(){this.pixel.height=this.areaHeight,this.absoluteHeight=this.areaHeight},update:function(t){(this._sizeChanged||this._positionChanged||this._needToCompute||t)&&(this.updateSize(),this.updatePosition(),this._sizeChanged=!1,this._positionChanged=!1,this._needToCompute=!1)}});t.TextHolder=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.BaseHolder),s=(t.Component,i.create({superclass:e,initialize:function(){this.anchor=.5,this.src=null,this.img=null,this.sx=null,this.sy=null,this.sw=null,this.sh=null,this.width="auto",this.height="auto",this.fillParent=!1,this.ratio=null,this.lockScaleRatio=!0,this.crossOrigin="anonymous",this.tint=null,this.config={sx:0,sy:0,sw:0,sh:0,ox:0,oy:0,w:0,h:0}},init:function(){if(this.id=this.id||"text-holder-"+this.parent.id,this.initDisplayObject(),this.imageInfo){var t=this.imageInfo;t.img=t.img||this.img,t.src=t.src||this.src,this.setImageInfo(t)}else this.src?this.load(this.src):this.img&&this.setImg(this.img)},load:function(t){this.setSrc(this.src,t)},setSrc:function(t,i){if(t){this.src=t;var e=this;this.img=null;var s=new Image;return s.crossOrigin=this.crossOrigin,s.onload=function(t){e.setImg(s,i)},s.onerror=function(t){e.setImg(null,i)},s.src=t,s}this.setImg(null,i)},setImg:function(t,i){this.img=t,this.updateImageInfo(),i&&i(t)},setImageInfo:function(t){if(t){for(var i in t)"src"!==i&&"img"!==i&&(this[i]=t[i]);t.src?this.setSrc(t.src):t.img&&this.setImg(t.img)}},updateImageInfo:function(t){var i=(t=t||this).sx,e=t.sy,s=t.sw,h=t.sh,n=t.w,o=t.h,a=t.ox,l=t.oy,r=this.img;null==i&&(i=0),null==e&&(e=0),null==s?s=r?r.width:0:r&&(s=Math.min(i+s,r.width)-i)<=0&&(i=r.width,s=0),null==h?h=r?r.height:0:r&&(h=Math.min(e+h,r.height)-e)<=0&&(e=r.height,h=0),null==a&&(a=0),null==l&&(l=0),null==n&&(n=s),null==o&&(o=h),this.config.sx=i,this.config.sy=e,this.config.sw=s,this.config.sh=h,this.config.ox=a,this.config.oy=l,this.config.w=n,this.config.h=o,this.updateDisplayObject(),this.pixel.width=n,this.pixel.height=o,this.absoluteWidth=n,this.absoluteHeight=o,this.ratio=n/o},initDisplayObject:function(){var t=this.parent.root.renderer.createSprite();this.displayObject=t,this.syncDisplayObject(),this.parent&&this.parent.addChildDisplayObject(this)},updateDisplayObject:function(){if(this.img){var t=this.config;this.parent.root.renderer.updateSprite(this.displayObject,t.sx,t.sy,t.sw,t.sh,this.img),this.displayObject.tint=null===this.tint?16777215:this.tint}},computeAutoWidth:function(){this.pixel.width=this.config.w},computeAutoHeight:function(){this.pixel.height=this.config.h},updatePosition:function(){var t=this.parent;if(t){var i=this.pixel;if(this.fillParent)return null!==this.ratio&&this.lockScaleRatio?(i.baseX=(t._absoluteWidth-this._absoluteWidth)/2,i.baseY=(t._absoluteHeight-this._absoluteHeight)/2):(i.baseX=0,i.baseY=0),this.syncPositionX(t),void this.syncPositionY(t);this.computePositionX(t),this.computePositionY(t)}},updateSize:function(){if(this.fillParent){var t=this.parent,i=t._absoluteWidth,e=t._absoluteHeight;if(null!==this.ratio&&this.lockScaleRatio)i/e>=this.ratio?i=e*this.ratio:e=i/this.ratio;return this.pixel.width=i,this.pixel.height=e,this.absoluteWidth=i,this.absoluteHeight=e,void(this._sizeChanged=!0)}this.computeWidth(),this.computeHeight(),this._sizeChanged=!0},removeImg:function(){this.img=null,this.displayObject=null}}));t.ImageHolder=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.BaseHolder),s=i.create({superclass:e,initialize:function(){this.width="100%",this.height="100%",this.color=null,this.alpha=1,this.fillParent=!0},initDisplayObject:function(){var t=this.parent.root.renderer.createRect(this.absoluteWidth,this.absoluteHeight,this.color,this.alpha);this.displayObject=t,this.syncDisplayObject(),this.parent&&this.parent.addChildDisplayObject(this)},update:function(t){(this.parent._sizeChanged||this._sizeChanged||this._positionChanged||this._needToCompute||t)&&(this.updateSize(),this.updatePosition(),this.parent.root.renderer.updateRect(this.displayObject,0,0,this.absoluteWidth,this.absoluteHeight,this.color,this.alpha),this._sizeChanged=!1,this._positionChanged=!1,this._needToCompute=!1)}});t.BackgroundHolder=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.BaseHolder),s=i.create({superclass:e,initialize:function(){this.width="100%",this.height="100%",this.fillParent=!0,this.color=null,this.alpha=1,this.lineWidth=1},initDisplayObject:function(){var t=this.parent.root.renderer.createRect(this.absoluteWidth,this.absoluteHeight,null,null,this.lineWidth,this.color,this.alpha);this.displayObject=t,this.syncDisplayObject(),this.parent&&this.parent.addChildDisplayObject(this)},update:function(t){(this.parent._sizeChanged||this._sizeChanged||this._positionChanged||this._needToCompute||t)&&(this.updateSize(),this.updatePosition(),this.parent.root.renderer.updateRect(this.displayObject,0,0,this.absoluteWidth,this.absoluteHeight,null,null,this.lineWidth,this.color,this.alpha),this._sizeChanged=!1,this._positionChanged=!1,this._needToCompute=!1)}});t.BorderHolder=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Component,t.BaseHolder),s=i.create({superclass:e,initialize:function(){this.width="100%",this.height="100%",this.borderImage=!0,this.T=null,this.R=null,this.B=null,this.L=null,this.alpha=1,this.fillParent=!0},init:function(){this.config={sx:this.sx,sy:this.sy,sw:this.sw,sh:this.sh},this.initDisplayObject()},initDisplayObject:function(){var t=this.img,i=this.config,e=i.sx||0,s=i.sy||0,h=i.sw||t.width,n=i.sh||t.height,o=this.L,a=this.T,l=this.R,r=this.B;this.displayObject=this.parent.root.renderer.createNineSlicePlane(t,e,s,h,n,o,a,l,r),this.syncDisplayObject(),this.displayObject.width=h,this.displayObject.height=n,this.parent&&this.parent.addChildDisplayObject(this)}});t.BorderImageHolder=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Component),s=i.create({superclass:e,initialize:function(){this.composite=!1,this.disabled=!1,this.backgroundColor=null},compute:function(){this.computeSelf(),this.backgroundHolder&&this.backgroundHolder.update(this._sizeChanged),this.updateAABB()}});s.create=function(t,i,e){return new CUI.Blank({parent:e,width:t,height:i})},t.Blank=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Core),s=t.Component,h=t.Label,n=t.Button,o=i.create({superclass:s,init:function(){this.id=this.id||"panel_"+e._SN++,this.beforeInit&&this.beforeInit(),this.initBase(),this.initHead(),this.initChildren(),this._toSortChildren=!0,this.afterInit&&this.afterInit()},initHead:function(){this.titleInfo&&("left"in this.titleInfo||(this.titleInfo.left=8),"top"in this.titleInfo||(this.titleInfo.top=8),this.titleInfo.fontSize=this.titleInfo.fontSize||20,(this.titleInfo.parent=this).titleLabel=new h(this.titleInfo)),this.closeBtnInfo&&((this.closeBtnInfo.parent=this).closeButton=new n(this.closeBtnInfo))}});t.Panel=o,"undefined"!=typeof module&&(module.exports=o)}(CUI=CUI||{}),function(t){var i=t.Class,e=t.Utils,s=t.Core,h=t.Component,n=t.ImageHolder,o=t.TextHolder,a=i.create({superclass:h,initialize:function(){this.composite=!1,this.disabled=!1,this.width="auto",this.height="auto",this.textExtWidth=0,this.textExtHeight=0,this.scaleBg=!1,this.backgroundColor=null,this.borderWidth=0,this.sizeHolder=1e-4,this.sizePadding=2},init:function(){this.id=this.id||"label_"+s._SN++,this.beforeInit&&this.beforeInit(),this.initBase(),this._sizeChanged=!0,this.iconInfo&&(this.iconHolder=this.addImageHolder(this.iconInfo)),!this.textInfo&&this.text&&(this.textInfo={text:this.text}),this.setTextInfo(this.textInfo),this.computeTextSize(),this.computeSelf(),this.updateAABB(),this.setDisabled(this.disabled),this.afterInit&&this.afterInit(),this._needToComputeSize=!0},setIconInfo:function(t){t?this.iconHolder?this.iconHolder.setImageInfo(t):(this.iconHolder=new n(t),(this.iconHolder.parent=this).iconHolder.init()):this.iconHolder=null,this._needToCompute=!0},setTextInfo:function(t){t&&(this.initTextInfo(t),this.textHolder?this.textHolder.setTextInfo(t):(this.textHolder=new o(t),(this.textHolder.parent=this).textHolder.init()),this._needToCompute=!0,this._needToComputeSize=!0)},setTextColor:function(t){this.textHolder&&this.textHolder.setColor(t)},initTextInfo:function(i){if(i){var e=this;["text","color","textAlign","verticalAlign","strokeColor","strokeWidth","fontSize","fontWeight","fontStyle","fontName","lineHeight"].forEach(function(t){!(t in i)&&t in e&&(i[t]=e[t])})}},setText:function(t,i){this.textHolder&&(this.textInfo&&(this.textInfo.text=t),this.textHolder.setText(t),this.textHolder.updateText(),this._needToComputeSize=this.textHolder.textChanged,this._needToCompute=!1!==i)},computeAutoWidth:function(){var t,i=this.pixel;if(this.textHolder){var e=(this.textHolder.pixel.left||0)+(this.textHolder.pixel.right||0);t=this.textHolder.areaWidth+e}else t=this.backgroundImageHolder?this.backgroundImageHolder.pixel.width:this.textExtWidth;t+=i.paddingLeft+i.paddingRight,i.width=t},computeAutoHeight:function(){var t,i=this.pixel;if(this.textHolder){var e=(this.textHolder.pixel.top||0)+(this.textHolder.pixel.bottom||0);t=this.textHolder.areaHeight+e}else t=this.backgroundImageHolder?this.backgroundImageHolder.pixel.height:this.textExtHeight;t+=i.paddingTop+i.paddingBottom,i.height=t},computeWidth:function(){var t=this.pixel;"auto"===this._width?this.computeAutoWidth():t.width=e.parseValue(this.width,t.realOuterWidth),t.width=t.width||this.sizeHolder,this.absoluteWidth=t.width;var i=this.backgroundImageHolder;i&&this.scaleBg&&(i.pixel.width=this._absoluteWidth,i.absoluteWidth=this._absoluteWidth)},computeHeight:function(){var t=this.pixel;"auto"===this._height?this.computeAutoHeight():t.height=e.parseValue(this.height,t.realOuterHeight),t.height=t.height||this.sizeHolder,this.absoluteHeight=t.height;var i=this.backgroundImageHolder;i&&this.scaleBg&&(i.pixel.height=this._absoluteHeight,i.absoluteHeight=this._absoluteHeight)},computeTextSize:function(t){if(this.textHolder&&this.textHolder.measure){var i=this.textHolder.pixel,e=this.borderWidth+this.paddingLeft+this.paddingRight+(i.left||0)+(i.right||0),s=this.borderWidth+this.paddingTop+this.paddingBottom+(i.top||0)+(i.bottom||0);this.textWidth=this.textHolder.textWidth,this.textHeight=this.textHolder.textHeight,this.textExtWidth=this.textWidth+e,this.textExtHeight=this.textHeight+s}},compute:function(){this.computeSelf(),this.updateHolders(),this.textHolder&&this.textHolder.update(!0),this.updateAABB()},updateSizeWithText:function(){this.textHolder&&(this.textHolder.updateText(),this.textHolder.updateSize(),this.textHolder.updatePosition()),this.computeTextSize();var t=this.borderImageHolder;t&&t.borderImage&&(t.cacheCanvas=null),this._needToCompute=!0},update:function(t,i,e){this.beforeUpdate&&this.beforeUpdate(t,i),e=0<this.reflowComputeTimes--||e,this._needToCompute=this._needToCompute||e;var s="auto"===this._width||"auto"===this._height,h=s&&this._sizeChanged;(this.visible||this._needToCompute||h)&&(this.updateSelf(t,i),h=s&&this._sizeChanged),!this._needToComputeSize&&this.textWidth||(this.updateSizeWithText(),h=!0),this._needToCompute&&this.compute(),h&&this.resizeParents(),this.afterUpdate&&this.afterUpdate(t,i),this._needToComputeSize=!1,this._sizeChanged=!1,this._positionChanged=!1,this._needToCompute=!1,this._needToComputeChildren=!1,this.visible&&this.beforeRender(t,i)}});t.Label=a,"undefined"!=typeof module&&(module.exports=a)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Core),s=t.Label,h=t.ButtonComponent,n=i.create({superclass:s,initialize:function(){this.borderWidth=0,this.textAlign="center",this.scaleBg=!0},init:function(){this.id=this.id||"button_"+e._SN++,n.$super.init.call(this)},onDown:function(t,i,e){this._normalOffsetY=this.offsetY,this._normalScale=this.scale,this.offsetY=this.offsetY+2,this.scale=.92*this.scale},onUp:function(t,i,e){this.offsetY=this._normalOffsetY||0,this.scale=this._normalScale||1},setDisabled:function(t,i){(this.disabled!==t||i)&&(this.disabled=t,this.alpha=t?.6:this._defaultAlpha)}});h.applyTo(n.prototype),t.Button=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Core),s=t.Component,h=t.ImageHolder,n=(t.TextHolder,i.create({superclass:s,initialize:function(){this.composite=!1,this.disabled=!1,this.width="auto",this.height="auto",this.imgWidth="auto",this.imgHeight="auto",this.scaleImg=!0,this.lockScaleRatio=!0,this.crossOrigin="anonymous"},init:function(){this.id=this.id||"picture_"+e._SN++,this.beforeInit&&this.beforeInit(),this.initBase(),this.imageHolder=new h({parent:this,fillParent:this.scaleImg,lockScaleRatio:this.lockScaleRatio,width:this.imgWidth||"auto",height:this.imgHeight||"auto",alignH:"center",alignV:"center",crossOrigin:this.crossOrigin,tint:this.tint}),this.imageHolder.init(),this.borderImageInfo&&this.setBorderImage(this.borderImageInfo),this.src?this.setSrc(this.src):this.img?this.setImg(this.img):this.imgInfo&&this.setImageInfo(this.imgInfo),this.afterInit&&this.afterInit()},setTint:function(t){this.tint=t,this.imageHolder.tint=t},getTint:function(t){return this.tint},setSrc:function(t){this.src=t;var i=this;"auto"===this._width||this._height;this.imageHolder.setSrc(t,function(t){t&&(i._sizeChanged=!0),i.hasImg=!!i.imageHolder.img,i._needToCompute=!0,i.onImageLoad&&i.onImageLoad(t)})},onImageLoad:null,setImg:function(t){this.img=t;var i=this;"auto"===this._width||this._height;this.imageHolder.setImg(t,function(t){t&&(i._sizeChanged=!0),i.hasImg=!!i.imageHolder.img,i._needToCompute=!0})},setImageInfo:function(t){this.imageHolder.setImageInfo(t),this.imageHolder.tint=this.tint,this.hasImg=!!this.imageHolder.img,this._needToCompute=!0},getImageInfo:function(){if(!this.imageHolder)return null;var t=this.imageHolder.config;return{sx:t.sx,sy:t.sy,sw:t.sw,sh:t.sh,img:this.imageHolder.img}},computeAutoWidth:function(){var t=this.imageHolder?this.imageHolder._displayWidth:0;this.pixel.width=t},computeAutoHeight:function(){var t=this.imageHolder?this.imageHolder._displayHeight:0;this.pixel.height=t},compute:function(){this.computeSelf(),this.updateHolders(),this.imageHolder&&this.imageHolder.update(!0),this.updateAABB()},refreshImage:function(){var t=this.imageHolder.displayObject;t&&t.updateTexture()},update:function(t,i,e){this.beforeUpdate&&this.beforeUpdate(t,i),e=0<this.reflowComputeTimes--||e,this._needToCompute=this._needToCompute||e;var s="auto"===this._width||"auto"===this._height,h=s&&this._sizeChanged;(this.visible||this._needToCompute||h)&&(this.updateSelf(t,i),h=s&&this._sizeChanged),this._needToCompute&&this.compute(),h&&this.resizeParents(),this.afterUpdate&&this.afterUpdate(t,i),this._sizeChanged=!1,this._positionChanged=!1,this._needToCompute=!1,this._needToComputeChildren=!1,this.visible&&this.beforeRender(t,i)}}));t.Picture=n,"undefined"!=typeof module&&(module.exports=n)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Core),s=t.Component,h=t.Slider,n=t.noop,o=i.create({superclass:s,initialize:function(){this.scrollH=!1,this.scrollV=!0,this.scrollX=0,this.scrollY=0,this.scrollDX=0,this.scrollDY=0,this.clipArea=!0,this.outEdge=90,this.damping=.0025,this.swipeScale=1.2,this.minScrollVel=.12,this.bounceDuration=180,this.scrollingDuration=700,this.scrollThumb=!0,this.thumbWidth=10,this.thumbColor="rgba(255,255,255,0.6)",this.thumbBgColor="rgba(0,0,0,0.4)",this.snapWidth=null,this.snapHeight=null},init:function(){this.id=this.id||"scrollview_"+e._SN++,this.beforeInit&&this.beforeInit(),this.initBase(),this.visibleChildren=[],this.slider=new h({}),this.damping&&(this.slider.damping=this.damping),this.scrollWidthOrigin=this.scrollWidth,this.scrollHeightOrigin=this.scrollHeight,this.initChildren(),this._toSortChildren=!0,this.resetScrollInfo(),this.afterInit&&this.afterInit()},computeScrollInfo:function(){var t=this.children[0];if(t){var i=this.children[this.children.length-1],e=i.absoluteX+i.absoluteWidth+i.marginRight-t.absoluteX+t.marginLeft;e+=this.paddingLeft+this.paddingRight;var s=i.absoluteY+i.absoluteHeight+i.marginBottom-t.absoluteY+t.marginTop;s+=this.paddingTop+this.paddingBottom,this.scrollWidth=this.scrollWidthOrigin||e,this.scrollHeight=this.scrollHeightOrigin||s}else this.scrollWidth=this.scrollWidthOrigin||0,this.scrollHeight=this.scrollHeightOrigin||0;this.minScrollX=this.minScrollY=0,this.maxScrollX=Math.max(0,this.scrollWidth-this._absoluteWidth),this.maxScrollY=Math.max(0,this.scrollHeight-this._absoluteHeight),this.scrollX=Math.min(Math.max(this.scrollX,this.minScrollX),this.maxScrollX),this.scrollY=Math.min(Math.max(this.scrollY,this.minScrollY),this.maxScrollY),this.rateWidth=this._absoluteWidth/this.scrollWidth,this.rateHeight=this._absoluteHeight/this.scrollHeight,this.thumbHSize=(this._absoluteWidth-this.paddingLeft-this.paddingRight)*this.rateWidth>>0,this.thumbVSize=(this._absoluteHeight-this.paddingTop-this.paddingBottom)*this.rateHeight>>0},resetScrollInfo:function(){this.computeScrollInfo(),this.slider.reset(),this.scrolling=0,this.scrollX=this.scrollDX=0,this.scrollY=this.scrollDY=0,this.lastScrollX=this.lastScrollY=0,this.visibleChildren.length=0,this.thumbX=this.scrollX*this.rateWidth>>0,this.thumbY=this.scrollY*this.rateHeight>>0,this._lazyUpdate=0,this.stopTween(),this.onReset()},onReset:n,reset:function(){this.resetScrollInfo()},startScroll:function(t,i){this.scrollH||(t=0),this.scrollV||(i=0),Math.abs(t)<this.minScrollVel&&Math.abs(i)<this.minScrollVel||(this.scorllOver=!1,this.slider.toStart=!0,this.slider.start(t,i))},stopScroll:function(){this.slider.stop(),this.stopTween()},focusOnChild:function(t,i,e){i=i||this.paddingLeft,e=e||this.paddingTop;var s=t.aabb,h=this.aabb,n=s[0]-i-h[0],o=s[2]+i-h[2],a=s[1]-e-h[1],l=s[3]+e-h[3],r=0,d=0;return n<0?r=n:0<o&&(r=o),a<0?d=a:0<l&&(d=l),!(!r&&!d)&&(this.scrollBy(r,d),[r,d])},scrollTo:function(t,i){this.stopTween(),this.scrollH&&this.setScrollX(t),this.scrollV&&this.setScrollY(i)},scrollBy:function(t,i){this.scrolling=this.scrollingDuration,this.scrollH&&((this.scrollX<this.minScrollX&&t<0||this.scrollX>this.maxScrollX&&0<t)&&(t*=.3),this.setScrollX(this.scrollX+t)),this.scrollV&&((this.scrollY<this.minScrollY&&i<0||this.scrollY>this.maxScrollY&&0<i)&&(i*=.3),this.setScrollY(this.scrollY+i))},setScrollX:function(t){this.scrollX=Math.max(this.minScrollX-this.outEdge,Math.min(this.maxScrollX+this.outEdge,t)),this.thumbX=this.scrollX*this.rateWidth>>0},setScrollY:function(t){this.scrollY=Math.max(this.minScrollY-this.outEdge,Math.min(this.maxScrollY+this.outEdge,t)),this.thumbY=this.scrollY*this.rateHeight>>0},canScroll:function(){var t=this.scrollH;if((this.scrollX<=this.minScrollX-this.outEdge/2||this.scrollX>=this.maxScrollX+this.outEdge/2)&&(t=!1),t)return!0;var i=this.scrollV;return(this.scrollY<=this.minScrollY-this.outEdge/2||this.scrollY>=this.maxScrollY+this.outEdge/2)&&(i=!1),i},startTween:function(t,i){t=t||{x:this.scrollX,y:this.scrollY},this.scrollH&&this.snapWidth&&(t.x=Math.round(t.x/this.snapWidth)*this.snapWidth),this.scrollV&&this.snapHeight&&(t.y=Math.round(t.y/this.snapHeight)*this.snapHeight),t.x=Math.min(this.maxScrollX,Math.max(this.minScrollX,t.x)),t.y=Math.min(this.maxScrollY,Math.max(this.minScrollY,t.y)),this.stopTween();var s=this,h=this.scrollX,n=this.scrollY,o=t.x-h,a=t.y-n;(o||a)&&(this.tween={duration:0===i||i?i:this.bounceDuration,played:0,target:t,onUpdate:function(t){var i=h+o*t-s.scrollX,e=n+a*t-s.scrollY;(i||e)&&s.scrollBy(i,e)},onComplete:function(){s.scrollX=this.target.x,s.scrollY=this.target.y,s.thumbX=s.scrollX*s.rateWidth>>0,s.thumbY=s.scrollY*s.rateHeight>>0,s.scorllOver=!0,s.stopScroll(),s.afterTween(s.scrollX,s.scrollY)}})},stopTween:function(){this.tween=null},afterTween:function(t,i){},updateTween:function(t){var i=this.tween;if(!i)return!1;if(i.played+=t,i.played<0)return!1;var e=i.played/i.duration;return 1<=e?(e=1,i.onComplete(),this.stopTween()):i.onUpdate(e),!0},onTouchStart:function(t,i,e){return this.containPoint(t,i)&&this.stopScroll(),!1},onTouchEnd:function(t,i,e){return this.startTween(),!1},onPan:function(t,i,e,s,h,n,o){if(this.scrollV&&this.scrollH&&this.containPoint(t,i))this.scrollBy(-e,-s);else{if(!(this.scrollV&&this.containPoint(t,n)||this.scrollH&&this.containPoint(h,i)))return!1;this.scrollBy(-e,-s)}},onSwipe:function(t,i,e,s,h,n,o){return!!this.containPoint(h,n)&&(e*=this.swipeScale,s*=this.swipeScale,void this.startScroll(-e,-s))},compute:function(){this.computeSelf(),this.layout.compute(this),this.computeScrollInfo(),this.clipArea&&this.syncMask(),this.updateHolders(),this.updateAABB()},updateSelf:function(t,i){if(this.updateTween(t),!this.scorllOver){var e=this.slider.update(t);e&&this.scrollBy(this.slider.dx,this.slider.dy),e&&this.canScroll()||(this.scorllOver=!0,this.startTween())}},updateChildren:function(e,s){var h=this;this.scrollDX=this.scrollX-this.lastScrollX,this.scrollDY=this.scrollY-this.lastScrollY;var n=this.visibleChildren;this.scrollDX||this.scrollDY||0===n.length||this._lazyUpdate++<2?(n.length=0,this.children.forEach(function(t,i){t.syncPosition(),t.visible=h.checkCollideAABB(t.aabb),t.visible&&n.push(t),t.update(e,s)})):this.visibleChildren.forEach(function(t,i){t.update(e,s)}),this.scrollDX=0,this.scrollDY=0,this.lastScrollX=this.scrollX,this.lastScrollY=this.scrollY},getTouchableChildren:function(){return this.visibleChildren}});t.ScrollView=o,"undefined"!=typeof module&&(module.exports=o)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Core),s=(t.Component,t.Button),h=i.create({superclass:s,initialize:function(){this.tabIndex=0,this.group=null,this.linkComp=null,this.active=!1,this.bgImgNormal=null,this.bgImgActive=null,this.bgInfoNormal=null,this.bgInfoActive=null},init:function(){this.id=this.id||"switchbutton_"+e._SN++;var t=this.bgImgActive,i=this.bgInfoActive;t&&!i&&(i={img:t}),this.bgInfoActive=i;t=this.bgImgNormal,i=this.bgInfoNormal;t&&!i&&(i={img:t}),this.bgInfoNormal=i,this.backgroundInfo=this.active?this.bgInfoActive:this.bgInfoNormal,h.$super.init.call(this)},activate:function(t){if(!this.active){if(this.linkComp){var i=this.linkComp;"string"==typeof i&&(i=this.root.all[i]),i&&i.show()}if(this.group){var e=this;this.group.forEach(function(t){"string"==typeof t&&(t=e.root.all[t]),t&&t!==e&&t.inactivate()})}this.active=!0,this.onActivate(t),this.backgroundImageHolder&&this.backgroundImageHolder.setImageInfo(this.bgInfoActive)}},inactivate:function(){if(this.active){if(this.linkComp){var t=this.linkComp;"string"==typeof t&&(t=this.root.all[t]),t&&t.hide()}this.active=!1,this.onInactivate(),this.backgroundImageHolder&&this.backgroundImageHolder.setImageInfo(this.bgInfoNormal)}},onTap:function(t,i,e){this.activate()},onInactivate:function(){},onActivate:function(){}});t.SwitchButton=h,"undefined"!=typeof module&&(module.exports=h)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Panel),h=t.Button,s=i.create({superclass:e,initialize:function(){this.visible=!0,this.disabled=!1,this.vertical=!1,this.min=0,this.max=1,this.value=.5,this.step=.25,this.trackInfo=null,this.handleInfo=null,this.track=null,this.handle=null},initChildren:function(){var o=this,t=this.trackInfo||{},i=this.handleInfo||{},e={parent:o,width:"100%",height:"100%",align:"center",valign:"center",backgroundColor:this.trackColor,onDown:function(t,i,e){},onTap:function(t,i,e){if(o.vertical){var s=i<o.handle._absoluteY?-1:1,h=o.handle.relativeY+o.handle._absoluteHeight/2;0<s&&(h=this._absoluteHeight-h);var n=h*o.step*s;o.scrollBy(0,n)}else{s=t<o.handle._absoluteX?-1:1,h=o.handle.relativeX+o.handle._absoluteWidth/2;0<s&&(h=this._absoluteWidth-h);n=h*o.step*s;o.scrollBy(n,0)}}};for(var s in t)e[s]=t[s];this.track=new h(e);e={parent:o,width:60,height:"100%",align:"center",valign:"center",backgroundColor:this.handleColor,pressX:null,pressY:null,value:0,touchStart:function(t,i,e){if(this.disabled)return!1;o.canHandle=!0,this.touchId=e,this.pressX=t,this.pressY=i,this.scale=.95},touchEnd:function(t,i,e){return this.disabled||(o.canHandle=!1,this.touchId===e&&(this.touchId=this.pressX=this.pressY=null,this.scale=1)),!1},onTap:function(t,i,e){return!0}};for(var s in i)e[s]=i[s];this.handle=new h(e),this.first=!0},updateSelf:function(){this.first&&(this.first=!1,this.updateTrack(),this.setValue(this.value))},scrollBy:function(t,i){if(this.updateTrack(),this.vertical){if(i<0)this.handle.relativeY+i<0&&(i=0-this.handle.relativeY);else if(0<i){this.handle.relativeY+this.handle._absoluteHeight+i>this._absoluteHeight&&(i=this._absoluteHeight-this.handle._absoluteHeight-this.handle.pixel.baseY)}this.handle.moveBy(0,i)}else{if(t<0)this.handle.relativeX+t<0&&(t=0-this.handle.relativeX);else if(0<t){this.handle.relativeX+this.handle._absoluteWidth+t>this._absoluteWidth&&(t=this._absoluteWidth-this.handle._absoluteWidth-this.handle.pixel.baseX)}this.handle.moveBy(t,0)}var e=this.handle.relativeX/this.trackRealSize;this.value=e*(this.max-this.min)+this.min,this.onChanged(this.value)},setValue:function(t){t=Math.min(Math.max(this.min,t),this.max);var i=((this.value=t)-this.min)/(this.max-this.min)*this.trackRealSize;this.vertical?(this.handle.pixel.relativeY=i,this.handle.relativeY=i):(this.handle.pixel.relativeX=i,this.handle.relativeX=i),this.handle.syncPosition()},updateTrack:function(){this.minX=0,this.minY=0,this.maxX=this._absoluteWidth-this.handle._absoluteWidth,this.maxY=this._absoluteHeight-this.handle._absoluteHeight,this.trackRealSize=this.vertical?this.maxY:this.maxX},pan:function(t,i,e,s,h,n,o){return!!(this.visible&&this.canHandle&&this.containPoint(t,i))&&(!this.disabled&&void this.scrollBy(e,s))},onChanged:function(t){}});t.SliderBar=s}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,t.Label),s=i.create({superclass:e});t.TextBlock=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,e=(t.Utils,function(t,i){this.set(t||0,i||0)});e.prototype.set=function(t,i){this.x=t,void 0===i&&(i=t),this.y=i};var s=i.create({initialize:function(){this.position=new e(0,0),this.pivot=new e(0,0),this.scale=new e(1,1),this.children=[],this.width=0,this.height=0,this.alpha=1,this.rotation=0,this.visible=!0,this.zIndex=0,this.tint=null,this.composite=null,this.mask=null,this._absoluteAlpha=1,this._ignoreResize=!1,this.parent=null,this.rect=null,this.image=null,this.borderImage=null},updateTexture:function(){},addChild:function(t){(t.parent=this).children.push(t)},addChildAt:function(t,i){if(i<0||i>this.children.length)throw new Error("child.addChildAt: The index "+i+" supplied is out of bounds "+this.children.length);t.parent&&t.parent.removeChild(t),(t.parent=this).children.splice(i,0,t)},removeChild:function(t){var i=this.children.indexOf(t);return-1===i?null:(this.children.splice(i,1),t.parent=null,t)},getChildIndex:function(t){var i=this.children.indexOf(t);if(-1===i)throw new Error("The supplied DisplayObject must be a child of the caller");return i},sortChildren:function(){this.children.sort(function(t,i){return t.zIndex-i.zIndex||t.index-i.index})},destroy:function(){this.children.forEach(function(t){t.parent=null,"function"==typeof t.destroy&&t.destroy()}),this.parent=null,this.position=null,this.pivot=null,this.scale=null,this.children=null}}),h=[{key:"width",get:function(){return this._width},set:function(t){this._width=Math.abs(t),this.imageInfo&&(this.scale.x=Math.abs(this.scale.x)*(t<0?-1:1))}},{key:"height",get:function(){return this._height},set:function(t){this._height=Math.abs(t),this.imageInfo&&(this.scale.y=Math.abs(this.scale.y)*(t<0?-1:1))}}];i.defineProperties(s.prototype,h),t.Point=e,t.DisplayObject=s,"undefined"!=typeof module&&(module.exports=s)}(CUI=CUI||{}),function(t){var i=t.Class,h=(t.Utils,t.noop),d=(t.Font,t.DisplayObject),e=i.create({initialize:function(){this.canvas2d=!0,this.lazyInit=!1,this.canvas=null,this.context=null,this.clearColor=null},init:function(){this.context=this.context||this.canvas.getContext("2d"),this.canvas=this.canvas||this.context.canvas},colorRgb:function(t,i,e){return"rgba("+t+", "+i+", "+e+", 1)"},colorHex:function(t){return t},colroName:function(t){return t},clear:function(){if(null!==this.clearColor)return this.fillStyle=this.clearColor,void this.fillRect(0,0,this.canvas.width,this.canvas.height);this.clearRect(0,0,this.canvas.width,this.canvas.height)},clipRect:function(t,i,e,s){this.context.save();var h=this.globalTransform,n=t-h.originalX,o=i-h.originalY,a=this.context;return a.beginPath(),a.moveTo(n,o),a.lineTo(n+e,o),a.lineTo(n+e,o+s),a.lineTo(n,o+s),a.closePath(),a.clip(),a},render:function(t){if(!(t.alpha<=0)&&t.visible){var i=this.context;i.save(),t._parentAlpha=t.parent?t.parent._absoluteAlpha:1,t._absoluteAlpha=t.alpha*t._parentAlpha,i.globalAlpha=t._absoluteAlpha,t.composite&&(i.globalCompositeOperation=t.composite),i.translate(t.position.x,t.position.y),i.rotate(t.rotation),i.scale(t.scale.x,t.scale.y),i.translate(-t.pivot.x,-t.pivot.y);if(t.mask){var e=t.mask.rectInfo;i.beginPath(),i.moveTo(0,0),i.lineTo(0+e.width,0),i.lineTo(0+e.width,0+e.height),i.lineTo(0,0+e.height),i.closePath(),i.clip()}t.imageInfo?this.drawImage(t,0,0):t.borderImageInfo?this.drawBorderImage(t,0,0):t.rectInfo?this.drawRect(t,0,0):t.textInfo&&this.drawText(t,0,0);for(var s=t.children,h=0,n=s.length;h<n;h++)this.render(s[h]);i.restore()}},drawRect:function(t,i,e){i=i||0,e=e||0;var s=this.context,h=t.rectInfo;h.width<=0||h.height<=0||(i+=h.x,e+=h.y,h.color&&(s.fillStyle=h.color,s.fillRect(i,e,h.width,h.height)),h.borderColor&&0<h.borderWidth&&0<h.borderAlpha&&(s.globalAlpha=h.borderAlpha*t._parentAlpha,s.lineWidth=h.borderWidth,s.strokeStyle=h.borderColor,s.strokeRect(i,e,h.width,h.height)))},drawImage:function(t,i,e){i=i||0,e=e||0;var s=this.context,h=t.imageInfo;if(h.img){var n=t.width,o=t.height;0<n&&0<o&&s.drawImage(h.img,h.sx,h.sy,h.sw,h.sh,i,e,n,o)}},drawBorderImage:function(t,i,e){i=i||0,e=e||0;var s=this.context,h=t.borderImageInfo,n=h.img;if(n){var o=t.width,a=t.height,l=h.sx,r=h.sy,d=h.sw,u=h.sh,c=h.T,p=h.R,f=h.B,g=h.L,m=d-g-p,b=u-c-f,v=o-g-p,x=a-c-f;0<x&&(0<g&&s.drawImage(n,l,r+c,g,b,i,e+c,g,x),0<v&&s.drawImage(n,l+g,r+c,m,b,i+g,e+c,v,x),0<p&&s.drawImage(n,l+d-p,r+c,p,b,i+o-p,e+c,p,x)),0<c&&(0<g&&s.drawImage(n,l,r,g,c,i,e,g,c),0<v&&s.drawImage(n,l+g,r,m,c,i+g,e,v,c),0<p&&s.drawImage(n,l+d-p,r,p,c,i+o-p,e,p,c)),0<f&&(0<g&&s.drawImage(n,l,r+u-f,g,f,i,e+a-f,g,f),0<v&&s.drawImage(n,l+g,r+u-f,m,f,i+g,e+a-f,v,f),0<p&&s.drawImage(n,l+d-p,r+u-f,p,f,i+o-p,e+a-f,p,f))}},drawText:function(t,i,e){i=i||0,e=e||0;var s=this.context,h=t.textInfo;CUI.Utils.renderTextContent(s,h,i,e)},createContainer:function(){return new d},createSprite:function(t,i,e,s,h){var n=new d,o={img:t,sx:i||0,sy:e||0,sw:s||(t?t.width:0),sh:h||(t?t.height:0)};return o.w=o.sw,o.h=o.sh,n.imageInfo=o,n.textureWidth=o.sw,n.textureHeight=o.sh,n},updateSprite:function(t,i,e,s,h,n){var o=t.imageInfo||{};o.img=n||o.img,null!==i&&(o.sx=i||0),null!==e&&(o.sy=e||0),null!==s&&(o.sw=s||0===s?s:n?n.width:0),null!==h&&(o.sh=h||0===h?h:n?n.height:0),o.w=o.sw,o.h=o.sh,t.imageInfo=o,t.textureWidth=o.sw,t.textureHeight=o.sh},createRect:function(t,i,e,s,h,n,o){return this.updateRect(null,0,0,t,i,e,s,h,n,o)},updateRect:function(t,i,e,s,h,n,o,a,l,r){return t||(t=new d),t.rectInfo={x:i||0,y:e||0,width:s,height:h,color:n,alpha:o,borderWidth:a,borderColor:l,borderAlpha:r},t},createNineSlicePlane:function(t,i,e,s,h,n,o,a,l){var r=new d;return arguments.length<9&&(n=i,o=e,a=s,l=h,e=i=0,s=t?t.width:0,h=t?t.height:0),r.borderImageInfo={img:t,sx:i,sy:e,sw:s,sh:h,L:n,T:o,R:a,B:l},r},createTextObject:function(t,i){if(t){var e,s=t.canvas;(e=this.createSprite(s)).resolution=i||1,e.context=t,e.canvas=s,e.padding=0,e.updateSize=this._updateTextSize,e.updateContent=this._updateTextContent}else(e=new d).updateSize=h,e.updateContent=h;return e},_updateTextSize:function(){this.imageInfo.sw=this.canvas.width,this.imageInfo.sh=this.canvas.height,this.imageInfo.w=this.canvas.width,this.imageInfo.h=this.canvas.height,this.textureWidth=this.imageInfo.sw,this.textureHeight=this.imageInfo.sh},_updateTextContent:function(){}});t.CanvasRenderer=e,"undefined"!=typeof module&&(module.exports=e)}(CUI=CUI||{}),function(t){var i=t.Class,n=(t.Utils,t.noop),e=(t.Font,i.create({initialize:function(){this.lazyInit=!1,this.renderer=null},colorRgb:function(t,i,e){return(t<<16)+(i<<8)+e},colorHex:function(t){return parseInt(t.substr(-6),16)},colroName:function(t){return t},createContainer:function(){return new PIXI.Container},createSprite:function(t,i,e,s,h){var n;arguments.length;return t&&void 0!==i?n=this._createTexture(t,i,e,s,h):t&&(n=this._createTexture(t)),new PIXI.Sprite(n)},updateSprite:function(t,i,e,s,h,n){var o;if(n)return o=this._createTexture(n,i,e,s,h),void(t.texture=o);var a=(o=t._texture)._frame;null!==i&&(a.x=i),null!==e&&(a.y=e),null!==s&&(a.width=s),null!==h&&(a.height=h),o._updateUvs(),t._onTextureUpdate(),o.baseTexture.emit("update",o.baseTexture)},createRect:function(t,i,e,s,h,n,o){return this.updateRect(null,0,0,t,i,e,s,h,n,o)},updateRect:function(t,i,e,s,h,n,o,a,l,r){return a=a||0,t?t.clear():(t=new PIXI.Graphics)._ignoreResize=!0,t.beginFill(n,o),0<a&&(l||0===l)&&t.lineStyle(a,l,r,.5),t.drawRect(i,e,s,h),t.endFill(),t},createNineSlicePlane:function(t,i,e,s,h,n,o,a,l){var r;return 9==arguments.length?r=this._createTexture(t,i,e,s,h):(r=this._createTexture(t),n=i,o=e,a=s,l=h),new PIXI.mesh.NineSlicePlane(r,n,o,a,l)},createTextObject:function(t,i){var e;if(t){var s=t.canvas,h=PIXI.Texture.fromCanvas(s);h.trim=new PIXI.Rectangle,(e=new PIXI.Sprite(h)).resolution=i||1,e.context=t,e.canvas=s,e.padding=0,e.updateSize=this._updateTextSize,e.updateContent=this._updateTextContent}else(e=new PIXI.Sprite(PIXI.Texture.EMPTY)).updateSize=n,e.updateContent=n;return e},_updateTextSize:function(){var t=this._texture;t.baseTexture.hasLoaded=!0,t.baseTexture.resolution=this.resolution,t.baseTexture.realWidth=this.canvas.width,t.baseTexture.realHeight=this.canvas.height,t.baseTexture.width=this.canvas.width/this.resolution,t.baseTexture.height=this.canvas.height/this.resolution,t.trim.width=t._frame.width=this.canvas.width/this.resolution,t.trim.height=t._frame.height=this.canvas.height/this.resolution,t.trim.x=-this.padding,t.trim.y=-this.padding,t.orig.width=t._frame.width-2*this.padding,t.orig.height=t._frame.height-2*this.padding,this._onTextureUpdate(),t.baseTexture.emit("update",t.baseTexture)},_updateTextContent:function(){var t=this._texture;this._textureID=-1,t.baseTexture.emit("update",t.baseTexture)},_createTexture:function(t,i,e,s,h){arguments.length;var n=PIXI.BaseTexture.from(t),o=s&&h?new PIXI.Rectangle(i,e,s,h):null;return new PIXI.Texture(n,o)}}));t.PIXIRenderer=e,"undefined"!=typeof module&&(module.exports=e)}(CUI=CUI||{}),"undefined"!=typeof module&&module&&(module.exports=CUI);